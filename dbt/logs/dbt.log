[0m02:13:14.827640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb291103730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb28f2a4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb28f2a5660>]}


============================== 02:13:14.834205 | 1e9ec2fb-5a46-4020-9b23-b227afb75f28 ==============================
[0m02:13:14.834205 [info ] [MainThread]: Running with dbt=1.7.3
[0m02:13:14.834776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_tempo dim_grupo_economico dim_servico fato_ida long_delta', 'send_anonymous_usage_stats': 'True'}
[0m02:13:15.037655 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('tests-paths' was unexpected)

Error encountered in /opt/dbt/dbt_project.yml
[0m02:13:15.039502 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2662577, "process_user_time": 2.304919, "process_kernel_time": 0.200079, "process_mem_max_rss": "93512", "process_out_blocks": "624", "command_success": false, "process_in_blocks": "0"}
[0m02:13:15.040456 [debug] [MainThread]: Command `dbt run` failed at 02:13:15.039999 after 0.27 seconds
[0m02:13:15.040909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb291103730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb28f3d66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb28f2a7a00>]}
[0m02:13:15.041297 [debug] [MainThread]: Flushing usage events
[0m02:13:51.381614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7f903f7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7f8e7ac970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7f8e7afee0>]}


============================== 02:13:51.389997 | d66ef724-11ae-4516-a6cb-97c5ad89f133 ==============================
[0m02:13:51.389997 [info ] [MainThread]: Running with dbt=1.7.3
[0m02:13:51.390607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/dbt', 'log_path': '/opt/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_tempo dim_grupo_economico dim_servico fato_ida long_delta', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:13:51.680866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd66ef724-11ae-4516-a6cb-97c5ad89f133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7f924ec5e0>]}
[0m02:13:51.851463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd66ef724-11ae-4516-a6cb-97c5ad89f133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7f8e6e3a90>]}
[0m02:13:51.852611 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m02:13:51.867079 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m02:13:51.867846 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:13:51.868348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd66ef724-11ae-4516-a6cb-97c5ad89f133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7f8cea3100>]}
[0m02:13:53.096595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd66ef724-11ae-4516-a6cb-97c5ad89f133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7f86e528f0>]}
[0m02:13:53.107865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd66ef724-11ae-4516-a6cb-97c5ad89f133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7f86e53fa0>]}
[0m02:13:53.108627 [info ] [MainThread]: Found 5 models, 17 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:13:53.109030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd66ef724-11ae-4516-a6cb-97c5ad89f133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7f8cbc45e0>]}
[0m02:13:53.111429 [info ] [MainThread]: 
[0m02:13:53.112386 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:13:53.114061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ida_datamart'
[0m02:13:53.130056 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart"
[0m02:13:53.130515 [debug] [ThreadPool]: On list_ida_datamart: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart"} */

    select distinct nspname from pg_namespace
  
[0m02:13:53.130861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:14:03.197309 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: Temporary failure in name resolution

[0m02:14:13.288251 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart"} */

    select distinct nspname from pg_namespace
  
[0m02:14:13.288647 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m02:14:13.289014 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m02:14:13.289232 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m02:14:13.289449 [debug] [ThreadPool]: On list_ida_datamart: No close available on handle
[0m02:14:13.290370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:14:13.290663 [debug] [MainThread]: Connection 'list_ida_datamart' was properly closed.
[0m02:14:13.290894 [info ] [MainThread]: 
[0m02:14:13.291158 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 20.18 seconds (20.18s).
[0m02:14:13.291496 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "postgres" to address: Temporary failure in name resolution
  
[0m02:14:13.292174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 21.95991, "process_user_time": 4.006275, "process_kernel_time": 0.328843, "process_mem_max_rss": "107180", "process_out_blocks": "2360", "command_success": false, "process_in_blocks": "0"}
[0m02:14:13.292590 [debug] [MainThread]: Command `dbt run` failed at 02:14:13.292498 after 21.96 seconds
[0m02:14:13.292850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7f903f7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7f86e52d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7f86e47790>]}
[0m02:14:13.293101 [debug] [MainThread]: Flushing usage events
[0m02:15:29.143251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f83133730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f812fe410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f812fdd20>]}


============================== 02:15:29.151943 | 924bc80f-0284-49c6-9f54-37750d0318ee ==============================
[0m02:15:29.151943 [info ] [MainThread]: Running with dbt=1.7.3
[0m02:15:29.153811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:15:29.462962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '924bc80f-0284-49c6-9f54-37750d0318ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f85443c10>]}
[0m02:15:29.603525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '924bc80f-0284-49c6-9f54-37750d0318ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f8132d420>]}
[0m02:15:29.604679 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m02:15:29.616944 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m02:15:29.652827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:15:29.653320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:15:29.660185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '924bc80f-0284-49c6-9f54-37750d0318ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f7f70a020>]}
[0m02:15:29.674387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '924bc80f-0284-49c6-9f54-37750d0318ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f7f8d4ac0>]}
[0m02:15:29.675047 [info ] [MainThread]: Found 5 models, 17 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:15:29.675500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '924bc80f-0284-49c6-9f54-37750d0318ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f7f8d4d00>]}
[0m02:15:29.677765 [info ] [MainThread]: 
[0m02:15:29.678847 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:15:29.680926 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ida_datamart'
[0m02:15:29.702908 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart"
[0m02:15:29.703469 [debug] [ThreadPool]: On list_ida_datamart: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart"} */

    select distinct nspname from pg_namespace
  
[0m02:15:29.705117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:15:29.745689 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m02:15:29.747266 [debug] [ThreadPool]: On list_ida_datamart: Close
[0m02:15:29.749331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ida_datamart, now create_ida_datamart_ida_ida)
[0m02:15:29.750513 [debug] [ThreadPool]: Creating schema "database: "ida_datamart"
schema: "ida_ida"
"
[0m02:15:29.759130 [debug] [ThreadPool]: Using postgres connection "create_ida_datamart_ida_ida"
[0m02:15:29.759776 [debug] [ThreadPool]: On create_ida_datamart_ida_ida: BEGIN
[0m02:15:29.760167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:15:29.771843 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:15:29.773105 [debug] [ThreadPool]: Using postgres connection "create_ida_datamart_ida_ida"
[0m02:15:29.775785 [debug] [ThreadPool]: On create_ida_datamart_ida_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "create_ida_datamart_ida_ida"} */
create schema if not exists "ida_ida"
[0m02:15:29.778855 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m02:15:29.780106 [debug] [ThreadPool]: On create_ida_datamart_ida_ida: COMMIT
[0m02:15:29.780553 [debug] [ThreadPool]: Using postgres connection "create_ida_datamart_ida_ida"
[0m02:15:29.780883 [debug] [ThreadPool]: On create_ida_datamart_ida_ida: COMMIT
[0m02:15:29.784930 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m02:15:29.785536 [debug] [ThreadPool]: On create_ida_datamart_ida_ida: Close
[0m02:15:29.789900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ida_datamart_ida_ida, now list_ida_datamart_ida_ida)
[0m02:15:29.799426 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida_ida"
[0m02:15:29.800196 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: BEGIN
[0m02:15:29.800677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:15:29.810579 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:15:29.811154 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida_ida"
[0m02:15:29.811690 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart_ida_ida"} */
select
      'ida_datamart' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ida_ida'
    union all
    select
      'ida_datamart' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ida_ida'
    union all
    select
      'ida_datamart' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ida_ida'
  
[0m02:15:29.825185 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m02:15:29.826826 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: ROLLBACK
[0m02:15:29.827643 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: Close
[0m02:15:29.833886 [debug] [MainThread]: Using postgres connection "master"
[0m02:15:29.834420 [debug] [MainThread]: On master: BEGIN
[0m02:15:29.834940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:15:29.846201 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:15:29.846783 [debug] [MainThread]: Using postgres connection "master"
[0m02:15:29.847248 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:15:29.861041 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m02:15:29.864792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '924bc80f-0284-49c6-9f54-37750d0318ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f7f74fd00>]}
[0m02:15:29.866244 [debug] [MainThread]: On master: ROLLBACK
[0m02:15:29.867330 [debug] [MainThread]: Using postgres connection "master"
[0m02:15:29.867699 [debug] [MainThread]: On master: BEGIN
[0m02:15:29.869136 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:15:29.869592 [debug] [MainThread]: On master: COMMIT
[0m02:15:29.869938 [debug] [MainThread]: Using postgres connection "master"
[0m02:15:29.870247 [debug] [MainThread]: On master: COMMIT
[0m02:15:29.871010 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:15:29.871425 [debug] [MainThread]: On master: Close
[0m02:15:29.872273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:15:29.872753 [info ] [MainThread]: 
[0m02:15:29.886879 [debug] [Thread-1 (]: Began running node model.beanalytic_ida.dim_grupo_economico
[0m02:15:29.888434 [debug] [Thread-2 (]: Began running node model.beanalytic_ida.dim_servico
[0m02:15:29.891535 [debug] [Thread-3 (]: Began running node model.beanalytic_ida.dim_tempo
[0m02:15:29.889924 [info ] [Thread-1 (]: 1 of 5 START sql table model ida_ida.dim_grupo_economico ....................... [RUN]
[0m02:15:29.894408 [info ] [Thread-2 (]: 2 of 5 START sql table model ida_ida.dim_servico ............................... [RUN]
[0m02:15:29.896052 [info ] [Thread-3 (]: 3 of 5 START sql table model ida_ida.dim_tempo ................................. [RUN]
[0m02:15:29.898242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ida_datamart_ida_ida, now model.beanalytic_ida.dim_grupo_economico)
[0m02:15:29.900825 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.beanalytic_ida.dim_servico'
[0m02:15:29.903508 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.beanalytic_ida.dim_tempo'
[0m02:15:29.904461 [debug] [Thread-1 (]: Began compiling node model.beanalytic_ida.dim_grupo_economico
[0m02:15:29.905612 [debug] [Thread-2 (]: Began compiling node model.beanalytic_ida.dim_servico
[0m02:15:29.906162 [debug] [Thread-3 (]: Began compiling node model.beanalytic_ida.dim_tempo
[0m02:15:29.918634 [debug] [Thread-1 (]: Writing injected SQL for node "model.beanalytic_ida.dim_grupo_economico"
[0m02:15:29.923827 [debug] [Thread-2 (]: Writing injected SQL for node "model.beanalytic_ida.dim_servico"
[0m02:15:29.928362 [debug] [Thread-3 (]: Writing injected SQL for node "model.beanalytic_ida.dim_tempo"
[0m02:15:29.931887 [debug] [Thread-3 (]: Timing info for model.beanalytic_ida.dim_tempo (compile): 02:15:29.924897 => 02:15:29.931526
[0m02:15:29.934065 [debug] [Thread-3 (]: Began executing node model.beanalytic_ida.dim_tempo
[0m02:15:29.940674 [debug] [Thread-1 (]: Timing info for model.beanalytic_ida.dim_grupo_economico (compile): 02:15:29.906754 => 02:15:29.940293
[0m02:15:29.941680 [debug] [Thread-2 (]: Timing info for model.beanalytic_ida.dim_servico (compile): 02:15:29.919705 => 02:15:29.941347
[0m02:15:29.942286 [debug] [Thread-1 (]: Began executing node model.beanalytic_ida.dim_grupo_economico
[0m02:15:29.965768 [debug] [Thread-2 (]: Began executing node model.beanalytic_ida.dim_servico
[0m02:15:30.023205 [debug] [Thread-1 (]: Writing runtime sql for node "model.beanalytic_ida.dim_grupo_economico"
[0m02:15:30.024897 [debug] [Thread-2 (]: Writing runtime sql for node "model.beanalytic_ida.dim_servico"
[0m02:15:30.029074 [debug] [Thread-3 (]: Writing runtime sql for node "model.beanalytic_ida.dim_tempo"
[0m02:15:30.032263 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:15:30.033251 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:15:30.033969 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: BEGIN
[0m02:15:30.034799 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:15:30.035362 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: BEGIN
[0m02:15:30.035866 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:15:30.036512 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: BEGIN
[0m02:15:30.037160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:15:30.038105 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:15:30.048020 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:30.049265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:30.049898 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:30.050368 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:15:30.050986 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:15:30.051717 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:15:30.052317 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */

  
    

  create  table "ida_datamart"."ida_ida"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
  ano,
  mes,
  ano_mes,
  CASE WHEN mes BETWEEN 1 AND 3 THEN 1
       WHEN mes BETWEEN 4 AND 6 THEN 2
       WHEN mes BETWEEN 7 AND 9 THEN 3
       ELSE 4 END AS trimestre,
  CASE WHEN mes BETWEEN 1 AND 6 THEN 1 ELSE 2 END AS semestre
FROM "ida_datamart"."ida"."staging_ida"
  );
  
[0m02:15:30.052995 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */

  
    

  create  table "ida_datamart"."ida_ida"."dim_grupo_economico__dbt_tmp"
  
  
    as
  
  (
    

WITH grupo_norm AS (
  SELECT DISTINCT
    TRIM(UPPER(grupo_economico)) AS nome_raw,
    CASE 
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'OI%' THEN 'OI'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CLARO%' THEN 'CLARO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'VIVO%' OR TRIM(UPPER(grupo_economico)) LIKE 'TELEFÃ”NICA%' THEN 'VIVO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'TIM%' THEN 'TIM'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CTBC%' OR TRIM(UPPER(grupo_economico)) LIKE 'ALGAR%' THEN 'ALGAR'
      ELSE TRIM(UPPER(grupo_economico))
    END AS nome_final
  FROM "ida_datamart"."ida"."staging_ida"
)
SELECT DISTINCT nome_final AS nome_grupo
FROM grupo_norm
  );
  
[0m02:15:30.053684 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */

  
    

  create  table "ida_datamart"."ida_ida"."dim_servico__dbt_tmp"
  
  
    as
  
  (
    

WITH s AS (
  SELECT DISTINCT UPPER(servico) AS codigo_servico
  FROM "ida_datamart"."ida"."staging_ida"
)
SELECT 
  codigo_servico,
  CASE 
    WHEN codigo_servico = 'SMP' THEN 'ServiÃ§o MÃ³vel Pessoal'
    WHEN codigo_servico = 'STFC' THEN 'ServiÃ§o TelefÃ´nico Fixo Comutado'
    WHEN codigo_servico = 'SCM' THEN 'ServiÃ§o de ComunicaÃ§Ã£o MultimÃ­dia'
    ELSE codigo_servico
  END AS nome_servico,
  CASE 
    WHEN codigo_servico = 'SMP' THEN 'Telefonia Celular'
    WHEN codigo_servico = 'STFC' THEN 'Telefonia Fixa'
    WHEN codigo_servico = 'SCM' THEN 'Banda Larga Fixa'
    ELSE 'Outros'
  END AS descricao
FROM s
  );
  
[0m02:15:30.081213 [debug] [Thread-3 (]: SQL status: SELECT 76 in 0.0 seconds
[0m02:15:30.082082 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.0 seconds
[0m02:15:30.096869 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:15:30.103448 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:15:30.104063 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */
alter table "ida_datamart"."ida_ida"."dim_tempo__dbt_tmp" rename to "dim_tempo"
[0m02:15:30.104807 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */
alter table "ida_datamart"."ida_ida"."dim_servico__dbt_tmp" rename to "dim_servico"
[0m02:15:30.108462 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m02:15:30.109707 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:15:30.110644 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:15:30.117229 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:15:30.199284 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */
alter table "ida_datamart"."ida_ida"."dim_grupo_economico__dbt_tmp" rename to "dim_grupo_economico"
[0m02:15:30.211942 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: COMMIT
[0m02:15:30.212837 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:15:30.213746 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:15:30.214435 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: COMMIT
[0m02:15:30.210638 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: COMMIT
[0m02:15:30.217252 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: COMMIT
[0m02:15:30.218607 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:15:30.219288 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:15:30.219847 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: COMMIT
[0m02:15:30.220397 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: COMMIT
[0m02:15:30.223373 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m02:15:30.230019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:15:30.233496 [debug] [Thread-3 (]: Applying DROP to: "ida_datamart"."ida_ida"."dim_tempo__dbt_backup"
[0m02:15:30.234515 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m02:15:30.238430 [debug] [Thread-1 (]: Applying DROP to: "ida_datamart"."ida_ida"."dim_grupo_economico__dbt_backup"
[0m02:15:30.244070 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:15:30.247097 [debug] [Thread-2 (]: Applying DROP to: "ida_datamart"."ida_ida"."dim_servico__dbt_backup"
[0m02:15:30.248450 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:15:30.249002 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */
drop table if exists "ida_datamart"."ida_ida"."dim_tempo__dbt_backup" cascade
[0m02:15:30.250416 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:15:30.251067 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */
drop table if exists "ida_datamart"."ida_ida"."dim_grupo_economico__dbt_backup" cascade
[0m02:15:30.252162 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */
drop table if exists "ida_datamart"."ida_ida"."dim_servico__dbt_backup" cascade
[0m02:15:30.253436 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:15:30.254741 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:15:30.257372 [debug] [Thread-1 (]: Timing info for model.beanalytic_ida.dim_grupo_economico (execute): 02:15:29.976087 => 02:15:30.257131
[0m02:15:30.258087 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:15:30.260073 [debug] [Thread-3 (]: Timing info for model.beanalytic_ida.dim_tempo (execute): 02:15:29.935069 => 02:15:30.259857
[0m02:15:30.260755 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: Close
[0m02:15:30.262961 [debug] [Thread-2 (]: Timing info for model.beanalytic_ida.dim_servico (execute): 02:15:30.014301 => 02:15:30.262746
[0m02:15:30.263493 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: Close
[0m02:15:30.264389 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: Close
[0m02:15:30.265443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '924bc80f-0284-49c6-9f54-37750d0318ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f7f746260>]}
[0m02:15:30.266770 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '924bc80f-0284-49c6-9f54-37750d0318ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f7f7e70d0>]}
[0m02:15:30.268416 [info ] [Thread-1 (]: 1 of 5 OK created sql table model ida_ida.dim_grupo_economico .................. [[32mSELECT 16[0m in 0.37s]
[0m02:15:30.269809 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '924bc80f-0284-49c6-9f54-37750d0318ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f7f7bcfa0>]}
[0m02:15:30.270846 [info ] [Thread-3 (]: 3 of 5 OK created sql table model ida_ida.dim_tempo ............................ [[32mSELECT 76[0m in 0.36s]
[0m02:15:30.271743 [debug] [Thread-1 (]: Finished running node model.beanalytic_ida.dim_grupo_economico
[0m02:15:30.272415 [info ] [Thread-2 (]: 2 of 5 OK created sql table model ida_ida.dim_servico .......................... [[32mSELECT 3[0m in 0.37s]
[0m02:15:30.273155 [debug] [Thread-3 (]: Finished running node model.beanalytic_ida.dim_tempo
[0m02:15:30.274124 [debug] [Thread-2 (]: Finished running node model.beanalytic_ida.dim_servico
[0m02:15:30.276316 [debug] [Thread-4 (]: Began running node model.beanalytic_ida.fato_ida
[0m02:15:30.277142 [info ] [Thread-4 (]: 4 of 5 START sql table model ida_ida.fato_ida .................................. [RUN]
[0m02:15:30.278286 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.beanalytic_ida.fato_ida'
[0m02:15:30.278719 [debug] [Thread-4 (]: Began compiling node model.beanalytic_ida.fato_ida
[0m02:15:30.283878 [debug] [Thread-4 (]: Writing injected SQL for node "model.beanalytic_ida.fato_ida"
[0m02:15:30.285191 [debug] [Thread-4 (]: Timing info for model.beanalytic_ida.fato_ida (compile): 02:15:30.278960 => 02:15:30.284878
[0m02:15:30.285721 [debug] [Thread-4 (]: Began executing node model.beanalytic_ida.fato_ida
[0m02:15:30.291246 [debug] [Thread-4 (]: Writing runtime sql for node "model.beanalytic_ida.fato_ida"
[0m02:15:30.292274 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:15:30.292694 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: BEGIN
[0m02:15:30.293030 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:15:30.300373 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:30.300889 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:15:30.301411 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.fato_ida"} */

  
    

  create  table "ida_datamart"."ida_ida"."fato_ida__dbt_tmp"
  
  
    as
  
  (
    

WITH refined AS (
  SELECT 
    ano_mes,
    UPPER(servico) AS svc,
    CASE 
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'OI%' THEN 'OI'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CLARO%' THEN 'CLARO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'VIVO%' OR TRIM(UPPER(grupo_economico)) LIKE 'TELEFÃ”NICA%' THEN 'VIVO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'TIM%' THEN 'TIM'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CTBC%' OR TRIM(UPPER(grupo_economico)) LIKE 'ALGAR%' THEN 'ALGAR'
      ELSE TRIM(UPPER(grupo_economico))
    END AS grp,
    MAX(CASE WHEN variavel ILIKE 'Indicador de Desempenho%' OR variavel ILIKE 'Ãndice de Desempenho%' THEN valor END) AS val_ida,
    MAX(CASE WHEN variavel ILIKE 'Taxa de Resolvidas em 5 dias%' THEN valor END) AS tx_5d,
    MAX(CASE WHEN variavel ILIKE 'Taxa de Resolvidas no PerÃ­odo' THEN valor END) AS tx_tot,
    MAX(CASE WHEN variavel IN ('Total de SolicitaÃ§Ãµes', 'Quantidade de SolicitaÃ§Ãµes', 'Quantidade de reclamaÃ§Ãµes', 'Quantidade de ReclamaÃ§Ãµes', 'Quantidade de ReclamaÃ§Ãµes no PerÃ­odo', 'Total de ReclamaÃ§Ãµes') THEN valor END) AS sol_tot,
    MAX(CASE WHEN variavel IN ('Quantidade de resolvidas', 'Quantidade de Sol. Resolvidas no PerÃ­odo', 'Quantidade de Respondidas') THEN valor END) AS sol_res
  FROM "ida_datamart"."ida"."staging_ida"
  GROUP BY 1, 2, 3
),
calc AS (
  SELECT 
    *,
    COALESCE(sol_res, ROUND((sol_tot * tx_tot / 100)))::integer AS res_final
  FROM refined
)
SELECT 
  dt.id_tempo, dg.nome_grupo, ds.codigo_servico,
  COALESCE(c.val_ida, c.tx_5d, 0) AS taxa_solicitacoes_resolvidas_5dias,
  COALESCE(c.tx_tot, 0) AS taxa_solicitacoes_resolvidas,
  COALESCE(c.sol_tot, 0) AS total_solicitacoes,
  COALESCE(c.res_final, 0) AS solicitacoes_resolvidas
FROM calc c
JOIN "ida_datamart"."ida_ida"."dim_tempo" dt ON c.ano_mes = dt.ano_mes
JOIN "ida_datamart"."ida_ida"."dim_grupo_economico" dg ON c.grp = dg.nome_grupo
JOIN "ida_datamart"."ida_ida"."dim_servico" ds ON c.svc = ds.codigo_servico
  );
  
[0m02:15:30.306060 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column dt.id_tempo does not exist
LINE 41:   dt.id_tempo, dg.nome_grupo, ds.codigo_servico,
           ^

[0m02:15:30.306986 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: ROLLBACK
[0m02:15:30.307986 [debug] [Thread-4 (]: Timing info for model.beanalytic_ida.fato_ida (execute): 02:15:30.286026 => 02:15:30.307714
[0m02:15:30.308408 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: Close
[0m02:15:30.310917 [debug] [Thread-4 (]: Database Error in model fato_ida (models/facts/fato_ida.sql)
  column dt.id_tempo does not exist
  LINE 41:   dt.id_tempo, dg.nome_grupo, ds.codigo_servico,
             ^
  compiled Code at target/run/beanalytic_ida/models/facts/fato_ida.sql
[0m02:15:30.311471 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '924bc80f-0284-49c6-9f54-37750d0318ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f7f7e6e60>]}
[0m02:15:30.312084 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model ida_ida.fato_ida ......................... [[31mERROR[0m in 0.03s]
[0m02:15:30.312713 [debug] [Thread-4 (]: Finished running node model.beanalytic_ida.fato_ida
[0m02:15:30.314643 [debug] [Thread-3 (]: Began running node model.beanalytic_ida.long_delta
[0m02:15:30.315209 [info ] [Thread-3 (]: 5 of 5 SKIP relation ida_ida.long_delta ........................................ [[33mSKIP[0m]
[0m02:15:30.315709 [debug] [Thread-3 (]: Finished running node model.beanalytic_ida.long_delta
[0m02:15:30.318926 [debug] [MainThread]: Using postgres connection "master"
[0m02:15:30.319667 [debug] [MainThread]: On master: BEGIN
[0m02:15:30.320019 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:15:30.327776 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:15:30.328220 [debug] [MainThread]: On master: COMMIT
[0m02:15:30.328581 [debug] [MainThread]: Using postgres connection "master"
[0m02:15:30.328879 [debug] [MainThread]: On master: COMMIT
[0m02:15:30.329459 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:15:30.329776 [debug] [MainThread]: On master: Close
[0m02:15:30.330678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:15:30.331050 [debug] [MainThread]: Connection 'model.beanalytic_ida.dim_grupo_economico' was properly closed.
[0m02:15:30.331353 [debug] [MainThread]: Connection 'model.beanalytic_ida.dim_servico' was properly closed.
[0m02:15:30.331596 [debug] [MainThread]: Connection 'model.beanalytic_ida.dim_tempo' was properly closed.
[0m02:15:30.331830 [debug] [MainThread]: Connection 'model.beanalytic_ida.fato_ida' was properly closed.
[0m02:15:30.332167 [info ] [MainThread]: 
[0m02:15:30.332559 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m02:15:30.333596 [debug] [MainThread]: Command end result
[0m02:15:30.344878 [info ] [MainThread]: 
[0m02:15:30.345397 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:15:30.345998 [info ] [MainThread]: 
[0m02:15:30.346461 [error] [MainThread]:   Database Error in model fato_ida (models/facts/fato_ida.sql)
  column dt.id_tempo does not exist
  LINE 41:   dt.id_tempo, dg.nome_grupo, ds.codigo_servico,
             ^
  compiled Code at target/run/beanalytic_ida/models/facts/fato_ida.sql
[0m02:15:30.346987 [info ] [MainThread]: 
[0m02:15:30.347316 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m02:15:30.348307 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2894888, "process_user_time": 3.172455, "process_kernel_time": 0.296416, "process_mem_max_rss": "106820", "process_in_blocks": "8", "process_out_blocks": "2576", "command_success": false}
[0m02:15:30.348908 [debug] [MainThread]: Command `dbt run` failed at 02:15:30.348780 after 1.29 seconds
[0m02:15:30.349275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f83133730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f81358700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f7c6392d0>]}
[0m02:15:30.349690 [debug] [MainThread]: Flushing usage events
[0m02:15:43.565715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b7f63730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b62e2440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b62e1d80>]}


============================== 02:15:43.571873 | 12d49d02-c5ee-473c-a450-a19d14579588 ==============================
[0m02:15:43.571873 [info ] [MainThread]: Running with dbt=1.7.3
[0m02:15:43.572478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/dbt', 'log_path': '/opt/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:15:43.766067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12d49d02-c5ee-473c-a450-a19d14579588', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ba247c10>]}
[0m02:15:43.869577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12d49d02-c5ee-473c-a450-a19d14579588', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b6111420>]}
[0m02:15:43.870472 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m02:15:43.878191 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m02:15:43.911014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:15:43.911530 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:15:43.917579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12d49d02-c5ee-473c-a450-a19d14579588', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b46fe050>]}
[0m02:15:43.929814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12d49d02-c5ee-473c-a450-a19d14579588', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b46c8af0>]}
[0m02:15:43.930365 [info ] [MainThread]: Found 5 models, 17 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:15:43.930804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12d49d02-c5ee-473c-a450-a19d14579588', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b46c8d30>]}
[0m02:15:43.933111 [info ] [MainThread]: 
[0m02:15:43.934193 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:15:43.936149 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ida_datamart_ida_ida'
[0m02:15:43.949504 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida_ida"
[0m02:15:43.950130 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: BEGIN
[0m02:15:43.950587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:15:43.961208 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:15:43.961690 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida_ida"
[0m02:15:43.962059 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart_ida_ida"} */
select
      'ida_datamart' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ida_ida'
    union all
    select
      'ida_datamart' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ida_ida'
    union all
    select
      'ida_datamart' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ida_ida'
  
[0m02:15:43.965982 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m02:15:43.967420 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: ROLLBACK
[0m02:15:43.968212 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: Close
[0m02:15:43.976526 [debug] [MainThread]: Using postgres connection "master"
[0m02:15:43.977149 [debug] [MainThread]: On master: BEGIN
[0m02:15:43.977491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:15:43.985936 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:15:43.986488 [debug] [MainThread]: Using postgres connection "master"
[0m02:15:43.986962 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:15:43.992122 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m02:15:43.994084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12d49d02-c5ee-473c-a450-a19d14579588', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b48c0c70>]}
[0m02:15:43.994866 [debug] [MainThread]: On master: ROLLBACK
[0m02:15:43.995842 [debug] [MainThread]: Using postgres connection "master"
[0m02:15:43.996383 [debug] [MainThread]: On master: BEGIN
[0m02:15:43.997991 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.000048 [debug] [MainThread]: On master: COMMIT
[0m02:15:44.000919 [debug] [MainThread]: Using postgres connection "master"
[0m02:15:44.001237 [debug] [MainThread]: On master: COMMIT
[0m02:15:44.001970 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:15:44.002356 [debug] [MainThread]: On master: Close
[0m02:15:44.003195 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:15:44.003614 [info ] [MainThread]: 
[0m02:15:44.017264 [debug] [Thread-1 (]: Began running node test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1
[0m02:15:44.018319 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f
[0m02:15:44.019535 [debug] [Thread-3 (]: Began running node test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292
[0m02:15:44.020247 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM .. [RUN]
[0m02:15:44.021267 [debug] [Thread-4 (]: Began running node test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6
[0m02:15:44.021825 [info ] [Thread-2 (]: 2 of 17 START test not_null_dim_grupo_economico_nome_grupo ..................... [RUN]
[0m02:15:44.022813 [info ] [Thread-3 (]: 3 of 17 START test not_null_dim_servico_codigo_servico ......................... [RUN]
[0m02:15:44.024189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ida_datamart_ida_ida, now test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1)
[0m02:15:44.025090 [info ] [Thread-4 (]: 4 of 17 START test not_null_dim_tempo_ano ...................................... [RUN]
[0m02:15:44.026581 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f'
[0m02:15:44.027814 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292'
[0m02:15:44.028609 [debug] [Thread-1 (]: Began compiling node test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1
[0m02:15:44.029774 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6'
[0m02:15:44.030430 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f
[0m02:15:44.030937 [debug] [Thread-3 (]: Began compiling node test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292
[0m02:15:44.042823 [debug] [Thread-4 (]: Began compiling node test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6
[0m02:15:44.053202 [debug] [Thread-1 (]: Writing injected SQL for node "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"
[0m02:15:44.070104 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"
[0m02:15:44.075580 [debug] [Thread-3 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"
[0m02:15:44.081524 [debug] [Thread-4 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"
[0m02:15:44.085367 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292 (compile): 02:15:44.070521 => 02:15:44.084815
[0m02:15:44.086294 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f (compile): 02:15:44.053936 => 02:15:44.086038
[0m02:15:44.087440 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1 (compile): 02:15:44.031321 => 02:15:44.086944
[0m02:15:44.088069 [debug] [Thread-3 (]: Began executing node test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292
[0m02:15:44.089608 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6 (compile): 02:15:44.076428 => 02:15:44.088981
[0m02:15:44.090398 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f
[0m02:15:44.091443 [debug] [Thread-1 (]: Began executing node test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1
[0m02:15:44.103323 [debug] [Thread-4 (]: Began executing node test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6
[0m02:15:44.107860 [debug] [Thread-3 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"
[0m02:15:44.110752 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"
[0m02:15:44.113255 [debug] [Thread-1 (]: Writing runtime sql for node "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"
[0m02:15:44.115755 [debug] [Thread-4 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"
[0m02:15:44.118280 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"
[0m02:15:44.119099 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"
[0m02:15:44.120647 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292: BEGIN
[0m02:15:44.121410 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"
[0m02:15:44.121887 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"
[0m02:15:44.122855 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f: BEGIN
[0m02:15:44.123354 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:15:44.123865 [debug] [Thread-1 (]: On test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1: BEGIN
[0m02:15:44.124323 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6: BEGIN
[0m02:15:44.124862 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:15:44.125482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:15:44.126102 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:15:44.134782 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.136352 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.136911 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"
[0m02:15:44.139017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.138294 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"
[0m02:15:44.137677 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.139974 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome_grupo
from "ida_datamart"."ida_ida"."dim_grupo_economico"
where nome_grupo is null



      
    ) dbt_internal_test
[0m02:15:44.140521 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"
[0m02:15:44.141022 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select codigo_servico
from "ida_datamart"."ida_ida"."dim_servico"
where codigo_servico is null



      
    ) dbt_internal_test
[0m02:15:44.141489 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"
[0m02:15:44.142285 [debug] [Thread-1 (]: On test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        codigo_servico as value_field,
        count(*) as n_records

    from "ida_datamart"."ida_ida"."dim_servico"
    group by codigo_servico

)

select *
from all_values
where value_field not in (
    'SMP','STFC','SCM'
)



      
    ) dbt_internal_test
[0m02:15:44.143590 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ano
from "ida_datamart"."ida_ida"."dim_tempo"
where ano is null



      
    ) dbt_internal_test
[0m02:15:44.144422 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:15:44.144966 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:15:44.147982 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292 (execute): 02:15:44.091967 => 02:15:44.147679
[0m02:15:44.149365 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:15:44.151096 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f (execute): 02:15:44.108530 => 02:15:44.150845
[0m02:15:44.151505 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:15:44.152085 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292: ROLLBACK
[0m02:15:44.153659 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1 (execute): 02:15:44.111162 => 02:15:44.153406
[0m02:15:44.154152 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f: ROLLBACK
[0m02:15:44.155699 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6 (execute): 02:15:44.113616 => 02:15:44.155461
[0m02:15:44.156878 [debug] [Thread-1 (]: On test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1: ROLLBACK
[0m02:15:44.157707 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292: Close
[0m02:15:44.158613 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6: ROLLBACK
[0m02:15:44.159302 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f: Close
[0m02:15:44.160407 [debug] [Thread-1 (]: On test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1: Close
[0m02:15:44.161388 [info ] [Thread-3 (]: 3 of 17 PASS not_null_dim_servico_codigo_servico ............................... [[32mPASS[0m in 0.13s]
[0m02:15:44.165642 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6: Close
[0m02:15:44.163905 [info ] [Thread-2 (]: 2 of 17 PASS not_null_dim_grupo_economico_nome_grupo ........................... [[32mPASS[0m in 0.14s]
[0m02:15:44.168682 [debug] [Thread-3 (]: Finished running node test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292
[0m02:15:44.167044 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM ........ [[32mPASS[0m in 0.14s]
[0m02:15:44.171044 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f
[0m02:15:44.173281 [info ] [Thread-4 (]: 4 of 17 PASS not_null_dim_tempo_ano ............................................ [[32mPASS[0m in 0.14s]
[0m02:15:44.174751 [debug] [Thread-3 (]: Began running node test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d
[0m02:15:44.176160 [debug] [Thread-1 (]: Finished running node test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1
[0m02:15:44.177609 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972
[0m02:15:44.179026 [debug] [Thread-4 (]: Finished running node test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6
[0m02:15:44.179891 [info ] [Thread-3 (]: 5 of 17 START test not_null_dim_tempo_ano_mes .................................. [RUN]
[0m02:15:44.181461 [debug] [Thread-1 (]: Began running node test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941
[0m02:15:44.182313 [info ] [Thread-2 (]: 6 of 17 START test not_null_dim_tempo_mes ...................................... [RUN]
[0m02:15:44.183449 [debug] [Thread-4 (]: Began running node test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6
[0m02:15:44.184792 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292, now test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d)
[0m02:15:44.185819 [info ] [Thread-1 (]: 7 of 17 START test not_null_fato_ida_codigo_servico ............................ [RUN]
[0m02:15:44.187006 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f, now test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972)
[0m02:15:44.187854 [info ] [Thread-4 (]: 8 of 17 START test not_null_fato_ida_id_tempo .................................. [RUN]
[0m02:15:44.189384 [debug] [Thread-3 (]: Began compiling node test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d
[0m02:15:44.191005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1, now test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941)
[0m02:15:44.192059 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972
[0m02:15:44.194220 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6, now test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6)
[0m02:15:44.202123 [debug] [Thread-3 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"
[0m02:15:44.203215 [debug] [Thread-1 (]: Began compiling node test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941
[0m02:15:44.209055 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"
[0m02:15:44.211316 [debug] [Thread-4 (]: Began compiling node test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6
[0m02:15:44.218583 [debug] [Thread-1 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"
[0m02:15:44.221569 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972 (compile): 02:15:44.203884 => 02:15:44.220353
[0m02:15:44.223189 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d (compile): 02:15:44.195475 => 02:15:44.222512
[0m02:15:44.235562 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972
[0m02:15:44.319945 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941 (compile): 02:15:44.212588 => 02:15:44.319201
[0m02:15:44.333873 [debug] [Thread-4 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"
[0m02:15:44.334906 [debug] [Thread-3 (]: Began executing node test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d
[0m02:15:44.338567 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"
[0m02:15:44.339536 [debug] [Thread-1 (]: Began executing node test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941
[0m02:15:44.340462 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6 (compile): 02:15:44.224005 => 02:15:44.340129
[0m02:15:44.345890 [debug] [Thread-3 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"
[0m02:15:44.360537 [debug] [Thread-4 (]: Began executing node test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6
[0m02:15:44.363441 [debug] [Thread-1 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"
[0m02:15:44.364235 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"
[0m02:15:44.368187 [debug] [Thread-4 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"
[0m02:15:44.369314 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"
[0m02:15:44.370909 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972: BEGIN
[0m02:15:44.372639 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"
[0m02:15:44.375342 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"
[0m02:15:44.388307 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6: BEGIN
[0m02:15:44.387622 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941: BEGIN
[0m02:15:44.388792 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:15:44.389177 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:15:44.377883 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d: BEGIN
[0m02:15:44.390083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:15:44.393827 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:15:44.405193 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.407309 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"
[0m02:15:44.408730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.409592 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.410806 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_tempo
from "ida_datamart"."ida_ida"."fato_ida"
where id_tempo is null



      
    ) dbt_internal_test
[0m02:15:44.411781 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"
[0m02:15:44.412548 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.413701 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"
[0m02:15:44.415149 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select codigo_servico
from "ida_datamart"."ida_ida"."fato_ida"
where codigo_servico is null



      
    ) dbt_internal_test
[0m02:15:44.416274 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"
[0m02:15:44.417252 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "ida_ida.fato_ida" does not exist
LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
              ^

[0m02:15:44.418270 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mes
from "ida_datamart"."ida_ida"."dim_tempo"
where mes is null



      
    ) dbt_internal_test
[0m02:15:44.419818 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ano_mes
from "ida_datamart"."ida_ida"."dim_tempo"
where ano_mes is null



      
    ) dbt_internal_test
[0m02:15:44.421364 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "ida_ida.fato_ida" does not exist
LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
              ^

[0m02:15:44.422648 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6: ROLLBACK
[0m02:15:44.424419 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941: ROLLBACK
[0m02:15:44.426216 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6 (execute): 02:15:44.365262 => 02:15:44.425837
[0m02:15:44.427429 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941 (execute): 02:15:44.355728 => 02:15:44.426702
[0m02:15:44.428727 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:15:44.429543 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:15:44.431206 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6: Close
[0m02:15:44.433940 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941: Close
[0m02:15:44.436531 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d (execute): 02:15:44.341012 => 02:15:44.436137
[0m02:15:44.439463 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972 (execute): 02:15:44.335737 => 02:15:44.439039
[0m02:15:44.448217 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d: ROLLBACK
[0m02:15:44.453690 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972: ROLLBACK
[0m02:15:44.460211 [debug] [Thread-4 (]: Database Error in test not_null_fato_ida_id_tempo (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_id_tempo.sql
[0m02:15:44.461487 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d: Close
[0m02:15:44.463336 [debug] [Thread-1 (]: Database Error in test not_null_fato_ida_codigo_servico (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_codigo_servico.sql
[0m02:15:44.464059 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972: Close
[0m02:15:44.462530 [error] [Thread-4 (]: 8 of 17 ERROR not_null_fato_ida_id_tempo ....................................... [[31mERROR[0m in 0.27s]
[0m02:15:44.465885 [error] [Thread-1 (]: 7 of 17 ERROR not_null_fato_ida_codigo_servico ................................. [[31mERROR[0m in 0.28s]
[0m02:15:44.467126 [info ] [Thread-3 (]: 5 of 17 PASS not_null_dim_tempo_ano_mes ........................................ [[32mPASS[0m in 0.28s]
[0m02:15:44.468968 [info ] [Thread-2 (]: 6 of 17 PASS not_null_dim_tempo_mes ............................................ [[32mPASS[0m in 0.28s]
[0m02:15:44.470004 [debug] [Thread-4 (]: Finished running node test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6
[0m02:15:44.471439 [debug] [Thread-1 (]: Finished running node test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941
[0m02:15:44.472804 [debug] [Thread-3 (]: Finished running node test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d
[0m02:15:44.474054 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972
[0m02:15:44.475248 [debug] [Thread-4 (]: Began running node test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88
[0m02:15:44.476475 [debug] [Thread-1 (]: Began running node test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d
[0m02:15:44.478018 [debug] [Thread-3 (]: Began running node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:15:44.479412 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:15:44.480959 [info ] [Thread-4 (]: 9 of 17 START test not_null_fato_ida_nome_grupo ................................ [RUN]
[0m02:15:44.482382 [info ] [Thread-1 (]: 10 of 17 START test not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias ....... [RUN]
[0m02:15:44.483884 [info ] [Thread-3 (]: 11 of 17 START test not_null_long_delta_ano_mes ................................ [RUN]
[0m02:15:44.485039 [info ] [Thread-2 (]: 12 of 17 START test not_null_long_delta_diferenca .............................. [RUN]
[0m02:15:44.487052 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6, now test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88)
[0m02:15:44.489262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941, now test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d)
[0m02:15:44.491146 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d, now test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15)
[0m02:15:44.492450 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972, now test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b)
[0m02:15:44.493476 [debug] [Thread-4 (]: Began compiling node test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88
[0m02:15:44.494397 [debug] [Thread-1 (]: Began compiling node test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d
[0m02:15:44.495502 [debug] [Thread-3 (]: Began compiling node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:15:44.496730 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:15:44.507172 [debug] [Thread-4 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"
[0m02:15:44.515444 [debug] [Thread-1 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"
[0m02:15:44.521110 [debug] [Thread-3 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:15:44.534892 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:15:44.537387 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88 (compile): 02:15:44.497534 => 02:15:44.536747
[0m02:15:44.540302 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15 (compile): 02:15:44.516059 => 02:15:44.539761
[0m02:15:44.541455 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d (compile): 02:15:44.508462 => 02:15:44.540817
[0m02:15:44.543646 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b (compile): 02:15:44.522512 => 02:15:44.542664
[0m02:15:44.544987 [debug] [Thread-4 (]: Began executing node test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88
[0m02:15:44.545717 [debug] [Thread-3 (]: Began executing node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:15:44.546640 [debug] [Thread-1 (]: Began executing node test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d
[0m02:15:44.547433 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:15:44.550983 [debug] [Thread-4 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"
[0m02:15:44.554162 [debug] [Thread-3 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:15:44.557542 [debug] [Thread-1 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"
[0m02:15:44.560935 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:15:44.563968 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:15:44.564640 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"
[0m02:15:44.566411 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"
[0m02:15:44.567312 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:15:44.567802 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: BEGIN
[0m02:15:44.568381 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88: BEGIN
[0m02:15:44.568943 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d: BEGIN
[0m02:15:44.569457 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: BEGIN
[0m02:15:44.569999 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:15:44.570571 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:15:44.571112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:15:44.571699 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:15:44.583850 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.584984 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:15:44.585827 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select diferenca
from "ida_datamart"."ida_ida"."long_delta"
where diferenca is null



      
    ) dbt_internal_test
[0m02:15:44.586812 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.587553 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.588539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.589965 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "ida_ida.long_delta" does not exist
LINE 14: from "ida_datamart"."ida_ida"."long_delta"
              ^

[0m02:15:44.591937 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:15:44.592905 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"
[0m02:15:44.593494 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"
[0m02:15:44.594084 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: ROLLBACK
[0m02:15:44.594927 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ano_mes
from "ida_datamart"."ida_ida"."long_delta"
where ano_mes is null



      
    ) dbt_internal_test
[0m02:15:44.595667 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome_grupo
from "ida_datamart"."ida_ida"."fato_ida"
where nome_grupo is null



      
    ) dbt_internal_test
[0m02:15:44.596482 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxa_solicitacoes_resolvidas_5dias
from "ida_datamart"."ida_ida"."fato_ida"
where taxa_solicitacoes_resolvidas_5dias is null



      
    ) dbt_internal_test
[0m02:15:44.598091 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b (execute): 02:15:44.558342 => 02:15:44.597805
[0m02:15:44.599170 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "ida_ida.long_delta" does not exist
LINE 14: from "ida_datamart"."ida_ida"."long_delta"
              ^

[0m02:15:44.600391 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "ida_ida.fato_ida" does not exist
LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
              ^

[0m02:15:44.601508 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: Close
[0m02:15:44.602101 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "ida_ida.fato_ida" does not exist
LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
              ^

[0m02:15:44.602679 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: ROLLBACK
[0m02:15:44.603251 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88: ROLLBACK
[0m02:15:44.604945 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d: ROLLBACK
[0m02:15:44.607132 [debug] [Thread-2 (]: Database Error in test not_null_long_delta_diferenca (models/tests.yml)
  relation "ida_ida.long_delta" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."long_delta"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_long_delta_diferenca.sql
[0m02:15:44.608422 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15 (execute): 02:15:44.551615 => 02:15:44.607806
[0m02:15:44.609589 [error] [Thread-2 (]: 12 of 17 ERROR not_null_long_delta_diferenca ................................... [[31mERROR[0m in 0.12s]
[0m02:15:44.610353 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88 (execute): 02:15:44.547999 => 02:15:44.610095
[0m02:15:44.611011 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d (execute): 02:15:44.554816 => 02:15:44.610769
[0m02:15:44.611851 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: Close
[0m02:15:44.612753 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:15:44.613348 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88: Close
[0m02:15:44.614156 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d: Close
[0m02:15:44.615106 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:15:44.616912 [debug] [Thread-3 (]: Database Error in test not_null_long_delta_ano_mes (models/tests.yml)
  relation "ida_ida.long_delta" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."long_delta"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_long_delta_ano_mes.sql
[0m02:15:44.620172 [debug] [Thread-4 (]: Database Error in test not_null_fato_ida_nome_grupo (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_nome_grupo.sql
[0m02:15:44.623778 [info ] [Thread-2 (]: 13 of 17 START test not_null_long_delta_nome_grupo ............................. [RUN]
[0m02:15:44.628110 [debug] [Thread-1 (]: Database Error in test not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.sql
[0m02:15:44.626201 [error] [Thread-3 (]: 11 of 17 ERROR not_null_long_delta_ano_mes ..................................... [[31mERROR[0m in 0.14s]
[0m02:15:44.630485 [error] [Thread-4 (]: 9 of 17 ERROR not_null_fato_ida_nome_grupo ..................................... [[31mERROR[0m in 0.14s]
[0m02:15:44.633164 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b, now test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c)
[0m02:15:44.634564 [error] [Thread-1 (]: 10 of 17 ERROR not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias ............ [[31mERROR[0m in 0.15s]
[0m02:15:44.635680 [debug] [Thread-3 (]: Finished running node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:15:44.636437 [debug] [Thread-4 (]: Finished running node test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88
[0m02:15:44.637014 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:15:44.638005 [debug] [Thread-1 (]: Finished running node test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d
[0m02:15:44.639454 [debug] [Thread-3 (]: Began running node test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20
[0m02:15:44.641260 [debug] [Thread-4 (]: Began running node test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb
[0m02:15:44.647812 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:15:44.648907 [debug] [Thread-1 (]: Began running node test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9
[0m02:15:44.650300 [info ] [Thread-3 (]: 14 of 17 START test relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_  [RUN]
[0m02:15:44.652038 [info ] [Thread-4 (]: 15 of 17 START test relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_  [RUN]
[0m02:15:44.654015 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c (compile): 02:15:44.642197 => 02:15:44.653692
[0m02:15:44.653344 [info ] [Thread-1 (]: 16 of 17 START test unique_dim_grupo_economico_nome_grupo ...................... [RUN]
[0m02:15:44.655512 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15, now test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20)
[0m02:15:44.656736 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88, now test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb)
[0m02:15:44.657727 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:15:44.659299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d, now test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9)
[0m02:15:44.660224 [debug] [Thread-3 (]: Began compiling node test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20
[0m02:15:44.661017 [debug] [Thread-4 (]: Began compiling node test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb
[0m02:15:44.664306 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:15:44.665373 [debug] [Thread-1 (]: Began compiling node test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9
[0m02:15:44.682289 [debug] [Thread-3 (]: Writing injected SQL for node "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"
[0m02:15:44.693823 [debug] [Thread-4 (]: Writing injected SQL for node "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"
[0m02:15:44.704631 [debug] [Thread-1 (]: Writing injected SQL for node "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"
[0m02:15:44.705624 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:15:44.708354 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb (compile): 02:15:44.683800 => 02:15:44.707427
[0m02:15:44.709388 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20 (compile): 02:15:44.666231 => 02:15:44.709073
[0m02:15:44.710367 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: BEGIN
[0m02:15:44.711115 [debug] [Thread-4 (]: Began executing node test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb
[0m02:15:44.711749 [debug] [Thread-3 (]: Began executing node test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20
[0m02:15:44.712447 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:15:44.713199 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9 (compile): 02:15:44.696137 => 02:15:44.712743
[0m02:15:44.716222 [debug] [Thread-4 (]: Writing runtime sql for node "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"
[0m02:15:44.719107 [debug] [Thread-3 (]: Writing runtime sql for node "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"
[0m02:15:44.720345 [debug] [Thread-1 (]: Began executing node test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9
[0m02:15:44.722696 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"
[0m02:15:44.725969 [debug] [Thread-1 (]: Writing runtime sql for node "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"
[0m02:15:44.726627 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"
[0m02:15:44.727654 [debug] [Thread-4 (]: On test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb: BEGIN
[0m02:15:44.729136 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"
[0m02:15:44.729990 [debug] [Thread-3 (]: On test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20: BEGIN
[0m02:15:44.730601 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.731200 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:15:44.731801 [debug] [Thread-1 (]: On test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9: BEGIN
[0m02:15:44.732432 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:15:44.733001 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:15:44.733787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:15:44.735128 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome_grupo
from "ida_datamart"."ida_ida"."long_delta"
where nome_grupo is null



      
    ) dbt_internal_test
[0m02:15:44.737541 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "ida_ida.long_delta" does not exist
LINE 14: from "ida_datamart"."ida_ida"."long_delta"
              ^

[0m02:15:44.738503 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: ROLLBACK
[0m02:15:44.740006 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c (execute): 02:15:44.661549 => 02:15:44.739418
[0m02:15:44.740984 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: Close
[0m02:15:44.744237 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.746335 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.747258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.747785 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"
[0m02:15:44.749105 [debug] [Thread-2 (]: Database Error in test not_null_long_delta_nome_grupo (models/tests.yml)
  relation "ida_ida.long_delta" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."long_delta"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_long_delta_nome_grupo.sql
[0m02:15:44.749618 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"
[0m02:15:44.750143 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"
[0m02:15:44.751037 [debug] [Thread-3 (]: On test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select codigo_servico as from_field
    from "ida_datamart"."ida_ida"."fato_ida"
    where codigo_servico is not null
),

parent as (
    select codigo_servico as to_field
    from "ida_datamart"."ida_ida"."dim_servico"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:15:44.751917 [error] [Thread-2 (]: 13 of 17 ERROR not_null_long_delta_nome_grupo .................................. [[31mERROR[0m in 0.12s]
[0m02:15:44.752860 [debug] [Thread-4 (]: On test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select nome_grupo as from_field
    from "ida_datamart"."ida_ida"."fato_ida"
    where nome_grupo is not null
),

parent as (
    select nome_grupo as to_field
    from "ida_datamart"."ida_ida"."dim_grupo_economico"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:15:44.753532 [debug] [Thread-1 (]: On test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    nome_grupo as unique_field,
    count(*) as n_records

from "ida_datamart"."ida_ida"."dim_grupo_economico"
where nome_grupo is not null
group by nome_grupo
having count(*) > 1



      
    ) dbt_internal_test
[0m02:15:44.754807 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:15:44.756177 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "ida_ida.fato_ida" does not exist
LINE 13:     from "ida_datamart"."ida_ida"."fato_ida"
                  ^

[0m02:15:44.757546 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "ida_ida.fato_ida" does not exist
LINE 13:     from "ida_datamart"."ida_ida"."fato_ida"
                  ^

[0m02:15:44.758998 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912
[0m02:15:44.760123 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:15:44.760991 [debug] [Thread-3 (]: On test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20: ROLLBACK
[0m02:15:44.762208 [debug] [Thread-4 (]: On test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb: ROLLBACK
[0m02:15:44.763128 [info ] [Thread-2 (]: 17 of 17 START test unique_dim_tempo_ano_mes ................................... [RUN]
[0m02:15:44.765453 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9 (execute): 02:15:44.723445 => 02:15:44.765151
[0m02:15:44.767195 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c, now test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912)
[0m02:15:44.768168 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20 (execute): 02:15:44.716737 => 02:15:44.767815
[0m02:15:44.768990 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb (execute): 02:15:44.713557 => 02:15:44.768736
[0m02:15:44.769724 [debug] [Thread-1 (]: On test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9: ROLLBACK
[0m02:15:44.770602 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912
[0m02:15:44.771501 [debug] [Thread-3 (]: On test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20: Close
[0m02:15:44.772331 [debug] [Thread-4 (]: On test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb: Close
[0m02:15:44.778797 [debug] [Thread-1 (]: On test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9: Close
[0m02:15:44.778461 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"
[0m02:15:44.784498 [debug] [Thread-3 (]: Database Error in test relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_ (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 13:     from "ida_datamart"."ida_ida"."fato_ida"
                    ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/relationships_fato_ida_39fc0670d0f692e86a74323379d81e96.sql
[0m02:15:44.787846 [info ] [Thread-1 (]: 16 of 17 PASS unique_dim_grupo_economico_nome_grupo ............................ [[32mPASS[0m in 0.13s]
[0m02:15:44.789385 [error] [Thread-3 (]: 14 of 17 ERROR relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_  [[31mERROR[0m in 0.13s]
[0m02:15:44.791110 [debug] [Thread-4 (]: Database Error in test relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_ (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 13:     from "ida_datamart"."ida_ida"."fato_ida"
                    ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/relationships_fato_ida_bd8d8c048ed6e46d95904bcb78566992.sql
[0m02:15:44.792785 [debug] [Thread-1 (]: Finished running node test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9
[0m02:15:44.794162 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912 (compile): 02:15:44.773294 => 02:15:44.793574
[0m02:15:44.795343 [debug] [Thread-3 (]: Finished running node test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20
[0m02:15:44.796270 [error] [Thread-4 (]: 15 of 17 ERROR relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_  [[31mERROR[0m in 0.14s]
[0m02:15:44.797495 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912
[0m02:15:44.799049 [debug] [Thread-4 (]: Finished running node test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb
[0m02:15:44.805565 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"
[0m02:15:44.807288 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"
[0m02:15:44.807759 [debug] [Thread-2 (]: On test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912: BEGIN
[0m02:15:44.808145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:15:44.817996 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.819242 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"
[0m02:15:44.820922 [debug] [Thread-2 (]: On test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ano_mes as unique_field,
    count(*) as n_records

from "ida_datamart"."ida_ida"."dim_tempo"
where ano_mes is not null
group by ano_mes
having count(*) > 1



      
    ) dbt_internal_test
[0m02:15:44.824963 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:15:44.827329 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912 (execute): 02:15:44.799919 => 02:15:44.826987
[0m02:15:44.827823 [debug] [Thread-2 (]: On test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912: ROLLBACK
[0m02:15:44.828733 [debug] [Thread-2 (]: On test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912: Close
[0m02:15:44.829800 [info ] [Thread-2 (]: 17 of 17 PASS unique_dim_tempo_ano_mes ......................................... [[32mPASS[0m in 0.06s]
[0m02:15:44.830609 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912
[0m02:15:44.835320 [debug] [MainThread]: Using postgres connection "master"
[0m02:15:44.835914 [debug] [MainThread]: On master: BEGIN
[0m02:15:44.836304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:15:44.845606 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:15:44.846149 [debug] [MainThread]: On master: COMMIT
[0m02:15:44.846548 [debug] [MainThread]: Using postgres connection "master"
[0m02:15:44.846900 [debug] [MainThread]: On master: COMMIT
[0m02:15:44.847458 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:15:44.847853 [debug] [MainThread]: On master: Close
[0m02:15:44.848647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:15:44.849023 [debug] [MainThread]: Connection 'test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9' was properly closed.
[0m02:15:44.850106 [debug] [MainThread]: Connection 'test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912' was properly closed.
[0m02:15:44.850529 [debug] [MainThread]: Connection 'test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20' was properly closed.
[0m02:15:44.850813 [debug] [MainThread]: Connection 'test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb' was properly closed.
[0m02:15:44.851237 [info ] [MainThread]: 
[0m02:15:44.851672 [info ] [MainThread]: Finished running 17 tests in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m02:15:44.855200 [debug] [MainThread]: Command end result
[0m02:15:44.870137 [info ] [MainThread]: 
[0m02:15:44.871210 [info ] [MainThread]: [31mCompleted with 9 errors and 0 warnings:[0m
[0m02:15:44.873330 [info ] [MainThread]: 
[0m02:15:44.873832 [error] [MainThread]:   Database Error in test not_null_fato_ida_id_tempo (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_id_tempo.sql
[0m02:15:44.874849 [info ] [MainThread]: 
[0m02:15:44.876404 [error] [MainThread]:   Database Error in test not_null_fato_ida_codigo_servico (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_codigo_servico.sql
[0m02:15:44.877536 [info ] [MainThread]: 
[0m02:15:44.878453 [error] [MainThread]:   Database Error in test not_null_long_delta_diferenca (models/tests.yml)
  relation "ida_ida.long_delta" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."long_delta"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_long_delta_diferenca.sql
[0m02:15:44.878900 [info ] [MainThread]: 
[0m02:15:44.879270 [error] [MainThread]:   Database Error in test not_null_long_delta_ano_mes (models/tests.yml)
  relation "ida_ida.long_delta" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."long_delta"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_long_delta_ano_mes.sql
[0m02:15:44.879633 [info ] [MainThread]: 
[0m02:15:44.879996 [error] [MainThread]:   Database Error in test not_null_fato_ida_nome_grupo (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_nome_grupo.sql
[0m02:15:44.880306 [info ] [MainThread]: 
[0m02:15:44.880689 [error] [MainThread]:   Database Error in test not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.sql
[0m02:15:44.881064 [info ] [MainThread]: 
[0m02:15:44.881406 [error] [MainThread]:   Database Error in test not_null_long_delta_nome_grupo (models/tests.yml)
  relation "ida_ida.long_delta" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."long_delta"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_long_delta_nome_grupo.sql
[0m02:15:44.881724 [info ] [MainThread]: 
[0m02:15:44.882081 [error] [MainThread]:   Database Error in test relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_ (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 13:     from "ida_datamart"."ida_ida"."fato_ida"
                    ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/relationships_fato_ida_39fc0670d0f692e86a74323379d81e96.sql
[0m02:15:44.882416 [info ] [MainThread]: 
[0m02:15:44.882866 [error] [MainThread]:   Database Error in test relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_ (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 13:     from "ida_datamart"."ida_ida"."fato_ida"
                    ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/relationships_fato_ida_bd8d8c048ed6e46d95904bcb78566992.sql
[0m02:15:44.883237 [info ] [MainThread]: 
[0m02:15:44.883624 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=9 SKIP=0 TOTAL=17
[0m02:15:44.884635 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.3605275, "process_user_time": 3.213715, "process_kernel_time": 0.384512, "process_mem_max_rss": "106040", "process_out_blocks": "2896", "command_success": false, "process_in_blocks": "0"}
[0m02:15:44.885345 [debug] [MainThread]: Command `dbt test` failed at 02:15:44.885164 after 1.36 seconds
[0m02:15:44.885878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b7f63730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b45f6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b4572500>]}
[0m02:15:44.887174 [debug] [MainThread]: Flushing usage events
[0m02:16:20.168890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7c240e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7c06069e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7c0605570>]}


============================== 02:16:20.172500 | 803fde28-5d37-4b9f-90b6-834f077012c9 ==============================
[0m02:16:20.172500 [info ] [MainThread]: Running with dbt=1.7.3
[0m02:16:20.173026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/dbt/logs', 'profiles_dir': '/opt/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:16:20.364102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '803fde28-5d37-4b9f-90b6-834f077012c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7bee5c490>]}
[0m02:16:20.469034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '803fde28-5d37-4b9f-90b6-834f077012c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7c07bba60>]}
[0m02:16:20.469852 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m02:16:20.477554 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m02:16:20.489643 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:16:20.490641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '803fde28-5d37-4b9f-90b6-834f077012c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7beec5fc0>]}
[0m02:16:22.051274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '803fde28-5d37-4b9f-90b6-834f077012c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7bd1700d0>]}
[0m02:16:22.084206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '803fde28-5d37-4b9f-90b6-834f077012c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7bd173fa0>]}
[0m02:16:22.086216 [info ] [MainThread]: Found 5 models, 17 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:16:22.086883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '803fde28-5d37-4b9f-90b6-834f077012c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7bd33a050>]}
[0m02:16:22.089596 [info ] [MainThread]: 
[0m02:16:22.091015 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:16:22.093506 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ida_datamart'
[0m02:16:22.115263 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart"
[0m02:16:22.116529 [debug] [ThreadPool]: On list_ida_datamart: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart"} */

    select distinct nspname from pg_namespace
  
[0m02:16:22.118349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:22.163331 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:16:22.165706 [debug] [ThreadPool]: On list_ida_datamart: Close
[0m02:16:22.170101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ida_datamart, now list_ida_datamart_ida_ida)
[0m02:16:22.184015 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida_ida"
[0m02:16:22.184758 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: BEGIN
[0m02:16:22.185561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:16:22.197336 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:16:22.197975 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida_ida"
[0m02:16:22.198897 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart_ida_ida"} */
select
      'ida_datamart' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ida_ida'
    union all
    select
      'ida_datamart' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ida_ida'
    union all
    select
      'ida_datamart' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ida_ida'
  
[0m02:16:22.206373 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m02:16:22.210073 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: ROLLBACK
[0m02:16:22.211311 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: Close
[0m02:16:22.220713 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:22.221266 [debug] [MainThread]: On master: BEGIN
[0m02:16:22.221767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:16:22.234715 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:16:22.235295 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:22.235917 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:16:22.249429 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m02:16:22.251816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '803fde28-5d37-4b9f-90b6-834f077012c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7bd15fc10>]}
[0m02:16:22.252575 [debug] [MainThread]: On master: ROLLBACK
[0m02:16:22.253455 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:22.253882 [debug] [MainThread]: On master: BEGIN
[0m02:16:22.255769 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:16:22.256594 [debug] [MainThread]: On master: COMMIT
[0m02:16:22.257189 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:22.257623 [debug] [MainThread]: On master: COMMIT
[0m02:16:22.258420 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:16:22.258930 [debug] [MainThread]: On master: Close
[0m02:16:22.259972 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:16:22.260548 [info ] [MainThread]: 
[0m02:16:22.274292 [debug] [Thread-1 (]: Began running node model.beanalytic_ida.dim_grupo_economico
[0m02:16:22.276549 [debug] [Thread-2 (]: Began running node model.beanalytic_ida.dim_servico
[0m02:16:22.277861 [info ] [Thread-1 (]: 1 of 5 START sql table model ida_ida.dim_grupo_economico ....................... [RUN]
[0m02:16:22.278920 [debug] [Thread-3 (]: Began running node model.beanalytic_ida.dim_tempo
[0m02:16:22.279805 [info ] [Thread-2 (]: 2 of 5 START sql table model ida_ida.dim_servico ............................... [RUN]
[0m02:16:22.281337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ida_datamart_ida_ida, now model.beanalytic_ida.dim_grupo_economico)
[0m02:16:22.282299 [info ] [Thread-3 (]: 3 of 5 START sql table model ida_ida.dim_tempo ................................. [RUN]
[0m02:16:22.284138 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.beanalytic_ida.dim_servico'
[0m02:16:22.284956 [debug] [Thread-1 (]: Began compiling node model.beanalytic_ida.dim_grupo_economico
[0m02:16:22.286646 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.beanalytic_ida.dim_tempo'
[0m02:16:22.287269 [debug] [Thread-2 (]: Began compiling node model.beanalytic_ida.dim_servico
[0m02:16:22.298911 [debug] [Thread-3 (]: Began compiling node model.beanalytic_ida.dim_tempo
[0m02:16:22.300683 [debug] [Thread-1 (]: Writing injected SQL for node "model.beanalytic_ida.dim_grupo_economico"
[0m02:16:22.305524 [debug] [Thread-2 (]: Writing injected SQL for node "model.beanalytic_ida.dim_servico"
[0m02:16:22.310358 [debug] [Thread-3 (]: Writing injected SQL for node "model.beanalytic_ida.dim_tempo"
[0m02:16:22.313131 [debug] [Thread-1 (]: Timing info for model.beanalytic_ida.dim_grupo_economico (compile): 02:16:22.288026 => 02:16:22.312432
[0m02:16:22.314134 [debug] [Thread-2 (]: Timing info for model.beanalytic_ida.dim_servico (compile): 02:16:22.301444 => 02:16:22.313649
[0m02:16:22.315794 [debug] [Thread-3 (]: Timing info for model.beanalytic_ida.dim_tempo (compile): 02:16:22.306287 => 02:16:22.315070
[0m02:16:22.317035 [debug] [Thread-1 (]: Began executing node model.beanalytic_ida.dim_grupo_economico
[0m02:16:22.317907 [debug] [Thread-2 (]: Began executing node model.beanalytic_ida.dim_servico
[0m02:16:22.318758 [debug] [Thread-3 (]: Began executing node model.beanalytic_ida.dim_tempo
[0m02:16:22.456198 [debug] [Thread-1 (]: Writing runtime sql for node "model.beanalytic_ida.dim_grupo_economico"
[0m02:16:22.467296 [debug] [Thread-3 (]: Writing runtime sql for node "model.beanalytic_ida.dim_tempo"
[0m02:16:22.476495 [debug] [Thread-2 (]: Writing runtime sql for node "model.beanalytic_ida.dim_servico"
[0m02:16:22.478757 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:16:22.480918 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: BEGIN
[0m02:16:22.482956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:16:22.483959 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:16:22.485333 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:16:22.486950 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: BEGIN
[0m02:16:22.488065 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: BEGIN
[0m02:16:22.488996 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:16:22.490002 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:16:22.519609 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:22.521747 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:16:22.522413 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */

  
    

  create  table "ida_datamart"."ida_ida"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
  ano,
  mes,
  ano_mes,
  CASE WHEN mes BETWEEN 1 AND 3 THEN 1
       WHEN mes BETWEEN 4 AND 6 THEN 2
       WHEN mes BETWEEN 7 AND 9 THEN 3
       ELSE 4 END AS trimestre,
  CASE WHEN mes BETWEEN 1 AND 6 THEN 1 ELSE 2 END AS semestre
FROM "ida_datamart"."ida"."staging_ida"
  );
  
[0m02:16:22.523310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:22.525290 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:16:22.526978 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */

  
    

  create  table "ida_datamart"."ida_ida"."dim_grupo_economico__dbt_tmp"
  
  
    as
  
  (
    

WITH grupo_norm AS (
  SELECT DISTINCT
    TRIM(UPPER(grupo_economico)) AS nome_raw,
    CASE 
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'OI%' THEN 'OI'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CLARO%' THEN 'CLARO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'VIVO%' OR TRIM(UPPER(grupo_economico)) LIKE 'TELEFÃ”NICA%' THEN 'VIVO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'TIM%' THEN 'TIM'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CTBC%' OR TRIM(UPPER(grupo_economico)) LIKE 'ALGAR%' THEN 'ALGAR'
      ELSE TRIM(UPPER(grupo_economico))
    END AS nome_final
  FROM "ida_datamart"."ida"."staging_ida"
)
SELECT DISTINCT nome_final AS nome_grupo
FROM grupo_norm
  );
  
[0m02:16:22.528581 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:22.529662 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:16:22.530213 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */

  
    

  create  table "ida_datamart"."ida_ida"."dim_servico__dbt_tmp"
  
  
    as
  
  (
    

WITH s AS (
  SELECT DISTINCT UPPER(servico) AS codigo_servico
  FROM "ida_datamart"."ida"."staging_ida"
)
SELECT 
  codigo_servico,
  CASE 
    WHEN codigo_servico = 'SMP' THEN 'ServiÃ§o MÃ³vel Pessoal'
    WHEN codigo_servico = 'STFC' THEN 'ServiÃ§o TelefÃ´nico Fixo Comutado'
    WHEN codigo_servico = 'SCM' THEN 'ServiÃ§o de ComunicaÃ§Ã£o MultimÃ­dia'
    ELSE codigo_servico
  END AS nome_servico,
  CASE 
    WHEN codigo_servico = 'SMP' THEN 'Telefonia Celular'
    WHEN codigo_servico = 'STFC' THEN 'Telefonia Fixa'
    WHEN codigo_servico = 'SCM' THEN 'Banda Larga Fixa'
    ELSE 'Outros'
  END AS descricao
FROM s
  );
  
[0m02:16:22.543962 [debug] [Thread-3 (]: SQL status: SELECT 76 in 0.0 seconds
[0m02:16:22.565951 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.0 seconds
[0m02:16:22.564931 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:16:22.576845 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:16:22.578024 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */
alter table "ida_datamart"."ida_ida"."dim_tempo" rename to "dim_tempo__dbt_backup"
[0m02:16:22.579268 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */
alter table "ida_datamart"."ida_ida"."dim_servico" rename to "dim_servico__dbt_backup"
[0m02:16:22.582163 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:16:22.583703 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:16:22.592065 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:16:22.598049 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:16:22.600088 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */
alter table "ida_datamart"."ida_ida"."dim_servico__dbt_tmp" rename to "dim_servico"
[0m02:16:22.602280 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */
alter table "ida_datamart"."ida_ida"."dim_tempo__dbt_tmp" rename to "dim_tempo"
[0m02:16:22.606299 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:16:22.612959 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:16:22.619797 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m02:16:22.673336 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: COMMIT
[0m02:16:22.678611 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: COMMIT
[0m02:16:22.680340 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:16:22.681613 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:16:22.682834 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:16:22.684876 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */
alter table "ida_datamart"."ida_ida"."dim_grupo_economico" rename to "dim_grupo_economico__dbt_backup"
[0m02:16:22.685750 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: COMMIT
[0m02:16:22.686373 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: COMMIT
[0m02:16:22.688478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:16:22.695670 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:16:22.696810 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m02:16:22.697770 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m02:16:22.698851 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */
alter table "ida_datamart"."ida_ida"."dim_grupo_economico__dbt_tmp" rename to "dim_grupo_economico"
[0m02:16:22.720397 [debug] [Thread-2 (]: Applying DROP to: "ida_datamart"."ida_ida"."dim_servico__dbt_backup"
[0m02:16:22.727906 [debug] [Thread-3 (]: Applying DROP to: "ida_datamart"."ida_ida"."dim_tempo__dbt_backup"
[0m02:16:22.734334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:16:22.738059 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:16:22.741874 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:16:22.745347 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: COMMIT
[0m02:16:22.746063 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */
drop table if exists "ida_datamart"."ida_ida"."dim_servico__dbt_backup" cascade
[0m02:16:22.746959 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */
drop table if exists "ida_datamart"."ida_ida"."dim_tempo__dbt_backup" cascade
[0m02:16:22.747610 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:16:22.749624 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: COMMIT
[0m02:16:22.753465 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:16:22.758901 [debug] [Thread-1 (]: Applying DROP to: "ida_datamart"."ida_ida"."dim_grupo_economico__dbt_backup"
[0m02:16:22.760285 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:16:22.761035 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */
drop table if exists "ida_datamart"."ida_ida"."dim_grupo_economico__dbt_backup" cascade
[0m02:16:22.766771 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:16:22.768123 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:16:22.768988 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:16:22.771362 [debug] [Thread-2 (]: Timing info for model.beanalytic_ida.dim_servico (execute): 02:16:22.335844 => 02:16:22.771027
[0m02:16:22.773619 [debug] [Thread-3 (]: Timing info for model.beanalytic_ida.dim_tempo (execute): 02:16:22.371719 => 02:16:22.773305
[0m02:16:22.776205 [debug] [Thread-1 (]: Timing info for model.beanalytic_ida.dim_grupo_economico (execute): 02:16:22.319565 => 02:16:22.775920
[0m02:16:22.777148 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: Close
[0m02:16:22.778230 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: Close
[0m02:16:22.778842 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: Close
[0m02:16:22.780232 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803fde28-5d37-4b9f-90b6-834f077012c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7bd0fd360>]}
[0m02:16:22.782378 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803fde28-5d37-4b9f-90b6-834f077012c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7bd10fca0>]}
[0m02:16:22.784609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803fde28-5d37-4b9f-90b6-834f077012c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7bc707490>]}
[0m02:16:22.786133 [info ] [Thread-2 (]: 2 of 5 OK created sql table model ida_ida.dim_servico .......................... [[32mSELECT 3[0m in 0.50s]
[0m02:16:22.788066 [info ] [Thread-3 (]: 3 of 5 OK created sql table model ida_ida.dim_tempo ............................ [[32mSELECT 76[0m in 0.50s]
[0m02:16:22.789955 [info ] [Thread-1 (]: 1 of 5 OK created sql table model ida_ida.dim_grupo_economico .................. [[32mSELECT 16[0m in 0.50s]
[0m02:16:22.792141 [debug] [Thread-2 (]: Finished running node model.beanalytic_ida.dim_servico
[0m02:16:22.794119 [debug] [Thread-3 (]: Finished running node model.beanalytic_ida.dim_tempo
[0m02:16:22.795790 [debug] [Thread-1 (]: Finished running node model.beanalytic_ida.dim_grupo_economico
[0m02:16:22.799389 [debug] [Thread-4 (]: Began running node model.beanalytic_ida.fato_ida
[0m02:16:22.801142 [info ] [Thread-4 (]: 4 of 5 START sql table model ida_ida.fato_ida .................................. [RUN]
[0m02:16:22.802280 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.beanalytic_ida.fato_ida'
[0m02:16:22.803137 [debug] [Thread-4 (]: Began compiling node model.beanalytic_ida.fato_ida
[0m02:16:22.883106 [debug] [Thread-4 (]: Writing injected SQL for node "model.beanalytic_ida.fato_ida"
[0m02:16:22.884360 [debug] [Thread-4 (]: Timing info for model.beanalytic_ida.fato_ida (compile): 02:16:22.803439 => 02:16:22.884017
[0m02:16:22.884863 [debug] [Thread-4 (]: Began executing node model.beanalytic_ida.fato_ida
[0m02:16:22.892310 [debug] [Thread-4 (]: Writing runtime sql for node "model.beanalytic_ida.fato_ida"
[0m02:16:22.893947 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:16:22.894520 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: BEGIN
[0m02:16:22.895175 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:16:22.909636 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:22.910283 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:16:22.910868 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.fato_ida"} */

  
    

  create  table "ida_datamart"."ida_ida"."fato_ida__dbt_tmp"
  
  
    as
  
  (
    

WITH refined AS (
  SELECT 
    ano_mes,
    UPPER(servico) AS svc,
    CASE 
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'OI%' THEN 'OI'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CLARO%' THEN 'CLARO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'VIVO%' OR TRIM(UPPER(grupo_economico)) LIKE 'TELEFÃ”NICA%' THEN 'VIVO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'TIM%' THEN 'TIM'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CTBC%' OR TRIM(UPPER(grupo_economico)) LIKE 'ALGAR%' THEN 'ALGAR'
      ELSE TRIM(UPPER(grupo_economico))
    END AS grp,
    MAX(CASE WHEN variavel ILIKE 'Indicador de Desempenho%' OR variavel ILIKE 'Ãndice de Desempenho%' THEN valor END) AS val_ida,
    MAX(CASE WHEN variavel ILIKE 'Taxa de Resolvidas em 5 dias%' THEN valor END) AS tx_5d,
    MAX(CASE WHEN variavel ILIKE 'Taxa de Resolvidas no PerÃ­odo' THEN valor END) AS tx_tot,
    MAX(CASE WHEN variavel IN ('Total de SolicitaÃ§Ãµes', 'Quantidade de SolicitaÃ§Ãµes', 'Quantidade de reclamaÃ§Ãµes', 'Quantidade de ReclamaÃ§Ãµes', 'Quantidade de ReclamaÃ§Ãµes no PerÃ­odo', 'Total de ReclamaÃ§Ãµes') THEN valor END) AS sol_tot,
    MAX(CASE WHEN variavel IN ('Quantidade de resolvidas', 'Quantidade de Sol. Resolvidas no PerÃ­odo', 'Quantidade de Respondidas') THEN valor END) AS sol_res
  FROM "ida_datamart"."ida"."staging_ida"
  GROUP BY 1, 2, 3
),
calc AS (
  SELECT 
    *,
    COALESCE(sol_res, ROUND((sol_tot * tx_tot / 100)))::integer AS res_final
  FROM refined
)
SELECT 
  dt.id_tempo, dg.nome_grupo, ds.codigo_servico,
  COALESCE(c.val_ida, c.tx_5d, 0) AS taxa_solicitacoes_resolvidas_5dias,
  COALESCE(c.tx_tot, 0) AS taxa_solicitacoes_resolvidas,
  COALESCE(c.sol_tot, 0) AS total_solicitacoes,
  COALESCE(c.res_final, 0) AS solicitacoes_resolvidas
FROM calc c
JOIN "ida_datamart"."ida_ida"."dim_tempo" dt ON c.ano_mes = dt.ano_mes
JOIN "ida_datamart"."ida_ida"."dim_grupo_economico" dg ON c.grp = dg.nome_grupo
JOIN "ida_datamart"."ida_ida"."dim_servico" ds ON c.svc = ds.codigo_servico
  );
  
[0m02:16:22.917862 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column dt.id_tempo does not exist
LINE 41:   dt.id_tempo, dg.nome_grupo, ds.codigo_servico,
           ^

[0m02:16:22.918434 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: ROLLBACK
[0m02:16:22.919533 [debug] [Thread-4 (]: Timing info for model.beanalytic_ida.fato_ida (execute): 02:16:22.885134 => 02:16:22.919224
[0m02:16:22.920005 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: Close
[0m02:16:22.923260 [debug] [Thread-4 (]: Database Error in model fato_ida (models/facts/fato_ida.sql)
  column dt.id_tempo does not exist
  LINE 41:   dt.id_tempo, dg.nome_grupo, ds.codigo_servico,
             ^
  compiled Code at target/run/beanalytic_ida/models/facts/fato_ida.sql
[0m02:16:22.924946 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803fde28-5d37-4b9f-90b6-834f077012c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7bd107b50>]}
[0m02:16:22.925933 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model ida_ida.fato_ida ......................... [[31mERROR[0m in 0.12s]
[0m02:16:22.926958 [debug] [Thread-4 (]: Finished running node model.beanalytic_ida.fato_ida
[0m02:16:22.928892 [debug] [Thread-3 (]: Began running node model.beanalytic_ida.long_delta
[0m02:16:22.929569 [info ] [Thread-3 (]: 5 of 5 SKIP relation ida_ida.long_delta ........................................ [[33mSKIP[0m]
[0m02:16:22.930174 [debug] [Thread-3 (]: Finished running node model.beanalytic_ida.long_delta
[0m02:16:22.934140 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:22.934877 [debug] [MainThread]: On master: BEGIN
[0m02:16:22.935995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:16:22.947579 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:16:22.948200 [debug] [MainThread]: On master: COMMIT
[0m02:16:22.949628 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:22.950223 [debug] [MainThread]: On master: COMMIT
[0m02:16:22.951211 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:16:22.951662 [debug] [MainThread]: On master: Close
[0m02:16:22.952764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:16:22.953156 [debug] [MainThread]: Connection 'model.beanalytic_ida.dim_grupo_economico' was properly closed.
[0m02:16:22.953716 [debug] [MainThread]: Connection 'model.beanalytic_ida.dim_servico' was properly closed.
[0m02:16:22.954623 [debug] [MainThread]: Connection 'model.beanalytic_ida.dim_tempo' was properly closed.
[0m02:16:22.954983 [debug] [MainThread]: Connection 'model.beanalytic_ida.fato_ida' was properly closed.
[0m02:16:22.955487 [info ] [MainThread]: 
[0m02:16:22.955986 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m02:16:22.957197 [debug] [MainThread]: Command end result
[0m02:16:22.975777 [info ] [MainThread]: 
[0m02:16:22.976848 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:16:22.977370 [info ] [MainThread]: 
[0m02:16:22.977751 [error] [MainThread]:   Database Error in model fato_ida (models/facts/fato_ida.sql)
  column dt.id_tempo does not exist
  LINE 41:   dt.id_tempo, dg.nome_grupo, ds.codigo_servico,
             ^
  compiled Code at target/run/beanalytic_ida/models/facts/fato_ida.sql
[0m02:16:22.978143 [info ] [MainThread]: 
[0m02:16:22.978580 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m02:16:22.979614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.868706, "process_user_time": 4.504772, "process_kernel_time": 0.299519, "process_mem_max_rss": "113212", "process_in_blocks": "176", "process_out_blocks": "2752", "command_success": false}
[0m02:16:22.980297 [debug] [MainThread]: Command `dbt run` failed at 02:16:22.980144 after 2.87 seconds
[0m02:16:22.980787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7c240e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7bc705f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd7beec5300>]}
[0m02:16:22.981236 [debug] [MainThread]: Flushing usage events
[0m02:16:25.155459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca139753730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca13791cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca13791fee0>]}


============================== 02:16:25.161621 | 08986ff2-f57e-43b9-a971-ea5432ad86e7 ==============================
[0m02:16:25.161621 [info ] [MainThread]: Running with dbt=1.7.3
[0m02:16:25.162140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:16:25.374633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08986ff2-f57e-43b9-a971-ea5432ad86e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca13ba63c10>]}
[0m02:16:25.467889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08986ff2-f57e-43b9-a971-ea5432ad86e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca137944ca0>]}
[0m02:16:25.468799 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m02:16:25.478433 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m02:16:25.515588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:16:25.516050 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:16:25.521840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08986ff2-f57e-43b9-a971-ea5432ad86e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca135d2a0b0>]}
[0m02:16:25.532506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08986ff2-f57e-43b9-a971-ea5432ad86e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca135ef4b50>]}
[0m02:16:25.533262 [info ] [MainThread]: Found 5 models, 17 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:16:25.533652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08986ff2-f57e-43b9-a971-ea5432ad86e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca135ef4d90>]}
[0m02:16:25.536223 [info ] [MainThread]: 
[0m02:16:25.537161 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:16:25.539245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ida_datamart_ida_ida'
[0m02:16:25.553394 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida_ida"
[0m02:16:25.553877 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: BEGIN
[0m02:16:25.554188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:25.565563 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:16:25.566407 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida_ida"
[0m02:16:25.566833 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart_ida_ida"} */
select
      'ida_datamart' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ida_ida'
    union all
    select
      'ida_datamart' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ida_ida'
    union all
    select
      'ida_datamart' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ida_ida'
  
[0m02:16:25.570713 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m02:16:25.572123 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: ROLLBACK
[0m02:16:25.573100 [debug] [ThreadPool]: On list_ida_datamart_ida_ida: Close
[0m02:16:25.579297 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:25.579781 [debug] [MainThread]: On master: BEGIN
[0m02:16:25.580087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:16:25.590595 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:16:25.591191 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:25.591578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:16:25.596738 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m02:16:25.598035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08986ff2-f57e-43b9-a971-ea5432ad86e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca135ef4af0>]}
[0m02:16:25.598646 [debug] [MainThread]: On master: ROLLBACK
[0m02:16:25.599462 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:25.600053 [debug] [MainThread]: On master: BEGIN
[0m02:16:25.601233 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:16:25.601599 [debug] [MainThread]: On master: COMMIT
[0m02:16:25.601915 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:25.602170 [debug] [MainThread]: On master: COMMIT
[0m02:16:25.603143 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:16:25.603528 [debug] [MainThread]: On master: Close
[0m02:16:25.605901 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:16:25.606381 [info ] [MainThread]: 
[0m02:16:25.621379 [debug] [Thread-1 (]: Began running node test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1
[0m02:16:25.623597 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f
[0m02:16:25.625313 [debug] [Thread-3 (]: Began running node test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292
[0m02:16:25.626387 [debug] [Thread-4 (]: Began running node test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6
[0m02:16:25.628118 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM .. [RUN]
[0m02:16:25.629018 [info ] [Thread-2 (]: 2 of 17 START test not_null_dim_grupo_economico_nome_grupo ..................... [RUN]
[0m02:16:25.629904 [info ] [Thread-3 (]: 3 of 17 START test not_null_dim_servico_codigo_servico ......................... [RUN]
[0m02:16:25.631434 [info ] [Thread-4 (]: 4 of 17 START test not_null_dim_tempo_ano ...................................... [RUN]
[0m02:16:25.634225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ida_datamart_ida_ida, now test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1)
[0m02:16:25.636352 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f'
[0m02:16:25.642001 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292'
[0m02:16:25.644395 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6'
[0m02:16:25.645162 [debug] [Thread-1 (]: Began compiling node test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1
[0m02:16:25.645845 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f
[0m02:16:25.646680 [debug] [Thread-3 (]: Began compiling node test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292
[0m02:16:25.647279 [debug] [Thread-4 (]: Began compiling node test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6
[0m02:16:25.682208 [debug] [Thread-1 (]: Writing injected SQL for node "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"
[0m02:16:25.690060 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"
[0m02:16:25.692225 [debug] [Thread-3 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"
[0m02:16:25.699014 [debug] [Thread-4 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"
[0m02:16:25.702472 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1 (compile): 02:16:25.647638 => 02:16:25.702119
[0m02:16:25.703421 [debug] [Thread-1 (]: Began executing node test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1
[0m02:16:25.721362 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6 (compile): 02:16:25.692598 => 02:16:25.720626
[0m02:16:25.723526 [debug] [Thread-1 (]: Writing runtime sql for node "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"
[0m02:16:25.724167 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f (compile): 02:16:25.664016 => 02:16:25.723859
[0m02:16:25.724833 [debug] [Thread-4 (]: Began executing node test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6
[0m02:16:25.725943 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f
[0m02:16:25.726414 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"
[0m02:16:25.727315 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292 (compile): 02:16:25.674722 => 02:16:25.726811
[0m02:16:25.729990 [debug] [Thread-4 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"
[0m02:16:25.733017 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"
[0m02:16:25.733664 [debug] [Thread-1 (]: On test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1: BEGIN
[0m02:16:25.734499 [debug] [Thread-3 (]: Began executing node test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292
[0m02:16:25.735718 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"
[0m02:16:25.736849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:16:25.737804 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"
[0m02:16:25.740442 [debug] [Thread-3 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"
[0m02:16:25.741208 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6: BEGIN
[0m02:16:25.741923 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f: BEGIN
[0m02:16:25.742820 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:16:25.743767 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:16:25.744254 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"
[0m02:16:25.745824 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292: BEGIN
[0m02:16:25.746697 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:16:25.751682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:25.752670 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"
[0m02:16:25.754194 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:25.755030 [debug] [Thread-1 (]: On test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        codigo_servico as value_field,
        count(*) as n_records

    from "ida_datamart"."ida_ida"."dim_servico"
    group by codigo_servico

)

select *
from all_values
where value_field not in (
    'SMP','STFC','SCM'
)



      
    ) dbt_internal_test
[0m02:16:25.756408 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"
[0m02:16:25.757204 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:25.758090 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome_grupo
from "ida_datamart"."ida_ida"."dim_grupo_economico"
where nome_grupo is null



      
    ) dbt_internal_test
[0m02:16:25.758633 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"
[0m02:16:25.759538 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ano
from "ida_datamart"."ida_ida"."dim_tempo"
where ano is null



      
    ) dbt_internal_test
[0m02:16:25.760613 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:16:25.761758 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:16:25.763087 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:25.764021 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:16:25.766656 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1 (execute): 02:16:25.704513 => 02:16:25.766300
[0m02:16:25.768473 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f (execute): 02:16:25.730584 => 02:16:25.768212
[0m02:16:25.768996 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"
[0m02:16:25.770791 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6 (execute): 02:16:25.727786 => 02:16:25.770489
[0m02:16:25.771619 [debug] [Thread-1 (]: On test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1: ROLLBACK
[0m02:16:25.772557 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f: ROLLBACK
[0m02:16:25.773122 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select codigo_servico
from "ida_datamart"."ida_ida"."dim_servico"
where codigo_servico is null



      
    ) dbt_internal_test
[0m02:16:25.773647 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6: ROLLBACK
[0m02:16:25.775004 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f: Close
[0m02:16:25.776093 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6: Close
[0m02:16:25.776578 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:16:25.777151 [debug] [Thread-1 (]: On test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1: Close
[0m02:16:25.778850 [info ] [Thread-2 (]: 2 of 17 PASS not_null_dim_grupo_economico_nome_grupo ........................... [[32mPASS[0m in 0.14s]
[0m02:16:25.779953 [info ] [Thread-4 (]: 4 of 17 PASS not_null_dim_tempo_ano ............................................ [[32mPASS[0m in 0.14s]
[0m02:16:25.782124 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292 (execute): 02:16:25.738136 => 02:16:25.781812
[0m02:16:25.783621 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f
[0m02:16:25.784792 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM ........ [[32mPASS[0m in 0.15s]
[0m02:16:25.786770 [debug] [Thread-4 (]: Finished running node test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6
[0m02:16:25.787663 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292: ROLLBACK
[0m02:16:25.788348 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d
[0m02:16:25.789877 [debug] [Thread-1 (]: Finished running node test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1
[0m02:16:25.791440 [debug] [Thread-4 (]: Began running node test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972
[0m02:16:25.793249 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292: Close
[0m02:16:25.794217 [info ] [Thread-2 (]: 5 of 17 START test not_null_dim_tempo_ano_mes .................................. [RUN]
[0m02:16:25.796087 [debug] [Thread-1 (]: Began running node test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941
[0m02:16:25.797828 [info ] [Thread-4 (]: 6 of 17 START test not_null_dim_tempo_mes ...................................... [RUN]
[0m02:16:25.799596 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f, now test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d)
[0m02:16:25.801150 [info ] [Thread-3 (]: 3 of 17 PASS not_null_dim_servico_codigo_servico ............................... [[32mPASS[0m in 0.16s]
[0m02:16:25.802626 [info ] [Thread-1 (]: 7 of 17 START test not_null_fato_ida_codigo_servico ............................ [RUN]
[0m02:16:25.805378 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6, now test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972)
[0m02:16:25.806773 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d
[0m02:16:25.808303 [debug] [Thread-3 (]: Finished running node test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292
[0m02:16:25.809889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1, now test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941)
[0m02:16:25.810950 [debug] [Thread-4 (]: Began compiling node test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972
[0m02:16:25.817750 [debug] [Thread-3 (]: Began running node test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6
[0m02:16:25.818948 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"
[0m02:16:25.820048 [debug] [Thread-1 (]: Began compiling node test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941
[0m02:16:25.826818 [debug] [Thread-4 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"
[0m02:16:25.827797 [info ] [Thread-3 (]: 8 of 17 START test not_null_fato_ida_id_tempo .................................. [RUN]
[0m02:16:25.835032 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d (compile): 02:16:25.811698 => 02:16:25.834601
[0m02:16:25.837021 [debug] [Thread-1 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"
[0m02:16:25.839033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292, now test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6)
[0m02:16:25.839770 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d
[0m02:16:25.840318 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972 (compile): 02:16:25.821150 => 02:16:25.840075
[0m02:16:25.841411 [debug] [Thread-3 (]: Began compiling node test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6
[0m02:16:25.842175 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941 (compile): 02:16:25.829065 => 02:16:25.841705
[0m02:16:25.892662 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"
[0m02:16:25.893475 [debug] [Thread-4 (]: Began executing node test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972
[0m02:16:25.897997 [debug] [Thread-3 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"
[0m02:16:25.898843 [debug] [Thread-1 (]: Began executing node test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941
[0m02:16:25.901940 [debug] [Thread-4 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"
[0m02:16:25.902637 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"
[0m02:16:25.906389 [debug] [Thread-1 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"
[0m02:16:25.907225 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6 (compile): 02:16:25.893866 => 02:16:25.906952
[0m02:16:25.908677 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d: BEGIN
[0m02:16:25.909413 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"
[0m02:16:25.910531 [debug] [Thread-3 (]: Began executing node test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6
[0m02:16:25.911084 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"
[0m02:16:25.911716 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:16:25.912424 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972: BEGIN
[0m02:16:25.915149 [debug] [Thread-3 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"
[0m02:16:25.915704 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941: BEGIN
[0m02:16:25.916635 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:16:25.917806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:16:25.918653 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"
[0m02:16:25.920915 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6: BEGIN
[0m02:16:25.921829 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:16:25.927008 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:25.927590 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"
[0m02:16:25.928474 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ano_mes
from "ida_datamart"."ida_ida"."dim_tempo"
where ano_mes is null



      
    ) dbt_internal_test
[0m02:16:25.929791 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:25.931401 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"
[0m02:16:25.932065 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:16:25.933024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:25.934121 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:25.934647 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mes
from "ida_datamart"."ida_ida"."dim_tempo"
where mes is null



      
    ) dbt_internal_test
[0m02:16:25.936565 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d (execute): 02:16:25.842721 => 02:16:25.936306
[0m02:16:25.937076 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"
[0m02:16:25.937736 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"
[0m02:16:25.938401 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d: ROLLBACK
[0m02:16:25.939205 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select codigo_servico
from "ida_datamart"."ida_ida"."fato_ida"
where codigo_servico is null



      
    ) dbt_internal_test
[0m02:16:25.939754 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:16:25.940390 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_tempo
from "ida_datamart"."ida_ida"."fato_ida"
where id_tempo is null



      
    ) dbt_internal_test
[0m02:16:25.941306 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d: Close
[0m02:16:25.942917 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972 (execute): 02:16:25.899810 => 02:16:25.942661
[0m02:16:25.943670 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "ida_ida.fato_ida" does not exist
LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
              ^

[0m02:16:25.945281 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "ida_ida.fato_ida" does not exist
LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
              ^

[0m02:16:25.945940 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972: ROLLBACK
[0m02:16:25.947071 [info ] [Thread-2 (]: 5 of 17 PASS not_null_dim_tempo_ano_mes ........................................ [[32mPASS[0m in 0.15s]
[0m02:16:25.947787 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941: ROLLBACK
[0m02:16:25.948280 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6: ROLLBACK
[0m02:16:25.949594 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d
[0m02:16:25.950222 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972: Close
[0m02:16:25.952382 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6 (execute): 02:16:25.912809 => 02:16:25.951756
[0m02:16:25.953706 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941 (execute): 02:16:25.904098 => 02:16:25.953169
[0m02:16:25.954537 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88
[0m02:16:25.955933 [info ] [Thread-4 (]: 6 of 17 PASS not_null_dim_tempo_mes ............................................ [[32mPASS[0m in 0.15s]
[0m02:16:25.957798 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6: Close
[0m02:16:25.958678 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941: Close
[0m02:16:25.959524 [info ] [Thread-2 (]: 9 of 17 START test not_null_fato_ida_nome_grupo ................................ [RUN]
[0m02:16:25.960336 [debug] [Thread-4 (]: Finished running node test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972
[0m02:16:25.965265 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d, now test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88)
[0m02:16:25.968063 [debug] [Thread-4 (]: Began running node test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d
[0m02:16:25.970752 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88
[0m02:16:25.972190 [info ] [Thread-4 (]: 10 of 17 START test not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias ....... [RUN]
[0m02:16:25.979157 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"
[0m02:16:25.986144 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972, now test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d)
[0m02:16:25.990661 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88 (compile): 02:16:25.974233 => 02:16:25.990214
[0m02:16:25.994177 [debug] [Thread-1 (]: Database Error in test not_null_fato_ida_codigo_servico (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_codigo_servico.sql
[0m02:16:25.994911 [debug] [Thread-4 (]: Began compiling node test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d
[0m02:16:25.996270 [debug] [Thread-3 (]: Database Error in test not_null_fato_ida_id_tempo (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_id_tempo.sql
[0m02:16:25.996983 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88
[0m02:16:25.997927 [error] [Thread-1 (]: 7 of 17 ERROR not_null_fato_ida_codigo_servico ................................. [[31mERROR[0m in 0.19s]
[0m02:16:26.004182 [debug] [Thread-4 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"
[0m02:16:26.005217 [error] [Thread-3 (]: 8 of 17 ERROR not_null_fato_ida_id_tempo ....................................... [[31mERROR[0m in 0.17s]
[0m02:16:26.008770 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"
[0m02:16:26.009857 [debug] [Thread-1 (]: Finished running node test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941
[0m02:16:26.011438 [debug] [Thread-3 (]: Finished running node test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6
[0m02:16:26.012661 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d (compile): 02:16:25.998592 => 02:16:26.011966
[0m02:16:26.013960 [debug] [Thread-1 (]: Began running node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:16:26.014583 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"
[0m02:16:26.015456 [debug] [Thread-3 (]: Began running node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:16:26.017404 [debug] [Thread-4 (]: Began executing node test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d
[0m02:16:26.018569 [info ] [Thread-1 (]: 11 of 17 START test not_null_long_delta_ano_mes ................................ [RUN]
[0m02:16:26.019431 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88: BEGIN
[0m02:16:26.020243 [info ] [Thread-3 (]: 12 of 17 START test not_null_long_delta_diferenca .............................. [RUN]
[0m02:16:26.025411 [debug] [Thread-4 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"
[0m02:16:26.026716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941, now test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15)
[0m02:16:26.027583 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:16:26.028739 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6, now test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b)
[0m02:16:26.029717 [debug] [Thread-1 (]: Began compiling node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:16:26.031219 [debug] [Thread-3 (]: Began compiling node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:16:26.032172 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"
[0m02:16:26.040087 [debug] [Thread-1 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:16:26.046720 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:26.046147 [debug] [Thread-3 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:16:26.047810 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d: BEGIN
[0m02:16:26.048587 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"
[0m02:16:26.049953 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b (compile): 02:16:26.041235 => 02:16:26.049665
[0m02:16:26.050513 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15 (compile): 02:16:26.033275 => 02:16:26.050190
[0m02:16:26.051266 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:16:26.051838 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome_grupo
from "ida_datamart"."ida_ida"."fato_ida"
where nome_grupo is null



      
    ) dbt_internal_test
[0m02:16:26.052371 [debug] [Thread-3 (]: Began executing node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:16:26.053113 [debug] [Thread-1 (]: Began executing node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:16:26.056570 [debug] [Thread-3 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:16:26.057576 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "ida_ida.fato_ida" does not exist
LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
              ^

[0m02:16:26.060488 [debug] [Thread-1 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:16:26.061719 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88: ROLLBACK
[0m02:16:26.063162 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:16:26.064355 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:26.066488 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88 (execute): 02:16:26.006190 => 02:16:26.066122
[0m02:16:26.067356 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: BEGIN
[0m02:16:26.068160 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:16:26.068997 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"
[0m02:16:26.069794 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88: Close
[0m02:16:26.070620 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:16:26.071517 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: BEGIN
[0m02:16:26.072119 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxa_solicitacoes_resolvidas_5dias
from "ida_datamart"."ida_ida"."fato_ida"
where taxa_solicitacoes_resolvidas_5dias is null



      
    ) dbt_internal_test
[0m02:16:26.076097 [debug] [Thread-2 (]: Database Error in test not_null_fato_ida_nome_grupo (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_nome_grupo.sql
[0m02:16:26.077424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:16:26.079250 [error] [Thread-2 (]: 9 of 17 ERROR not_null_fato_ida_nome_grupo ..................................... [[31mERROR[0m in 0.11s]
[0m02:16:26.080436 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "ida_ida.fato_ida" does not exist
LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
              ^

[0m02:16:26.083531 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88
[0m02:16:26.085281 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d: ROLLBACK
[0m02:16:26.086628 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:26.090676 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:16:26.092794 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:16:26.096174 [info ] [Thread-2 (]: 13 of 17 START test not_null_long_delta_nome_grupo ............................. [RUN]
[0m02:16:26.094757 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d (execute): 02:16:26.021362 => 02:16:26.094248
[0m02:16:26.097654 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select diferenca
from "ida_datamart"."ida_ida"."long_delta"
where diferenca is null



      
    ) dbt_internal_test
[0m02:16:26.099737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88, now test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c)
[0m02:16:26.101174 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d: Close
[0m02:16:26.102818 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:16:26.104131 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "ida_ida.long_delta" does not exist
LINE 14: from "ida_datamart"."ida_ida"."long_delta"
              ^

[0m02:16:26.105522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:26.115973 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:16:26.118136 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: ROLLBACK
[0m02:16:26.119824 [debug] [Thread-4 (]: Database Error in test not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.sql
[0m02:16:26.121088 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:16:26.123429 [error] [Thread-4 (]: 10 of 17 ERROR not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias ............ [[31mERROR[0m in 0.14s]
[0m02:16:26.124232 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b (execute): 02:16:26.054077 => 02:16:26.123954
[0m02:16:26.125726 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ano_mes
from "ida_datamart"."ida_ida"."long_delta"
where ano_mes is null



      
    ) dbt_internal_test
[0m02:16:26.126803 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c (compile): 02:16:26.106510 => 02:16:26.126137
[0m02:16:26.127935 [debug] [Thread-4 (]: Finished running node test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d
[0m02:16:26.128582 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: Close
[0m02:16:26.129692 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:16:26.130611 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "ida_ida.long_delta" does not exist
LINE 14: from "ida_datamart"."ida_ida"."long_delta"
              ^

[0m02:16:26.131892 [debug] [Thread-4 (]: Began running node test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20
[0m02:16:26.134971 [debug] [Thread-3 (]: Database Error in test not_null_long_delta_diferenca (models/tests.yml)
  relation "ida_ida.long_delta" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."long_delta"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_long_delta_diferenca.sql
[0m02:16:26.139396 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:16:26.140349 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: ROLLBACK
[0m02:16:26.141265 [info ] [Thread-4 (]: 14 of 17 START test relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_  [RUN]
[0m02:16:26.142313 [error] [Thread-3 (]: 12 of 17 ERROR not_null_long_delta_diferenca ................................... [[31mERROR[0m in 0.11s]
[0m02:16:26.143327 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:16:26.144784 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d, now test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20)
[0m02:16:26.145546 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15 (execute): 02:16:26.058285 => 02:16:26.145283
[0m02:16:26.146550 [debug] [Thread-3 (]: Finished running node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:16:26.147190 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: BEGIN
[0m02:16:26.147877 [debug] [Thread-4 (]: Began compiling node test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20
[0m02:16:26.148687 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: Close
[0m02:16:26.149700 [debug] [Thread-3 (]: Began running node test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb
[0m02:16:26.150981 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:16:26.164881 [debug] [Thread-4 (]: Writing injected SQL for node "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"
[0m02:16:26.166666 [info ] [Thread-3 (]: 15 of 17 START test relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_  [RUN]
[0m02:16:26.169605 [debug] [Thread-1 (]: Database Error in test not_null_long_delta_ano_mes (models/tests.yml)
  relation "ida_ida.long_delta" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."long_delta"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_long_delta_ano_mes.sql
[0m02:16:26.171325 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b, now test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb)
[0m02:16:26.172474 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20 (compile): 02:16:26.151385 => 02:16:26.171851
[0m02:16:26.173715 [error] [Thread-1 (]: 11 of 17 ERROR not_null_long_delta_ano_mes ..................................... [[31mERROR[0m in 0.15s]
[0m02:16:26.174854 [debug] [Thread-3 (]: Began compiling node test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb
[0m02:16:26.175935 [debug] [Thread-4 (]: Began executing node test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20
[0m02:16:26.177153 [debug] [Thread-1 (]: Finished running node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:16:26.189364 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:26.192897 [debug] [Thread-4 (]: Writing runtime sql for node "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"
[0m02:16:26.188742 [debug] [Thread-3 (]: Writing injected SQL for node "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"
[0m02:16:26.195138 [debug] [Thread-1 (]: Began running node test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9
[0m02:16:26.196381 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:16:26.198773 [info ] [Thread-1 (]: 16 of 17 START test unique_dim_grupo_economico_nome_grupo ...................... [RUN]
[0m02:16:26.200727 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"
[0m02:16:26.201712 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb (compile): 02:16:26.177758 => 02:16:26.201424
[0m02:16:26.202527 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome_grupo
from "ida_datamart"."ida_ida"."long_delta"
where nome_grupo is null



      
    ) dbt_internal_test
[0m02:16:26.203817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15, now test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9)
[0m02:16:26.204650 [debug] [Thread-4 (]: On test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20: BEGIN
[0m02:16:26.205395 [debug] [Thread-3 (]: Began executing node test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb
[0m02:16:26.206585 [debug] [Thread-1 (]: Began compiling node test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9
[0m02:16:26.207810 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "ida_ida.long_delta" does not exist
LINE 14: from "ida_datamart"."ida_ida"."long_delta"
              ^

[0m02:16:26.208838 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:16:26.212044 [debug] [Thread-3 (]: Writing runtime sql for node "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"
[0m02:16:26.221425 [debug] [Thread-1 (]: Writing injected SQL for node "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"
[0m02:16:26.222376 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: ROLLBACK
[0m02:16:26.225041 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"
[0m02:16:26.226320 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9 (compile): 02:16:26.212716 => 02:16:26.225667
[0m02:16:26.227535 [debug] [Thread-3 (]: On test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb: BEGIN
[0m02:16:26.228814 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c (execute): 02:16:26.136386 => 02:16:26.228273
[0m02:16:26.229738 [debug] [Thread-1 (]: Began executing node test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9
[0m02:16:26.230302 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:16:26.230914 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: Close
[0m02:16:26.234412 [debug] [Thread-1 (]: Writing runtime sql for node "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"
[0m02:16:26.236915 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:26.240831 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"
[0m02:16:26.243365 [debug] [Thread-2 (]: Database Error in test not_null_long_delta_nome_grupo (models/tests.yml)
  relation "ida_ida.long_delta" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."long_delta"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_long_delta_nome_grupo.sql
[0m02:16:26.244448 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"
[0m02:16:26.245845 [debug] [Thread-4 (]: On test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select codigo_servico as from_field
    from "ida_datamart"."ida_ida"."fato_ida"
    where codigo_servico is not null
),

parent as (
    select codigo_servico as to_field
    from "ida_datamart"."ida_ida"."dim_servico"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:16:26.247227 [error] [Thread-2 (]: 13 of 17 ERROR not_null_long_delta_nome_grupo .................................. [[31mERROR[0m in 0.15s]
[0m02:16:26.247957 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:26.248992 [debug] [Thread-1 (]: On test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9: BEGIN
[0m02:16:26.251371 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:16:26.252366 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "ida_ida.fato_ida" does not exist
LINE 13:     from "ida_datamart"."ida_ida"."fato_ida"
                  ^

[0m02:16:26.253607 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"
[0m02:16:26.254500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:16:26.255383 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912
[0m02:16:26.256973 [debug] [Thread-4 (]: On test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20: ROLLBACK
[0m02:16:26.257772 [debug] [Thread-3 (]: On test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select nome_grupo as from_field
    from "ida_datamart"."ida_ida"."fato_ida"
    where nome_grupo is not null
),

parent as (
    select nome_grupo as to_field
    from "ida_datamart"."ida_ida"."dim_grupo_economico"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:16:26.259005 [info ] [Thread-2 (]: 17 of 17 START test unique_dim_tempo_ano_mes ................................... [RUN]
[0m02:16:26.261216 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20 (execute): 02:16:26.190123 => 02:16:26.260191
[0m02:16:26.262272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c, now test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912)
[0m02:16:26.263205 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "ida_ida.fato_ida" does not exist
LINE 13:     from "ida_datamart"."ida_ida"."fato_ida"
                  ^

[0m02:16:26.264432 [debug] [Thread-4 (]: On test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20: Close
[0m02:16:26.265390 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912
[0m02:16:26.267090 [debug] [Thread-3 (]: On test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb: ROLLBACK
[0m02:16:26.277932 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"
[0m02:16:26.278830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:26.281312 [debug] [Thread-4 (]: Database Error in test relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_ (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 13:     from "ida_datamart"."ida_ida"."fato_ida"
                    ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/relationships_fato_ida_39fc0670d0f692e86a74323379d81e96.sql
[0m02:16:26.282828 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb (execute): 02:16:26.209529 => 02:16:26.282061
[0m02:16:26.284869 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"
[0m02:16:26.285790 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912 (compile): 02:16:26.269690 => 02:16:26.285446
[0m02:16:26.286830 [error] [Thread-4 (]: 14 of 17 ERROR relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_  [[31mERROR[0m in 0.14s]
[0m02:16:26.288106 [debug] [Thread-3 (]: On test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb: Close
[0m02:16:26.289502 [debug] [Thread-1 (]: On test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    nome_grupo as unique_field,
    count(*) as n_records

from "ida_datamart"."ida_ida"."dim_grupo_economico"
where nome_grupo is not null
group by nome_grupo
having count(*) > 1



      
    ) dbt_internal_test
[0m02:16:26.290597 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912
[0m02:16:26.291581 [debug] [Thread-4 (]: Finished running node test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20
[0m02:16:26.297763 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"
[0m02:16:26.299257 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:16:26.302265 [debug] [Thread-3 (]: Database Error in test relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_ (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 13:     from "ida_datamart"."ida_ida"."fato_ida"
                    ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/relationships_fato_ida_bd8d8c048ed6e46d95904bcb78566992.sql
[0m02:16:26.306776 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9 (execute): 02:16:26.231332 => 02:16:26.306308
[0m02:16:26.308565 [error] [Thread-3 (]: 15 of 17 ERROR relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_  [[31mERROR[0m in 0.14s]
[0m02:16:26.309580 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"
[0m02:16:26.310864 [debug] [Thread-1 (]: On test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9: ROLLBACK
[0m02:16:26.312260 [debug] [Thread-3 (]: Finished running node test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb
[0m02:16:26.312860 [debug] [Thread-2 (]: On test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912: BEGIN
[0m02:16:26.314142 [debug] [Thread-1 (]: On test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9: Close
[0m02:16:26.314698 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:16:26.317497 [info ] [Thread-1 (]: 16 of 17 PASS unique_dim_grupo_economico_nome_grupo ............................ [[32mPASS[0m in 0.11s]
[0m02:16:26.320818 [debug] [Thread-1 (]: Finished running node test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9
[0m02:16:26.331954 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:16:26.333663 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"
[0m02:16:26.336025 [debug] [Thread-2 (]: On test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ano_mes as unique_field,
    count(*) as n_records

from "ida_datamart"."ida_ida"."dim_tempo"
where ano_mes is not null
group by ano_mes
having count(*) > 1



      
    ) dbt_internal_test
[0m02:16:26.339583 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:16:26.341572 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912 (execute): 02:16:26.294500 => 02:16:26.341233
[0m02:16:26.342090 [debug] [Thread-2 (]: On test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912: ROLLBACK
[0m02:16:26.343111 [debug] [Thread-2 (]: On test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912: Close
[0m02:16:26.344286 [info ] [Thread-2 (]: 17 of 17 PASS unique_dim_tempo_ano_mes ......................................... [[32mPASS[0m in 0.08s]
[0m02:16:26.345042 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912
[0m02:16:26.349783 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:26.351107 [debug] [MainThread]: On master: BEGIN
[0m02:16:26.351557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:16:26.362660 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:16:26.363545 [debug] [MainThread]: On master: COMMIT
[0m02:16:26.364000 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:26.364362 [debug] [MainThread]: On master: COMMIT
[0m02:16:26.365476 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:16:26.366962 [debug] [MainThread]: On master: Close
[0m02:16:26.367940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:16:26.368387 [debug] [MainThread]: Connection 'test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9' was properly closed.
[0m02:16:26.368841 [debug] [MainThread]: Connection 'test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912' was properly closed.
[0m02:16:26.369188 [debug] [MainThread]: Connection 'test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb' was properly closed.
[0m02:16:26.369502 [debug] [MainThread]: Connection 'test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20' was properly closed.
[0m02:16:26.369939 [info ] [MainThread]: 
[0m02:16:26.370480 [info ] [MainThread]: Finished running 17 tests in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m02:16:26.373902 [debug] [MainThread]: Command end result
[0m02:16:26.388486 [info ] [MainThread]: 
[0m02:16:26.389217 [info ] [MainThread]: [31mCompleted with 9 errors and 0 warnings:[0m
[0m02:16:26.389706 [info ] [MainThread]: 
[0m02:16:26.390133 [error] [MainThread]:   Database Error in test not_null_fato_ida_codigo_servico (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_codigo_servico.sql
[0m02:16:26.390583 [info ] [MainThread]: 
[0m02:16:26.390921 [error] [MainThread]:   Database Error in test not_null_fato_ida_id_tempo (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_id_tempo.sql
[0m02:16:26.391219 [info ] [MainThread]: 
[0m02:16:26.391598 [error] [MainThread]:   Database Error in test not_null_fato_ida_nome_grupo (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_nome_grupo.sql
[0m02:16:26.392698 [info ] [MainThread]: 
[0m02:16:26.393157 [error] [MainThread]:   Database Error in test not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."fato_ida"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.sql
[0m02:16:26.393565 [info ] [MainThread]: 
[0m02:16:26.393956 [error] [MainThread]:   Database Error in test not_null_long_delta_diferenca (models/tests.yml)
  relation "ida_ida.long_delta" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."long_delta"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_long_delta_diferenca.sql
[0m02:16:26.394370 [info ] [MainThread]: 
[0m02:16:26.394797 [error] [MainThread]:   Database Error in test not_null_long_delta_ano_mes (models/tests.yml)
  relation "ida_ida.long_delta" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."long_delta"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_long_delta_ano_mes.sql
[0m02:16:26.395169 [info ] [MainThread]: 
[0m02:16:26.395461 [error] [MainThread]:   Database Error in test not_null_long_delta_nome_grupo (models/tests.yml)
  relation "ida_ida.long_delta" does not exist
  LINE 14: from "ida_datamart"."ida_ida"."long_delta"
                ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/not_null_long_delta_nome_grupo.sql
[0m02:16:26.395841 [info ] [MainThread]: 
[0m02:16:26.396227 [error] [MainThread]:   Database Error in test relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_ (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 13:     from "ida_datamart"."ida_ida"."fato_ida"
                    ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/relationships_fato_ida_39fc0670d0f692e86a74323379d81e96.sql
[0m02:16:26.396592 [info ] [MainThread]: 
[0m02:16:26.397136 [error] [MainThread]:   Database Error in test relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_ (models/tests.yml)
  relation "ida_ida.fato_ida" does not exist
  LINE 13:     from "ida_datamart"."ida_ida"."fato_ida"
                    ^
  compiled Code at target/run/beanalytic_ida/models/tests.yml/relationships_fato_ida_bd8d8c048ed6e46d95904bcb78566992.sql
[0m02:16:26.399118 [info ] [MainThread]: 
[0m02:16:26.400635 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=9 SKIP=0 TOTAL=17
[0m02:16:26.403204 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.2926155, "process_user_time": 3.826651, "process_kernel_time": 0.804557, "process_mem_max_rss": "106188", "process_in_blocks": "16", "process_out_blocks": "2904", "command_success": false}
[0m02:16:26.404177 [debug] [MainThread]: Command `dbt test` failed at 02:16:26.403975 after 1.29 seconds
[0m02:16:26.405070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca139753730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca134451cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca137944ca0>]}
[0m02:16:26.405589 [debug] [MainThread]: Flushing usage events
[0m02:17:05.566609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b264c3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b24664940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b24667fd0>]}


============================== 02:17:05.573493 | 519f7f8f-1f3c-4872-8686-4b3e186da6b2 ==============================
[0m02:17:05.573493 [info ] [MainThread]: Running with dbt=1.7.3
[0m02:17:05.574124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/dbt', 'log_path': '/opt/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_tempo dim_grupo_economico dim_servico fato_ida long_delta', 'send_anonymous_usage_stats': 'True'}
[0m02:17:05.766966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '519f7f8f-1f3c-4872-8686-4b3e186da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b285885e0>]}
[0m02:17:05.861717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '519f7f8f-1f3c-4872-8686-4b3e186da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b246a9420>]}
[0m02:17:05.862619 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m02:17:05.870685 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m02:17:05.907488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:17:05.908193 [debug] [MainThread]: Partial parsing: added file: beanalytic_ida://macros/generate_schema_name.sql
[0m02:17:05.910368 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m02:17:07.133737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '519f7f8f-1f3c-4872-8686-4b3e186da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b210f15a0>]}
[0m02:17:07.146022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '519f7f8f-1f3c-4872-8686-4b3e186da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b22c41660>]}
[0m02:17:07.146582 [info ] [MainThread]: Found 5 models, 17 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m02:17:07.147011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '519f7f8f-1f3c-4872-8686-4b3e186da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b22c41a50>]}
[0m02:17:07.148950 [info ] [MainThread]: 
[0m02:17:07.150654 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:17:07.153075 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ida_datamart'
[0m02:17:07.163703 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart"
[0m02:17:07.164169 [debug] [ThreadPool]: On list_ida_datamart: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart"} */

    select distinct nspname from pg_namespace
  
[0m02:17:07.164627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:17:07.175483 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:17:07.176820 [debug] [ThreadPool]: On list_ida_datamart: Close
[0m02:17:07.179903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ida_datamart, now list_ida_datamart_ida)
[0m02:17:07.187645 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida"
[0m02:17:07.188692 [debug] [ThreadPool]: On list_ida_datamart_ida: BEGIN
[0m02:17:07.189091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:17:07.198091 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:17:07.198691 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida"
[0m02:17:07.199132 [debug] [ThreadPool]: On list_ida_datamart_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart_ida"} */
select
      'ida_datamart' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ida'
    union all
    select
      'ida_datamart' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ida'
    union all
    select
      'ida_datamart' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ida'
  
[0m02:17:07.204854 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:17:07.206377 [debug] [ThreadPool]: On list_ida_datamart_ida: ROLLBACK
[0m02:17:07.207429 [debug] [ThreadPool]: On list_ida_datamart_ida: Close
[0m02:17:07.214678 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:07.215329 [debug] [MainThread]: On master: BEGIN
[0m02:17:07.215721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:17:07.224558 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:17:07.225020 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:07.225441 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:17:07.229094 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m02:17:07.230993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '519f7f8f-1f3c-4872-8686-4b3e186da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b22c406a0>]}
[0m02:17:07.231419 [debug] [MainThread]: On master: ROLLBACK
[0m02:17:07.232014 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:07.232342 [debug] [MainThread]: On master: BEGIN
[0m02:17:07.233436 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:17:07.234006 [debug] [MainThread]: On master: COMMIT
[0m02:17:07.234318 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:07.234692 [debug] [MainThread]: On master: COMMIT
[0m02:17:07.235403 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:17:07.235786 [debug] [MainThread]: On master: Close
[0m02:17:07.236618 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:17:07.237134 [info ] [MainThread]: 
[0m02:17:07.247371 [debug] [Thread-1 (]: Began running node model.beanalytic_ida.dim_grupo_economico
[0m02:17:07.250622 [info ] [Thread-1 (]: 1 of 5 START sql table model ida.dim_grupo_economico ........................... [RUN]
[0m02:17:07.249338 [debug] [Thread-3 (]: Began running node model.beanalytic_ida.dim_tempo
[0m02:17:07.251976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ida_datamart_ida, now model.beanalytic_ida.dim_grupo_economico)
[0m02:17:07.248151 [debug] [Thread-2 (]: Began running node model.beanalytic_ida.dim_servico
[0m02:17:07.253258 [info ] [Thread-3 (]: 3 of 5 START sql table model ida.dim_tempo ..................................... [RUN]
[0m02:17:07.254544 [debug] [Thread-1 (]: Began compiling node model.beanalytic_ida.dim_grupo_economico
[0m02:17:07.255265 [info ] [Thread-2 (]: 2 of 5 START sql table model ida.dim_servico ................................... [RUN]
[0m02:17:07.256849 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.beanalytic_ida.dim_tempo'
[0m02:17:07.267532 [debug] [Thread-1 (]: Writing injected SQL for node "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:07.268873 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.beanalytic_ida.dim_servico'
[0m02:17:07.269480 [debug] [Thread-3 (]: Began compiling node model.beanalytic_ida.dim_tempo
[0m02:17:07.270642 [debug] [Thread-2 (]: Began compiling node model.beanalytic_ida.dim_servico
[0m02:17:07.274407 [debug] [Thread-3 (]: Writing injected SQL for node "model.beanalytic_ida.dim_tempo"
[0m02:17:07.278022 [debug] [Thread-2 (]: Writing injected SQL for node "model.beanalytic_ida.dim_servico"
[0m02:17:07.278984 [debug] [Thread-1 (]: Timing info for model.beanalytic_ida.dim_grupo_economico (compile): 02:17:07.257501 => 02:17:07.278386
[0m02:17:07.281820 [debug] [Thread-1 (]: Began executing node model.beanalytic_ida.dim_grupo_economico
[0m02:17:07.293902 [debug] [Thread-2 (]: Timing info for model.beanalytic_ida.dim_servico (compile): 02:17:07.274983 => 02:17:07.293276
[0m02:17:07.295026 [debug] [Thread-3 (]: Timing info for model.beanalytic_ida.dim_tempo (compile): 02:17:07.271201 => 02:17:07.294410
[0m02:17:07.317954 [debug] [Thread-2 (]: Began executing node model.beanalytic_ida.dim_servico
[0m02:17:07.334592 [debug] [Thread-3 (]: Began executing node model.beanalytic_ida.dim_tempo
[0m02:17:07.456665 [debug] [Thread-3 (]: Writing runtime sql for node "model.beanalytic_ida.dim_tempo"
[0m02:17:07.457964 [debug] [Thread-1 (]: Writing runtime sql for node "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:07.462936 [debug] [Thread-2 (]: Writing runtime sql for node "model.beanalytic_ida.dim_servico"
[0m02:17:07.467569 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:17:07.468938 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:07.471585 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: BEGIN
[0m02:17:07.473144 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:17:07.474418 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: BEGIN
[0m02:17:07.476079 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:17:07.477243 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: BEGIN
[0m02:17:07.478247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:07.480074 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:17:07.490829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:07.491489 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:07.492488 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */

  
    

  create  table "ida_datamart"."ida"."dim_grupo_economico__dbt_tmp"
  
  
    as
  
  (
    

WITH grupo_norm AS (
  SELECT DISTINCT
    TRIM(UPPER(grupo_economico)) AS nome_raw,
    CASE 
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'OI%' THEN 'OI'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CLARO%' THEN 'CLARO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'VIVO%' OR TRIM(UPPER(grupo_economico)) LIKE 'TELEFÃ”NICA%' THEN 'VIVO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'TIM%' THEN 'TIM'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CTBC%' OR TRIM(UPPER(grupo_economico)) LIKE 'ALGAR%' THEN 'ALGAR'
      ELSE TRIM(UPPER(grupo_economico))
    END AS nome_final
  FROM "ida_datamart"."ida"."staging_ida"
)
SELECT DISTINCT nome_final AS nome_grupo
FROM grupo_norm
  );
  
[0m02:17:07.505792 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:07.506950 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:07.507800 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:17:07.508906 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:17:07.509842 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */

  
    

  create  table "ida_datamart"."ida"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
  ano,
  mes,
  ano_mes,
  CASE WHEN mes BETWEEN 1 AND 3 THEN 1
       WHEN mes BETWEEN 4 AND 6 THEN 2
       WHEN mes BETWEEN 7 AND 9 THEN 3
       ELSE 4 END AS trimestre,
  CASE WHEN mes BETWEEN 1 AND 6 THEN 1 ELSE 2 END AS semestre
FROM "ida_datamart"."ida"."staging_ida"
  );
  
[0m02:17:07.510988 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */

  
    

  create  table "ida_datamart"."ida"."dim_servico__dbt_tmp"
  
  
    as
  
  (
    

WITH s AS (
  SELECT DISTINCT UPPER(servico) AS codigo_servico
  FROM "ida_datamart"."ida"."staging_ida"
)
SELECT 
  codigo_servico,
  CASE 
    WHEN codigo_servico = 'SMP' THEN 'ServiÃ§o MÃ³vel Pessoal'
    WHEN codigo_servico = 'STFC' THEN 'ServiÃ§o TelefÃ´nico Fixo Comutado'
    WHEN codigo_servico = 'SCM' THEN 'ServiÃ§o de ComunicaÃ§Ã£o MultimÃ­dia'
    ELSE codigo_servico
  END AS nome_servico,
  CASE 
    WHEN codigo_servico = 'SMP' THEN 'Telefonia Celular'
    WHEN codigo_servico = 'STFC' THEN 'Telefonia Fixa'
    WHEN codigo_servico = 'SCM' THEN 'Banda Larga Fixa'
    ELSE 'Outros'
  END AS descricao
FROM s
  );
  
[0m02:17:07.520775 [debug] [Thread-3 (]: SQL status: SELECT 76 in 0.0 seconds
[0m02:17:07.521804 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.0 seconds
[0m02:17:07.530071 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:17:07.534186 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:17:07.535732 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */
alter table "ida_datamart"."ida"."dim_tempo" rename to "dim_tempo__dbt_backup"
[0m02:17:07.536543 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */
alter table "ida_datamart"."ida"."dim_servico" rename to "dim_servico__dbt_backup"
[0m02:17:07.538750 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:07.542675 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:17:07.543431 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:07.543966 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */
alter table "ida_datamart"."ida"."dim_tempo__dbt_tmp" rename to "dim_tempo"
[0m02:17:07.544487 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m02:17:07.549744 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:17:07.554291 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:07.554872 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:07.555589 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */
alter table "ida_datamart"."ida"."dim_servico__dbt_tmp" rename to "dim_servico"
[0m02:17:07.556209 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */
alter table "ida_datamart"."ida"."dim_grupo_economico" rename to "dim_grupo_economico__dbt_backup"
[0m02:17:07.581038 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: COMMIT
[0m02:17:07.581888 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:07.582941 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:17:07.583434 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:07.586099 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: COMMIT
[0m02:17:07.586828 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: COMMIT
[0m02:17:07.590683 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:07.591320 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:17:07.592126 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */
alter table "ida_datamart"."ida"."dim_grupo_economico__dbt_tmp" rename to "dim_grupo_economico"
[0m02:17:07.592663 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: COMMIT
[0m02:17:07.593860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:07.595896 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: COMMIT
[0m02:17:07.596636 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m02:17:07.597372 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:07.597896 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m02:17:07.606591 [debug] [Thread-3 (]: Applying DROP to: "ida_datamart"."ida"."dim_tempo__dbt_backup"
[0m02:17:07.607345 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: COMMIT
[0m02:17:07.610435 [debug] [Thread-2 (]: Applying DROP to: "ida_datamart"."ida"."dim_servico__dbt_backup"
[0m02:17:07.618121 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:17:07.619985 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:17:07.620828 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:17:07.621592 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */
drop table if exists "ida_datamart"."ida"."dim_tempo__dbt_backup" cascade
[0m02:17:07.622184 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */
drop table if exists "ida_datamart"."ida"."dim_servico__dbt_backup" cascade
[0m02:17:07.625377 [debug] [Thread-1 (]: Applying DROP to: "ida_datamart"."ida"."dim_grupo_economico__dbt_backup"
[0m02:17:07.628317 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:07.628881 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */
drop table if exists "ida_datamart"."ida"."dim_grupo_economico__dbt_backup" cascade
[0m02:17:07.639786 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:17:07.640710 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:17:07.643066 [debug] [Thread-2 (]: Timing info for model.beanalytic_ida.dim_servico (execute): 02:17:07.335361 => 02:17:07.642834
[0m02:17:07.645294 [debug] [Thread-3 (]: Timing info for model.beanalytic_ida.dim_tempo (execute): 02:17:07.383624 => 02:17:07.645028
[0m02:17:07.645844 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:17:07.646520 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: Close
[0m02:17:07.647104 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: Close
[0m02:17:07.649583 [debug] [Thread-1 (]: Timing info for model.beanalytic_ida.dim_grupo_economico (execute): 02:17:07.282544 => 02:17:07.649174
[0m02:17:07.652003 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '519f7f8f-1f3c-4872-8686-4b3e186da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b21119270>]}
[0m02:17:07.653993 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '519f7f8f-1f3c-4872-8686-4b3e186da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b21118a30>]}
[0m02:17:07.654924 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: Close
[0m02:17:07.656814 [info ] [Thread-2 (]: 2 of 5 OK created sql table model ida.dim_servico .............................. [[32mSELECT 3[0m in 0.38s]
[0m02:17:07.659329 [info ] [Thread-3 (]: 3 of 5 OK created sql table model ida.dim_tempo ................................ [[32mSELECT 76[0m in 0.40s]
[0m02:17:07.662120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '519f7f8f-1f3c-4872-8686-4b3e186da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b22c21fc0>]}
[0m02:17:07.663531 [debug] [Thread-2 (]: Finished running node model.beanalytic_ida.dim_servico
[0m02:17:07.665556 [debug] [Thread-3 (]: Finished running node model.beanalytic_ida.dim_tempo
[0m02:17:07.667635 [info ] [Thread-1 (]: 1 of 5 OK created sql table model ida.dim_grupo_economico ...................... [[32mSELECT 16[0m in 0.41s]
[0m02:17:07.670911 [debug] [Thread-1 (]: Finished running node model.beanalytic_ida.dim_grupo_economico
[0m02:17:07.673532 [debug] [Thread-4 (]: Began running node model.beanalytic_ida.fato_ida
[0m02:17:07.674248 [info ] [Thread-4 (]: 4 of 5 START sql table model ida.fato_ida ...................................... [RUN]
[0m02:17:07.675386 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.beanalytic_ida.fato_ida'
[0m02:17:07.675859 [debug] [Thread-4 (]: Began compiling node model.beanalytic_ida.fato_ida
[0m02:17:07.687920 [debug] [Thread-4 (]: Writing injected SQL for node "model.beanalytic_ida.fato_ida"
[0m02:17:07.690331 [debug] [Thread-4 (]: Timing info for model.beanalytic_ida.fato_ida (compile): 02:17:07.676102 => 02:17:07.689971
[0m02:17:07.690909 [debug] [Thread-4 (]: Began executing node model.beanalytic_ida.fato_ida
[0m02:17:07.773191 [debug] [Thread-4 (]: Writing runtime sql for node "model.beanalytic_ida.fato_ida"
[0m02:17:07.774161 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:17:07.774642 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: BEGIN
[0m02:17:07.775049 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:17:07.784362 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:07.785156 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:17:07.785707 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.fato_ida"} */

  
    

  create  table "ida_datamart"."ida"."fato_ida__dbt_tmp"
  
  
    as
  
  (
    

WITH refined AS (
  SELECT 
    ano_mes,
    UPPER(servico) AS svc,
    CASE 
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'OI%' THEN 'OI'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CLARO%' THEN 'CLARO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'VIVO%' OR TRIM(UPPER(grupo_economico)) LIKE 'TELEFÃ”NICA%' THEN 'VIVO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'TIM%' THEN 'TIM'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CTBC%' OR TRIM(UPPER(grupo_economico)) LIKE 'ALGAR%' THEN 'ALGAR'
      ELSE TRIM(UPPER(grupo_economico))
    END AS grp,
    MAX(CASE WHEN variavel ILIKE 'Indicador de Desempenho%' OR variavel ILIKE 'Ãndice de Desempenho%' THEN valor END) AS val_ida,
    MAX(CASE WHEN variavel ILIKE 'Taxa de Resolvidas em 5 dias%' THEN valor END) AS tx_5d,
    MAX(CASE WHEN variavel ILIKE 'Taxa de Resolvidas no PerÃ­odo' THEN valor END) AS tx_tot,
    MAX(CASE WHEN variavel IN ('Total de SolicitaÃ§Ãµes', 'Quantidade de SolicitaÃ§Ãµes', 'Quantidade de reclamaÃ§Ãµes', 'Quantidade de ReclamaÃ§Ãµes', 'Quantidade de ReclamaÃ§Ãµes no PerÃ­odo', 'Total de ReclamaÃ§Ãµes') THEN valor END) AS sol_tot,
    MAX(CASE WHEN variavel IN ('Quantidade de resolvidas', 'Quantidade de Sol. Resolvidas no PerÃ­odo', 'Quantidade de Respondidas') THEN valor END) AS sol_res
  FROM "ida_datamart"."ida"."staging_ida"
  GROUP BY 1, 2, 3
),
calc AS (
  SELECT 
    *,
    COALESCE(sol_res, ROUND((sol_tot * tx_tot / 100)))::integer AS res_final
  FROM refined
)
SELECT 
  dt.id_tempo, dg.nome_grupo, ds.codigo_servico,
  COALESCE(c.val_ida, c.tx_5d, 0) AS taxa_solicitacoes_resolvidas_5dias,
  COALESCE(c.tx_tot, 0) AS taxa_solicitacoes_resolvidas,
  COALESCE(c.sol_tot, 0) AS total_solicitacoes,
  COALESCE(c.res_final, 0) AS solicitacoes_resolvidas
FROM calc c
JOIN "ida_datamart"."ida"."dim_tempo" dt ON c.ano_mes = dt.ano_mes
JOIN "ida_datamart"."ida"."dim_grupo_economico" dg ON c.grp = dg.nome_grupo
JOIN "ida_datamart"."ida"."dim_servico" ds ON c.svc = ds.codigo_servico
  );
  
[0m02:17:07.789323 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column dt.id_tempo does not exist
LINE 41:   dt.id_tempo, dg.nome_grupo, ds.codigo_servico,
           ^

[0m02:17:07.790247 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: ROLLBACK
[0m02:17:07.791204 [debug] [Thread-4 (]: Timing info for model.beanalytic_ida.fato_ida (execute): 02:17:07.691259 => 02:17:07.790943
[0m02:17:07.791653 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: Close
[0m02:17:07.794561 [debug] [Thread-4 (]: Database Error in model fato_ida (models/facts/fato_ida.sql)
  column dt.id_tempo does not exist
  LINE 41:   dt.id_tempo, dg.nome_grupo, ds.codigo_servico,
             ^
  compiled Code at target/run/beanalytic_ida/models/facts/fato_ida.sql
[0m02:17:07.795219 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '519f7f8f-1f3c-4872-8686-4b3e186da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b21141060>]}
[0m02:17:07.795931 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model ida.fato_ida ............................. [[31mERROR[0m in 0.12s]
[0m02:17:07.796722 [debug] [Thread-4 (]: Finished running node model.beanalytic_ida.fato_ida
[0m02:17:07.799048 [debug] [Thread-3 (]: Began running node model.beanalytic_ida.long_delta
[0m02:17:07.800642 [info ] [Thread-3 (]: 5 of 5 SKIP relation ida.long_delta ............................................ [[33mSKIP[0m]
[0m02:17:07.801337 [debug] [Thread-3 (]: Finished running node model.beanalytic_ida.long_delta
[0m02:17:07.805474 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:07.805973 [debug] [MainThread]: On master: BEGIN
[0m02:17:07.806369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:17:07.817263 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:17:07.817816 [debug] [MainThread]: On master: COMMIT
[0m02:17:07.818193 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:07.818543 [debug] [MainThread]: On master: COMMIT
[0m02:17:07.819883 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:17:07.820380 [debug] [MainThread]: On master: Close
[0m02:17:07.821218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:17:07.821638 [debug] [MainThread]: Connection 'model.beanalytic_ida.dim_grupo_economico' was properly closed.
[0m02:17:07.821959 [debug] [MainThread]: Connection 'model.beanalytic_ida.dim_tempo' was properly closed.
[0m02:17:07.822268 [debug] [MainThread]: Connection 'model.beanalytic_ida.dim_servico' was properly closed.
[0m02:17:07.822586 [debug] [MainThread]: Connection 'model.beanalytic_ida.fato_ida' was properly closed.
[0m02:17:07.822978 [info ] [MainThread]: 
[0m02:17:07.823366 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m02:17:07.824818 [debug] [MainThread]: Command end result
[0m02:17:07.838848 [info ] [MainThread]: 
[0m02:17:07.839498 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:17:07.839849 [info ] [MainThread]: 
[0m02:17:07.840204 [error] [MainThread]:   Database Error in model fato_ida (models/facts/fato_ida.sql)
  column dt.id_tempo does not exist
  LINE 41:   dt.id_tempo, dg.nome_grupo, ds.codigo_servico,
             ^
  compiled Code at target/run/beanalytic_ida/models/facts/fato_ida.sql
[0m02:17:07.840547 [info ] [MainThread]: 
[0m02:17:07.840863 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m02:17:07.841893 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.3243465, "process_user_time": 4.208594, "process_kernel_time": 0.28431, "process_mem_max_rss": "113240", "process_out_blocks": "3408", "command_success": false, "process_in_blocks": "0"}
[0m02:17:07.844266 [debug] [MainThread]: Command `dbt run` failed at 02:17:07.843318 after 2.33 seconds
[0m02:17:07.845264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b264c3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b21143460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b211430a0>]}
[0m02:17:07.846931 [debug] [MainThread]: Flushing usage events
[0m02:17:44.993111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b135c0b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b133db8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b133dbbfd0>]}


============================== 02:17:44.998546 | f968b837-10f2-4379-9509-aa71ce8cfc3c ==============================
[0m02:17:44.998546 [info ] [MainThread]: Running with dbt=1.7.3
[0m02:17:44.999388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_tempo dim_grupo_economico dim_servico fato_ida long_delta', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:17:45.172634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f968b837-10f2-4379-9509-aa71ce8cfc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b137cd85e0>]}
[0m02:17:45.267775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f968b837-10f2-4379-9509-aa71ce8cfc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b133df5420>]}
[0m02:17:45.269590 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m02:17:45.277459 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m02:17:45.313333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:17:45.314109 [debug] [MainThread]: Partial parsing: updated file: beanalytic_ida://models/mart/dim_tempo.sql
[0m02:17:45.696000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f968b837-10f2-4379-9509-aa71ce8cfc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b13084feb0>]}
[0m02:17:45.706885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f968b837-10f2-4379-9509-aa71ce8cfc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b132397c10>]}
[0m02:17:45.707551 [info ] [MainThread]: Found 5 models, 17 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m02:17:45.708017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f968b837-10f2-4379-9509-aa71ce8cfc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b132397e50>]}
[0m02:17:45.709871 [info ] [MainThread]: 
[0m02:17:45.710707 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:17:45.712185 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ida_datamart'
[0m02:17:45.724358 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart"
[0m02:17:45.724853 [debug] [ThreadPool]: On list_ida_datamart: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart"} */

    select distinct nspname from pg_namespace
  
[0m02:17:45.725179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:17:45.738113 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:17:45.739488 [debug] [ThreadPool]: On list_ida_datamart: Close
[0m02:17:45.742659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ida_datamart, now list_ida_datamart_ida)
[0m02:17:45.749254 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida"
[0m02:17:45.749899 [debug] [ThreadPool]: On list_ida_datamart_ida: BEGIN
[0m02:17:45.750774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:17:45.760761 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:17:45.761277 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida"
[0m02:17:45.761636 [debug] [ThreadPool]: On list_ida_datamart_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart_ida"} */
select
      'ida_datamart' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ida'
    union all
    select
      'ida_datamart' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ida'
    union all
    select
      'ida_datamart' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ida'
  
[0m02:17:45.765369 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m02:17:45.766928 [debug] [ThreadPool]: On list_ida_datamart_ida: ROLLBACK
[0m02:17:45.768758 [debug] [ThreadPool]: On list_ida_datamart_ida: Close
[0m02:17:45.775707 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:45.776350 [debug] [MainThread]: On master: BEGIN
[0m02:17:45.776901 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:17:45.785425 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:17:45.786671 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:45.787159 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:17:45.790753 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:17:45.791947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f968b837-10f2-4379-9509-aa71ce8cfc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b1306c3460>]}
[0m02:17:45.792450 [debug] [MainThread]: On master: ROLLBACK
[0m02:17:45.793061 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:45.793370 [debug] [MainThread]: On master: BEGIN
[0m02:17:45.794140 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:17:45.794516 [debug] [MainThread]: On master: COMMIT
[0m02:17:45.794797 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:45.795052 [debug] [MainThread]: On master: COMMIT
[0m02:17:45.795649 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:17:45.795975 [debug] [MainThread]: On master: Close
[0m02:17:45.796671 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:17:45.797028 [info ] [MainThread]: 
[0m02:17:45.811307 [debug] [Thread-1 (]: Began running node model.beanalytic_ida.dim_grupo_economico
[0m02:17:45.812431 [debug] [Thread-2 (]: Began running node model.beanalytic_ida.dim_servico
[0m02:17:45.813519 [debug] [Thread-3 (]: Began running node model.beanalytic_ida.dim_tempo
[0m02:17:45.814366 [info ] [Thread-1 (]: 1 of 5 START sql table model ida.dim_grupo_economico ........................... [RUN]
[0m02:17:45.815322 [info ] [Thread-2 (]: 2 of 5 START sql table model ida.dim_servico ................................... [RUN]
[0m02:17:45.816526 [info ] [Thread-3 (]: 3 of 5 START sql table model ida.dim_tempo ..................................... [RUN]
[0m02:17:45.817937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ida_datamart_ida, now model.beanalytic_ida.dim_grupo_economico)
[0m02:17:45.819197 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.beanalytic_ida.dim_servico'
[0m02:17:45.820375 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.beanalytic_ida.dim_tempo'
[0m02:17:45.821625 [debug] [Thread-1 (]: Began compiling node model.beanalytic_ida.dim_grupo_economico
[0m02:17:45.822549 [debug] [Thread-2 (]: Began compiling node model.beanalytic_ida.dim_servico
[0m02:17:45.823772 [debug] [Thread-3 (]: Began compiling node model.beanalytic_ida.dim_tempo
[0m02:17:45.834805 [debug] [Thread-1 (]: Writing injected SQL for node "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:45.838690 [debug] [Thread-2 (]: Writing injected SQL for node "model.beanalytic_ida.dim_servico"
[0m02:17:45.842204 [debug] [Thread-3 (]: Writing injected SQL for node "model.beanalytic_ida.dim_tempo"
[0m02:17:45.845114 [debug] [Thread-1 (]: Timing info for model.beanalytic_ida.dim_grupo_economico (compile): 02:17:45.824524 => 02:17:45.844358
[0m02:17:45.846087 [debug] [Thread-2 (]: Timing info for model.beanalytic_ida.dim_servico (compile): 02:17:45.835633 => 02:17:45.845570
[0m02:17:45.846875 [debug] [Thread-3 (]: Timing info for model.beanalytic_ida.dim_tempo (compile): 02:17:45.839295 => 02:17:45.846606
[0m02:17:45.847413 [debug] [Thread-1 (]: Began executing node model.beanalytic_ida.dim_grupo_economico
[0m02:17:45.848180 [debug] [Thread-2 (]: Began executing node model.beanalytic_ida.dim_servico
[0m02:17:45.848787 [debug] [Thread-3 (]: Began executing node model.beanalytic_ida.dim_tempo
[0m02:17:45.926351 [debug] [Thread-2 (]: Writing runtime sql for node "model.beanalytic_ida.dim_servico"
[0m02:17:45.927218 [debug] [Thread-3 (]: Writing runtime sql for node "model.beanalytic_ida.dim_tempo"
[0m02:17:45.928794 [debug] [Thread-1 (]: Writing runtime sql for node "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:45.930826 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:17:45.931284 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: BEGIN
[0m02:17:45.932261 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:17:45.933468 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:17:45.934356 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:45.934927 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: BEGIN
[0m02:17:45.935493 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: BEGIN
[0m02:17:45.935983 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:17:45.936450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:45.941862 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:45.942405 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:17:45.942861 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */

  
    

  create  table "ida_datamart"."ida"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
  SELECT DISTINCT
    ano,
    mes,
    ano_mes
  FROM "ida_datamart"."ida"."staging_ida"
)
SELECT
  ROW_NUMBER() OVER (ORDER BY ano, mes) AS id_tempo,
  ano,
  mes,
  ano_mes,
  CASE WHEN mes BETWEEN 1 AND 3 THEN 1
       WHEN mes BETWEEN 4 AND 6 THEN 2
       WHEN mes BETWEEN 7 AND 9 THEN 3
       ELSE 4 END AS trimestre,
  CASE WHEN mes BETWEEN 1 AND 6 THEN 1 ELSE 2 END AS semestre
FROM base
  );
  
[0m02:17:45.945608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:45.946707 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:45.947585 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:45.948210 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */

  
    

  create  table "ida_datamart"."ida"."dim_grupo_economico__dbt_tmp"
  
  
    as
  
  (
    

WITH grupo_norm AS (
  SELECT DISTINCT
    TRIM(UPPER(grupo_economico)) AS nome_raw,
    CASE 
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'OI%' THEN 'OI'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CLARO%' THEN 'CLARO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'VIVO%' OR TRIM(UPPER(grupo_economico)) LIKE 'TELEFÃ”NICA%' THEN 'VIVO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'TIM%' THEN 'TIM'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CTBC%' OR TRIM(UPPER(grupo_economico)) LIKE 'ALGAR%' THEN 'ALGAR'
      ELSE TRIM(UPPER(grupo_economico))
    END AS nome_final
  FROM "ida_datamart"."ida"."staging_ida"
)
SELECT DISTINCT nome_final AS nome_grupo
FROM grupo_norm
  );
  
[0m02:17:45.949132 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:17:45.950309 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */

  
    

  create  table "ida_datamart"."ida"."dim_servico__dbt_tmp"
  
  
    as
  
  (
    

WITH s AS (
  SELECT DISTINCT UPPER(servico) AS codigo_servico
  FROM "ida_datamart"."ida"."staging_ida"
)
SELECT 
  codigo_servico,
  CASE 
    WHEN codigo_servico = 'SMP' THEN 'ServiÃ§o MÃ³vel Pessoal'
    WHEN codigo_servico = 'STFC' THEN 'ServiÃ§o TelefÃ´nico Fixo Comutado'
    WHEN codigo_servico = 'SCM' THEN 'ServiÃ§o de ComunicaÃ§Ã£o MultimÃ­dia'
    ELSE codigo_servico
  END AS nome_servico,
  CASE 
    WHEN codigo_servico = 'SMP' THEN 'Telefonia Celular'
    WHEN codigo_servico = 'STFC' THEN 'Telefonia Fixa'
    WHEN codigo_servico = 'SCM' THEN 'Banda Larga Fixa'
    ELSE 'Outros'
  END AS descricao
FROM s
  );
  
[0m02:17:45.953747 [debug] [Thread-3 (]: SQL status: SELECT 76 in 0.0 seconds
[0m02:17:45.962324 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:17:45.963361 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */
alter table "ida_datamart"."ida"."dim_tempo" rename to "dim_tempo__dbt_backup"
[0m02:17:45.965224 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.0 seconds
[0m02:17:45.966827 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:45.971606 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:17:45.976426 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:17:45.977324 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */
alter table "ida_datamart"."ida"."dim_servico" rename to "dim_servico__dbt_backup"
[0m02:17:45.977849 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */
alter table "ida_datamart"."ida"."dim_tempo__dbt_tmp" rename to "dim_tempo"
[0m02:17:45.979186 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:45.979893 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:45.982985 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:17:45.995067 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m02:17:46.015785 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */
alter table "ida_datamart"."ida"."dim_servico__dbt_tmp" rename to "dim_servico"
[0m02:17:46.017272 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: COMMIT
[0m02:17:46.021099 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:46.021869 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:17:46.022490 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:46.023066 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */
alter table "ida_datamart"."ida"."dim_grupo_economico" rename to "dim_grupo_economico__dbt_backup"
[0m02:17:46.023571 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: COMMIT
[0m02:17:46.025601 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: COMMIT
[0m02:17:46.026974 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:17:46.027657 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:46.028154 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: COMMIT
[0m02:17:46.031554 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:46.032451 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m02:17:46.034391 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */
alter table "ida_datamart"."ida"."dim_grupo_economico__dbt_tmp" rename to "dim_grupo_economico"
[0m02:17:46.040827 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m02:17:46.043213 [debug] [Thread-3 (]: Applying DROP to: "ida_datamart"."ida"."dim_tempo__dbt_backup"
[0m02:17:46.046355 [debug] [Thread-2 (]: Applying DROP to: "ida_datamart"."ida"."dim_servico__dbt_backup"
[0m02:17:46.047333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:46.052754 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.dim_tempo"
[0m02:17:46.054018 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.dim_servico"
[0m02:17:46.057308 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: COMMIT
[0m02:17:46.058116 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_tempo"} */
drop table if exists "ida_datamart"."ida"."dim_tempo__dbt_backup" cascade
[0m02:17:46.059048 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_servico"} */
drop table if exists "ida_datamart"."ida"."dim_servico__dbt_backup" cascade
[0m02:17:46.059684 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:46.061064 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: COMMIT
[0m02:17:46.064433 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:17:46.071029 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:17:46.072018 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:17:46.072928 [debug] [Thread-1 (]: Applying DROP to: "ida_datamart"."ida"."dim_grupo_economico__dbt_backup"
[0m02:17:46.074717 [debug] [Thread-2 (]: Timing info for model.beanalytic_ida.dim_servico (execute): 02:17:45.870569 => 02:17:46.074497
[0m02:17:46.076301 [debug] [Thread-3 (]: Timing info for model.beanalytic_ida.dim_tempo (execute): 02:17:45.886412 => 02:17:46.076111
[0m02:17:46.077213 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:17:46.077736 [debug] [Thread-2 (]: On model.beanalytic_ida.dim_servico: Close
[0m02:17:46.078391 [debug] [Thread-3 (]: On model.beanalytic_ida.dim_tempo: Close
[0m02:17:46.078901 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */
drop table if exists "ida_datamart"."ida"."dim_grupo_economico__dbt_backup" cascade
[0m02:17:46.080436 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f968b837-10f2-4379-9509-aa71ce8cfc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b1305f7730>]}
[0m02:17:46.081543 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f968b837-10f2-4379-9509-aa71ce8cfc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b1305dc220>]}
[0m02:17:46.086033 [info ] [Thread-2 (]: 2 of 5 OK created sql table model ida.dim_servico .............................. [[32mSELECT 3[0m in 0.26s]
[0m02:17:46.087960 [debug] [Thread-2 (]: Finished running node model.beanalytic_ida.dim_servico
[0m02:17:46.088938 [info ] [Thread-3 (]: 3 of 5 OK created sql table model ida.dim_tempo ................................ [[32mSELECT 76[0m in 0.26s]
[0m02:17:46.090814 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:17:46.093553 [debug] [Thread-3 (]: Finished running node model.beanalytic_ida.dim_tempo
[0m02:17:46.096162 [debug] [Thread-1 (]: Timing info for model.beanalytic_ida.dim_grupo_economico (execute): 02:17:45.849240 => 02:17:46.095946
[0m02:17:46.098715 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: Close
[0m02:17:46.101114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f968b837-10f2-4379-9509-aa71ce8cfc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b1305fed40>]}
[0m02:17:46.104866 [info ] [Thread-1 (]: 1 of 5 OK created sql table model ida.dim_grupo_economico ...................... [[32mSELECT 16[0m in 0.28s]
[0m02:17:46.105752 [debug] [Thread-1 (]: Finished running node model.beanalytic_ida.dim_grupo_economico
[0m02:17:46.107605 [debug] [Thread-4 (]: Began running node model.beanalytic_ida.fato_ida
[0m02:17:46.108246 [info ] [Thread-4 (]: 4 of 5 START sql table model ida.fato_ida ...................................... [RUN]
[0m02:17:46.109245 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.beanalytic_ida.fato_ida'
[0m02:17:46.109682 [debug] [Thread-4 (]: Began compiling node model.beanalytic_ida.fato_ida
[0m02:17:46.115089 [debug] [Thread-4 (]: Writing injected SQL for node "model.beanalytic_ida.fato_ida"
[0m02:17:46.117340 [debug] [Thread-4 (]: Timing info for model.beanalytic_ida.fato_ida (compile): 02:17:46.109939 => 02:17:46.117008
[0m02:17:46.117795 [debug] [Thread-4 (]: Began executing node model.beanalytic_ida.fato_ida
[0m02:17:46.122793 [debug] [Thread-4 (]: Writing runtime sql for node "model.beanalytic_ida.fato_ida"
[0m02:17:46.123612 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:17:46.124048 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: BEGIN
[0m02:17:46.124386 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:17:46.134608 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:46.135178 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:17:46.135802 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.fato_ida"} */

  
    

  create  table "ida_datamart"."ida"."fato_ida__dbt_tmp"
  
  
    as
  
  (
    

WITH refined AS (
  SELECT 
    ano_mes,
    UPPER(servico) AS svc,
    CASE 
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'OI%' THEN 'OI'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CLARO%' THEN 'CLARO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'VIVO%' OR TRIM(UPPER(grupo_economico)) LIKE 'TELEFÃ”NICA%' THEN 'VIVO'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'TIM%' THEN 'TIM'
      WHEN TRIM(UPPER(grupo_economico)) LIKE 'CTBC%' OR TRIM(UPPER(grupo_economico)) LIKE 'ALGAR%' THEN 'ALGAR'
      ELSE TRIM(UPPER(grupo_economico))
    END AS grp,
    MAX(CASE WHEN variavel ILIKE 'Indicador de Desempenho%' OR variavel ILIKE 'Ãndice de Desempenho%' THEN valor END) AS val_ida,
    MAX(CASE WHEN variavel ILIKE 'Taxa de Resolvidas em 5 dias%' THEN valor END) AS tx_5d,
    MAX(CASE WHEN variavel ILIKE 'Taxa de Resolvidas no PerÃ­odo' THEN valor END) AS tx_tot,
    MAX(CASE WHEN variavel IN ('Total de SolicitaÃ§Ãµes', 'Quantidade de SolicitaÃ§Ãµes', 'Quantidade de reclamaÃ§Ãµes', 'Quantidade de ReclamaÃ§Ãµes', 'Quantidade de ReclamaÃ§Ãµes no PerÃ­odo', 'Total de ReclamaÃ§Ãµes') THEN valor END) AS sol_tot,
    MAX(CASE WHEN variavel IN ('Quantidade de resolvidas', 'Quantidade de Sol. Resolvidas no PerÃ­odo', 'Quantidade de Respondidas') THEN valor END) AS sol_res
  FROM "ida_datamart"."ida"."staging_ida"
  GROUP BY 1, 2, 3
),
calc AS (
  SELECT 
    *,
    COALESCE(sol_res, ROUND((sol_tot * tx_tot / 100)))::integer AS res_final
  FROM refined
)
SELECT 
  dt.id_tempo, dg.nome_grupo, ds.codigo_servico,
  COALESCE(c.val_ida, c.tx_5d, 0) AS taxa_solicitacoes_resolvidas_5dias,
  COALESCE(c.tx_tot, 0) AS taxa_solicitacoes_resolvidas,
  COALESCE(c.sol_tot, 0) AS total_solicitacoes,
  COALESCE(c.res_final, 0) AS solicitacoes_resolvidas
FROM calc c
JOIN "ida_datamart"."ida"."dim_tempo" dt ON c.ano_mes = dt.ano_mes
JOIN "ida_datamart"."ida"."dim_grupo_economico" dg ON c.grp = dg.nome_grupo
JOIN "ida_datamart"."ida"."dim_servico" ds ON c.svc = ds.codigo_servico
  );
  
[0m02:17:46.217997 [debug] [Thread-4 (]: SQL status: SELECT 1298 in 0.0 seconds
[0m02:17:46.221694 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:17:46.222142 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.fato_ida"} */
alter table "ida_datamart"."ida"."fato_ida" rename to "fato_ida__dbt_backup"
[0m02:17:46.223319 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:46.226667 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:17:46.227116 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.fato_ida"} */
alter table "ida_datamart"."ida"."fato_ida__dbt_tmp" rename to "fato_ida"
[0m02:17:46.228054 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:46.230353 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: COMMIT
[0m02:17:46.230822 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:17:46.231156 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: COMMIT
[0m02:17:46.235979 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m02:17:46.239164 [debug] [Thread-4 (]: Applying DROP to: "ida_datamart"."ida"."fato_ida__dbt_backup"
[0m02:17:46.240024 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:17:46.240470 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.fato_ida"} */
drop table if exists "ida_datamart"."ida"."fato_ida__dbt_backup" cascade
[0m02:17:46.244151 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:17:46.245864 [debug] [Thread-4 (]: Timing info for model.beanalytic_ida.fato_ida (execute): 02:17:46.118048 => 02:17:46.245645
[0m02:17:46.246256 [debug] [Thread-4 (]: On model.beanalytic_ida.fato_ida: Close
[0m02:17:46.247105 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f968b837-10f2-4379-9509-aa71ce8cfc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b130626fe0>]}
[0m02:17:46.247742 [info ] [Thread-4 (]: 4 of 5 OK created sql table model ida.fato_ida ................................. [[32mSELECT 1298[0m in 0.14s]
[0m02:17:46.248333 [debug] [Thread-4 (]: Finished running node model.beanalytic_ida.fato_ida
[0m02:17:46.249679 [debug] [Thread-3 (]: Began running node model.beanalytic_ida.long_delta
[0m02:17:46.250304 [info ] [Thread-3 (]: 5 of 5 START sql table model ida.long_delta .................................... [RUN]
[0m02:17:46.251365 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.beanalytic_ida.dim_tempo, now model.beanalytic_ida.long_delta)
[0m02:17:46.251776 [debug] [Thread-3 (]: Began compiling node model.beanalytic_ida.long_delta
[0m02:17:46.255316 [debug] [Thread-3 (]: Writing injected SQL for node "model.beanalytic_ida.long_delta"
[0m02:17:46.256240 [debug] [Thread-3 (]: Timing info for model.beanalytic_ida.long_delta (compile): 02:17:46.252004 => 02:17:46.255993
[0m02:17:46.256669 [debug] [Thread-3 (]: Began executing node model.beanalytic_ida.long_delta
[0m02:17:46.261364 [debug] [Thread-3 (]: Writing runtime sql for node "model.beanalytic_ida.long_delta"
[0m02:17:46.262572 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:17:46.263158 [debug] [Thread-3 (]: On model.beanalytic_ida.long_delta: BEGIN
[0m02:17:46.263506 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:17:46.272640 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:46.273195 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:17:46.273631 [debug] [Thread-3 (]: On model.beanalytic_ida.long_delta: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.long_delta"} */

  
    

  create  table "ida_datamart"."ida"."long_delta__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
  SELECT
    t.ano_mes,
    f.id_tempo,
    f.nome_grupo,
    f.codigo_servico,
    f.taxa_solicitacoes_resolvidas_5dias AS ida
  FROM "ida_datamart"."ida"."fato_ida" f
  JOIN "ida_datamart"."ida"."dim_tempo" t ON f.id_tempo = t.id_tempo
),
mercado AS (
  SELECT
    ano_mes,
    AVG(ida) AS valor_mercado
  FROM base
  GROUP BY ano_mes
),
variacoes AS (
  SELECT
    b.ano_mes,
    b.nome_grupo,
    -- VariaÃ§Ã£o do mercado (%): (atual - anterior) / anterior * 100
    CASE
      WHEN LAG(m.valor_mercado) OVER (ORDER BY b.ano_mes) > 0
      THEN ((m.valor_mercado - LAG(m.valor_mercado) OVER (ORDER BY b.ano_mes))
            / LAG(m.valor_mercado) OVER (ORDER BY b.ano_mes)) * 100
    END AS var_mercado,
    -- VariaÃ§Ã£o individual da operadora (%)
    CASE
      WHEN LAG(b.ida) OVER (PARTITION BY b.nome_grupo ORDER BY b.ano_mes) > 0
      THEN ((b.ida - LAG(b.ida) OVER (PARTITION BY b.nome_grupo ORDER BY b.ano_mes))
            / LAG(b.ida) OVER (PARTITION BY b.nome_grupo ORDER BY b.ano_mes)) * 100
    END AS var_individual
  FROM base b
  JOIN mercado m USING (ano_mes)
)
SELECT
  ano_mes,
  nome_grupo,
  ROUND(var_mercado::numeric, 2) AS var_mercado,
  ROUND(var_individual::numeric, 2) AS var_individual,
  ROUND((var_mercado - var_individual)::numeric, 2) AS diferenca
FROM variacoes
WHERE var_mercado IS NOT NULL
  );
  
[0m02:17:46.293667 [debug] [Thread-3 (]: SQL status: SELECT 1297 in 0.0 seconds
[0m02:17:46.298798 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:17:46.300018 [debug] [Thread-3 (]: On model.beanalytic_ida.long_delta: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.long_delta"} */
alter table "ida_datamart"."ida"."long_delta__dbt_tmp" rename to "long_delta"
[0m02:17:46.301309 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:17:46.304414 [debug] [Thread-3 (]: On model.beanalytic_ida.long_delta: COMMIT
[0m02:17:46.304961 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:17:46.305332 [debug] [Thread-3 (]: On model.beanalytic_ida.long_delta: COMMIT
[0m02:17:46.310185 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m02:17:46.312946 [debug] [Thread-3 (]: Applying DROP to: "ida_datamart"."ida"."long_delta__dbt_backup"
[0m02:17:46.313759 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:17:46.314162 [debug] [Thread-3 (]: On model.beanalytic_ida.long_delta: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.long_delta"} */
drop table if exists "ida_datamart"."ida"."long_delta__dbt_backup" cascade
[0m02:17:46.315152 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:17:46.317006 [debug] [Thread-3 (]: Timing info for model.beanalytic_ida.long_delta (execute): 02:17:46.256892 => 02:17:46.316806
[0m02:17:46.317403 [debug] [Thread-3 (]: On model.beanalytic_ida.long_delta: Close
[0m02:17:46.318200 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f968b837-10f2-4379-9509-aa71ce8cfc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b130644af0>]}
[0m02:17:46.318917 [info ] [Thread-3 (]: 5 of 5 OK created sql table model ida.long_delta ............................... [[32mSELECT 1297[0m in 0.07s]
[0m02:17:46.319818 [debug] [Thread-3 (]: Finished running node model.beanalytic_ida.long_delta
[0m02:17:46.323567 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:46.323971 [debug] [MainThread]: On master: BEGIN
[0m02:17:46.324257 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:17:46.333769 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:17:46.334308 [debug] [MainThread]: On master: COMMIT
[0m02:17:46.334793 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:46.335104 [debug] [MainThread]: On master: COMMIT
[0m02:17:46.336086 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:17:46.336435 [debug] [MainThread]: On master: Close
[0m02:17:46.337207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:17:46.337549 [debug] [MainThread]: Connection 'model.beanalytic_ida.dim_grupo_economico' was properly closed.
[0m02:17:46.337844 [debug] [MainThread]: Connection 'model.beanalytic_ida.dim_servico' was properly closed.
[0m02:17:46.338087 [debug] [MainThread]: Connection 'model.beanalytic_ida.long_delta' was properly closed.
[0m02:17:46.338328 [debug] [MainThread]: Connection 'model.beanalytic_ida.fato_ida' was properly closed.
[0m02:17:46.338707 [info ] [MainThread]: 
[0m02:17:46.339068 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m02:17:46.340176 [debug] [MainThread]: Command end result
[0m02:17:46.353753 [info ] [MainThread]: 
[0m02:17:46.354576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:17:46.354989 [info ] [MainThread]: 
[0m02:17:46.355380 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m02:17:46.356359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4085618, "process_user_time": 3.057133, "process_kernel_time": 0.339238, "process_mem_max_rss": "112416", "process_out_blocks": "3456", "process_in_blocks": "0"}
[0m02:17:46.356937 [debug] [MainThread]: Command `dbt run` succeeded at 02:17:46.356813 after 1.41 seconds
[0m02:17:46.357296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b135c0b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b130647490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b133df5420>]}
[0m02:17:46.357693 [debug] [MainThread]: Flushing usage events
[0m02:17:51.435443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca69a93730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca67c60fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca67c63ee0>]}


============================== 02:17:51.441049 | bb42d722-42f9-4f19-bd32-117a33d12180 ==============================
[0m02:17:51.441049 [info ] [MainThread]: Running with dbt=1.7.3
[0m02:17:51.441525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:17:51.628149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb42d722-42f9-4f19-bd32-117a33d12180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6bda3c10>]}
[0m02:17:51.730990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb42d722-42f9-4f19-bd32-117a33d12180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca67c84ca0>]}
[0m02:17:51.731952 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m02:17:51.739392 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m02:17:51.768830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:17:51.769274 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:17:51.774816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb42d722-42f9-4f19-bd32-117a33d12180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6606a3e0>]}
[0m02:17:51.785537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb42d722-42f9-4f19-bd32-117a33d12180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca66234e20>]}
[0m02:17:51.786082 [info ] [MainThread]: Found 5 models, 17 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m02:17:51.786606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb42d722-42f9-4f19-bd32-117a33d12180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca66235060>]}
[0m02:17:51.788862 [info ] [MainThread]: 
[0m02:17:51.789809 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:17:51.791568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ida_datamart_ida'
[0m02:17:51.803131 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida"
[0m02:17:51.803605 [debug] [ThreadPool]: On list_ida_datamart_ida: BEGIN
[0m02:17:51.803925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:17:51.815537 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:17:51.816199 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida"
[0m02:17:51.816532 [debug] [ThreadPool]: On list_ida_datamart_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart_ida"} */
select
      'ida_datamart' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ida'
    union all
    select
      'ida_datamart' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ida'
    union all
    select
      'ida_datamart' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ida'
  
[0m02:17:51.819956 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:17:51.821379 [debug] [ThreadPool]: On list_ida_datamart_ida: ROLLBACK
[0m02:17:51.822243 [debug] [ThreadPool]: On list_ida_datamart_ida: Close
[0m02:17:51.828684 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:51.829326 [debug] [MainThread]: On master: BEGIN
[0m02:17:51.830039 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:17:51.839268 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:17:51.839734 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:51.840185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:17:51.843628 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:17:51.845075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb42d722-42f9-4f19-bd32-117a33d12180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca66234dc0>]}
[0m02:17:51.845639 [debug] [MainThread]: On master: ROLLBACK
[0m02:17:51.846578 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:51.847721 [debug] [MainThread]: On master: BEGIN
[0m02:17:51.851659 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:17:51.852455 [debug] [MainThread]: On master: COMMIT
[0m02:17:51.852770 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:51.853042 [debug] [MainThread]: On master: COMMIT
[0m02:17:51.853694 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:17:51.854086 [debug] [MainThread]: On master: Close
[0m02:17:51.854892 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:17:51.855285 [info ] [MainThread]: 
[0m02:17:51.875954 [debug] [Thread-1 (]: Began running node test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1
[0m02:17:51.876883 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f
[0m02:17:51.877673 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM .. [RUN]
[0m02:17:51.889580 [debug] [Thread-3 (]: Began running node test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292
[0m02:17:51.881480 [info ] [Thread-2 (]: 2 of 17 START test not_null_dim_grupo_economico_nome_grupo ..................... [RUN]
[0m02:17:51.892005 [debug] [Thread-4 (]: Began running node test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6
[0m02:17:51.893850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ida_datamart_ida, now test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1)
[0m02:17:51.895044 [info ] [Thread-3 (]: 3 of 17 START test not_null_dim_servico_codigo_servico ......................... [RUN]
[0m02:17:51.897719 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f'
[0m02:17:51.899112 [info ] [Thread-4 (]: 4 of 17 START test not_null_dim_tempo_ano ...................................... [RUN]
[0m02:17:51.900492 [debug] [Thread-1 (]: Began compiling node test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1
[0m02:17:51.902786 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292'
[0m02:17:51.903871 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f
[0m02:17:51.905120 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6'
[0m02:17:51.917083 [debug] [Thread-3 (]: Began compiling node test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292
[0m02:17:51.950039 [debug] [Thread-1 (]: Writing injected SQL for node "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"
[0m02:17:51.953948 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"
[0m02:17:51.954901 [debug] [Thread-4 (]: Began compiling node test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6
[0m02:17:51.960480 [debug] [Thread-3 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"
[0m02:17:51.963241 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1 (compile): 02:17:51.905588 => 02:17:51.962431
[0m02:17:51.970186 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f (compile): 02:17:51.923354 => 02:17:51.969833
[0m02:17:51.971636 [debug] [Thread-4 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"
[0m02:17:51.972772 [debug] [Thread-1 (]: Began executing node test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1
[0m02:17:51.973789 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f
[0m02:17:51.974994 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292 (compile): 02:17:51.955734 => 02:17:51.974705
[0m02:17:51.993022 [debug] [Thread-1 (]: Writing runtime sql for node "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"
[0m02:17:51.997078 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"
[0m02:17:51.998086 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6 (compile): 02:17:51.964223 => 02:17:51.997481
[0m02:17:51.999366 [debug] [Thread-3 (]: Began executing node test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292
[0m02:17:52.001452 [debug] [Thread-4 (]: Began executing node test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6
[0m02:17:52.005871 [debug] [Thread-3 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"
[0m02:17:52.006868 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"
[0m02:17:52.010513 [debug] [Thread-4 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"
[0m02:17:52.011782 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"
[0m02:17:52.014346 [debug] [Thread-1 (]: On test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1: BEGIN
[0m02:17:52.016556 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"
[0m02:17:52.017872 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f: BEGIN
[0m02:17:52.019065 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"
[0m02:17:52.020374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:52.021063 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292: BEGIN
[0m02:17:52.021642 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:17:52.022765 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6: BEGIN
[0m02:17:52.024193 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:17:52.025750 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:17:52.036635 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.037260 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"
[0m02:17:52.038562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.039641 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select codigo_servico
from "ida_datamart"."ida"."dim_servico"
where codigo_servico is null



      
    ) dbt_internal_test
[0m02:17:52.040898 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.041706 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"
[0m02:17:52.043770 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"
[0m02:17:52.045292 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.046571 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.047641 [debug] [Thread-1 (]: On test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        codigo_servico as value_field,
        count(*) as n_records

    from "ida_datamart"."ida"."dim_servico"
    group by codigo_servico

)

select *
from all_values
where value_field not in (
    'SMP','STFC','SCM'
)



      
    ) dbt_internal_test
[0m02:17:52.048307 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome_grupo
from "ida_datamart"."ida"."dim_grupo_economico"
where nome_grupo is null



      
    ) dbt_internal_test
[0m02:17:52.049934 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"
[0m02:17:52.053267 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292 (execute): 02:17:52.003371 => 02:17:52.052874
[0m02:17:52.055339 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ano
from "ida_datamart"."ida"."dim_tempo"
where ano is null



      
    ) dbt_internal_test
[0m02:17:52.056506 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.057485 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292: ROLLBACK
[0m02:17:52.058164 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.060627 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f (execute): 02:17:51.993719 => 02:17:52.060281
[0m02:17:52.061537 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.064690 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1 (execute): 02:17:51.975753 => 02:17:52.064339
[0m02:17:52.065615 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292: Close
[0m02:17:52.066592 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f: ROLLBACK
[0m02:17:52.068763 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6 (execute): 02:17:52.007906 => 02:17:52.068476
[0m02:17:52.069355 [debug] [Thread-1 (]: On test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1: ROLLBACK
[0m02:17:52.070639 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6: ROLLBACK
[0m02:17:52.071782 [info ] [Thread-3 (]: 3 of 17 PASS not_null_dim_servico_codigo_servico ............................... [[32mPASS[0m in 0.17s]
[0m02:17:52.072583 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f: Close
[0m02:17:52.074517 [debug] [Thread-3 (]: Finished running node test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292
[0m02:17:52.075204 [debug] [Thread-1 (]: On test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1: Close
[0m02:17:52.076091 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6: Close
[0m02:17:52.077756 [debug] [Thread-3 (]: Began running node test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d
[0m02:17:52.084117 [info ] [Thread-3 (]: 5 of 17 START test not_null_dim_tempo_ano_mes .................................. [RUN]
[0m02:17:52.081878 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM ........ [[32mPASS[0m in 0.19s]
[0m02:17:52.080163 [info ] [Thread-2 (]: 2 of 17 PASS not_null_dim_grupo_economico_nome_grupo ........................... [[32mPASS[0m in 0.18s]
[0m02:17:52.085662 [info ] [Thread-4 (]: 4 of 17 PASS not_null_dim_tempo_ano ............................................ [[32mPASS[0m in 0.18s]
[0m02:17:52.087727 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_servico_codigo_servico.8bf927b292, now test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d)
[0m02:17:52.090865 [debug] [Thread-1 (]: Finished running node test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1
[0m02:17:52.093496 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f
[0m02:17:52.095278 [debug] [Thread-4 (]: Finished running node test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6
[0m02:17:52.096535 [debug] [Thread-3 (]: Began compiling node test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d
[0m02:17:52.097485 [debug] [Thread-1 (]: Began running node test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972
[0m02:17:52.098696 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941
[0m02:17:52.100269 [debug] [Thread-4 (]: Began running node test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6
[0m02:17:52.107226 [debug] [Thread-3 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"
[0m02:17:52.108238 [info ] [Thread-1 (]: 6 of 17 START test not_null_dim_tempo_mes ...................................... [RUN]
[0m02:17:52.109882 [info ] [Thread-2 (]: 7 of 17 START test not_null_fato_ida_codigo_servico ............................ [RUN]
[0m02:17:52.111232 [info ] [Thread-4 (]: 8 of 17 START test not_null_fato_ida_id_tempo .................................. [RUN]
[0m02:17:52.112955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.accepted_values_dim_servico_codigo_servico__SMP__STFC__SCM.da0d8491f1, now test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972)
[0m02:17:52.114183 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_grupo_economico_nome_grupo.76f4fa4b3f, now test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941)
[0m02:17:52.115325 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d (compile): 02:17:52.101193 => 02:17:52.114549
[0m02:17:52.116835 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_tempo_ano.3f823cffe6, now test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6)
[0m02:17:52.117918 [debug] [Thread-1 (]: Began compiling node test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972
[0m02:17:52.118922 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941
[0m02:17:52.119774 [debug] [Thread-3 (]: Began executing node test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d
[0m02:17:52.120575 [debug] [Thread-4 (]: Began compiling node test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6
[0m02:17:52.129148 [debug] [Thread-1 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"
[0m02:17:52.135442 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"
[0m02:17:52.189908 [debug] [Thread-3 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"
[0m02:17:52.195017 [debug] [Thread-4 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"
[0m02:17:52.196664 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972 (compile): 02:17:52.121556 => 02:17:52.196327
[0m02:17:52.198974 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941 (compile): 02:17:52.129821 => 02:17:52.198340
[0m02:17:52.200256 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"
[0m02:17:52.201377 [debug] [Thread-1 (]: Began executing node test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972
[0m02:17:52.202484 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6 (compile): 02:17:52.190416 => 02:17:52.201776
[0m02:17:52.203324 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941
[0m02:17:52.204209 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d: BEGIN
[0m02:17:52.207163 [debug] [Thread-1 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"
[0m02:17:52.208022 [debug] [Thread-4 (]: Began executing node test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6
[0m02:17:52.210684 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"
[0m02:17:52.211468 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:17:52.215502 [debug] [Thread-4 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"
[0m02:17:52.216993 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"
[0m02:17:52.218463 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"
[0m02:17:52.219588 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972: BEGIN
[0m02:17:52.220213 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941: BEGIN
[0m02:17:52.221114 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"
[0m02:17:52.221795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:52.222331 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:17:52.223159 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6: BEGIN
[0m02:17:52.224555 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:17:52.227931 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.228865 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"
[0m02:17:52.230072 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ano_mes
from "ida_datamart"."ida"."dim_tempo"
where ano_mes is null



      
    ) dbt_internal_test
[0m02:17:52.232682 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.233570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.234034 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.234668 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.235125 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"
[0m02:17:52.235805 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"
[0m02:17:52.236319 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"
[0m02:17:52.238011 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d (execute): 02:17:52.136162 => 02:17:52.237745
[0m02:17:52.238594 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select codigo_servico
from "ida_datamart"."ida"."fato_ida"
where codigo_servico is null



      
    ) dbt_internal_test
[0m02:17:52.239155 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mes
from "ida_datamart"."ida"."dim_tempo"
where mes is null



      
    ) dbt_internal_test
[0m02:17:52.239683 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_tempo
from "ida_datamart"."ida"."fato_ida"
where id_tempo is null



      
    ) dbt_internal_test
[0m02:17:52.240438 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d: ROLLBACK
[0m02:17:52.242084 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.243949 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972 (execute): 02:17:52.204769 => 02:17:52.243587
[0m02:17:52.244631 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d: Close
[0m02:17:52.245374 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.246039 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.246563 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972: ROLLBACK
[0m02:17:52.248720 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941 (execute): 02:17:52.208395 => 02:17:52.248446
[0m02:17:52.250124 [info ] [Thread-3 (]: 5 of 17 PASS not_null_dim_tempo_ano_mes ........................................ [[32mPASS[0m in 0.16s]
[0m02:17:52.252383 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6 (execute): 02:17:52.212566 => 02:17:52.252115
[0m02:17:52.253324 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941: ROLLBACK
[0m02:17:52.254169 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972: Close
[0m02:17:52.255086 [debug] [Thread-3 (]: Finished running node test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d
[0m02:17:52.255802 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6: ROLLBACK
[0m02:17:52.258217 [debug] [Thread-3 (]: Began running node test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88
[0m02:17:52.258933 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941: Close
[0m02:17:52.257239 [info ] [Thread-1 (]: 6 of 17 PASS not_null_dim_tempo_mes ............................................ [[32mPASS[0m in 0.14s]
[0m02:17:52.260432 [info ] [Thread-3 (]: 9 of 17 START test not_null_fato_ida_nome_grupo ................................ [RUN]
[0m02:17:52.261127 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6: Close
[0m02:17:52.263215 [debug] [Thread-1 (]: Finished running node test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972
[0m02:17:52.264791 [info ] [Thread-2 (]: 7 of 17 PASS not_null_fato_ida_codigo_servico .................................. [[32mPASS[0m in 0.15s]
[0m02:17:52.266769 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_tempo_ano_mes.5de09b5b2d, now test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88)
[0m02:17:52.268391 [info ] [Thread-4 (]: 8 of 17 PASS not_null_fato_ida_id_tempo ........................................ [[32mPASS[0m in 0.15s]
[0m02:17:52.269914 [debug] [Thread-1 (]: Began running node test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d
[0m02:17:52.271502 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941
[0m02:17:52.272324 [debug] [Thread-3 (]: Began compiling node test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88
[0m02:17:52.273134 [debug] [Thread-4 (]: Finished running node test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6
[0m02:17:52.273868 [info ] [Thread-1 (]: 10 of 17 START test not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias ....... [RUN]
[0m02:17:52.275644 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:17:52.283580 [debug] [Thread-3 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"
[0m02:17:52.284657 [debug] [Thread-4 (]: Began running node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:17:52.285947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_dim_tempo_mes.e5c1450972, now test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d)
[0m02:17:52.286942 [info ] [Thread-2 (]: 11 of 17 START test not_null_long_delta_ano_mes ................................ [RUN]
[0m02:17:52.288638 [info ] [Thread-4 (]: 12 of 17 START test not_null_long_delta_diferenca .............................. [RUN]
[0m02:17:52.289961 [debug] [Thread-1 (]: Began compiling node test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d
[0m02:17:52.291056 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88 (compile): 02:17:52.276543 => 02:17:52.290374
[0m02:17:52.293033 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_fato_ida_codigo_servico.487c674941, now test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15)
[0m02:17:52.294349 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_fato_ida_id_tempo.6ec3a64ed6, now test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b)
[0m02:17:52.300184 [debug] [Thread-1 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"
[0m02:17:52.301120 [debug] [Thread-3 (]: Began executing node test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88
[0m02:17:52.301917 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:17:52.302691 [debug] [Thread-4 (]: Began compiling node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:17:52.303960 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d (compile): 02:17:52.295210 => 02:17:52.303697
[0m02:17:52.307464 [debug] [Thread-3 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"
[0m02:17:52.315394 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:17:52.321710 [debug] [Thread-4 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:17:52.323910 [debug] [Thread-1 (]: Began executing node test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d
[0m02:17:52.326494 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"
[0m02:17:52.327334 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15 (compile): 02:17:52.308179 => 02:17:52.326856
[0m02:17:52.330634 [debug] [Thread-1 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"
[0m02:17:52.332396 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b (compile): 02:17:52.316055 => 02:17:52.331779
[0m02:17:52.333210 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88: BEGIN
[0m02:17:52.333850 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:17:52.334966 [debug] [Thread-4 (]: Began executing node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:17:52.335529 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"
[0m02:17:52.336214 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:17:52.339008 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:17:52.341681 [debug] [Thread-4 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:17:52.342277 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d: BEGIN
[0m02:17:52.344458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:52.345521 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:17:52.346058 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: BEGIN
[0m02:17:52.346957 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:17:52.347815 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:17:52.348761 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: BEGIN
[0m02:17:52.350154 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:17:52.353467 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.354249 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.355037 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"
[0m02:17:52.355611 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"
[0m02:17:52.356219 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome_grupo
from "ida_datamart"."ida"."fato_ida"
where nome_grupo is null



      
    ) dbt_internal_test
[0m02:17:52.357121 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxa_solicitacoes_resolvidas_5dias
from "ida_datamart"."ida"."fato_ida"
where taxa_solicitacoes_resolvidas_5dias is null



      
    ) dbt_internal_test
[0m02:17:52.358802 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.359640 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.360180 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.360884 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:17:52.361958 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.364250 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d (execute): 02:17:52.327926 => 02:17:52.363912
[0m02:17:52.366095 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88 (execute): 02:17:52.304336 => 02:17:52.365782
[0m02:17:52.366886 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ano_mes
from "ida_datamart"."ida"."long_delta"
where ano_mes is null



      
    ) dbt_internal_test
[0m02:17:52.367465 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:17:52.368034 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d: ROLLBACK
[0m02:17:52.368752 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88: ROLLBACK
[0m02:17:52.369601 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select diferenca
from "ida_datamart"."ida"."long_delta"
where diferenca is null



      
    ) dbt_internal_test
[0m02:17:52.370579 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.371032 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d: Close
[0m02:17:52.373029 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15 (execute): 02:17:52.336607 => 02:17:52.372761
[0m02:17:52.373499 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88: Close
[0m02:17:52.374202 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.375166 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: ROLLBACK
[0m02:17:52.376111 [info ] [Thread-1 (]: 10 of 17 PASS not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias ............. [[32mPASS[0m in 0.09s]
[0m02:17:52.378740 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b (execute): 02:17:52.339417 => 02:17:52.378377
[0m02:17:52.380253 [info ] [Thread-3 (]: 9 of 17 PASS not_null_fato_ida_nome_grupo ...................................... [[32mPASS[0m in 0.11s]
[0m02:17:52.381950 [debug] [Thread-1 (]: Finished running node test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d
[0m02:17:52.382965 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: Close
[0m02:17:52.383654 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: ROLLBACK
[0m02:17:52.384782 [debug] [Thread-3 (]: Finished running node test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88
[0m02:17:52.385401 [debug] [Thread-1 (]: Began running node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:17:52.387295 [info ] [Thread-2 (]: 11 of 17 PASS not_null_long_delta_ano_mes ...................................... [[32mPASS[0m in 0.09s]
[0m02:17:52.388155 [debug] [Thread-3 (]: Began running node test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20
[0m02:17:52.389117 [debug] [Thread-4 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: Close
[0m02:17:52.390115 [info ] [Thread-1 (]: 13 of 17 START test not_null_long_delta_nome_grupo ............................. [RUN]
[0m02:17:52.391300 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:17:52.392091 [info ] [Thread-3 (]: 14 of 17 START test relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_  [RUN]
[0m02:17:52.393640 [error] [Thread-4 (]: 12 of 17 FAIL 109 not_null_long_delta_diferenca ................................ [[31mFAIL 109[0m in 0.10s]
[0m02:17:52.395534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_fato_ida_taxa_solicitacoes_resolvidas_5dias.35ae9d419d, now test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c)
[0m02:17:52.397264 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb
[0m02:17:52.399101 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_fato_ida_nome_grupo.4831c96e88, now test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20)
[0m02:17:52.400137 [debug] [Thread-4 (]: Finished running node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:17:52.400806 [debug] [Thread-1 (]: Began compiling node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:17:52.401614 [info ] [Thread-2 (]: 15 of 17 START test relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_  [RUN]
[0m02:17:52.403388 [debug] [Thread-3 (]: Began compiling node test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20
[0m02:17:52.404770 [debug] [Thread-4 (]: Began running node test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9
[0m02:17:52.412029 [debug] [Thread-1 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:17:52.413366 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15, now test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb)
[0m02:17:52.427751 [debug] [Thread-3 (]: Writing injected SQL for node "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"
[0m02:17:52.428742 [info ] [Thread-4 (]: 16 of 17 START test unique_dim_grupo_economico_nome_grupo ...................... [RUN]
[0m02:17:52.430335 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c (compile): 02:17:52.405788 => 02:17:52.430011
[0m02:17:52.431175 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb
[0m02:17:52.433445 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b, now test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9)
[0m02:17:52.434300 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20 (compile): 02:17:52.413995 => 02:17:52.433991
[0m02:17:52.435101 [debug] [Thread-1 (]: Began executing node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:17:52.445754 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"
[0m02:17:52.446821 [debug] [Thread-4 (]: Began compiling node test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9
[0m02:17:52.447647 [debug] [Thread-3 (]: Began executing node test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20
[0m02:17:52.451893 [debug] [Thread-1 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:17:52.461641 [debug] [Thread-4 (]: Writing injected SQL for node "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"
[0m02:17:52.462511 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb (compile): 02:17:52.435626 => 02:17:52.462162
[0m02:17:52.466006 [debug] [Thread-3 (]: Writing runtime sql for node "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"
[0m02:17:52.467965 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb
[0m02:17:52.468752 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:17:52.469492 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9 (compile): 02:17:52.452999 => 02:17:52.469200
[0m02:17:52.472547 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"
[0m02:17:52.473307 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: BEGIN
[0m02:17:52.473880 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"
[0m02:17:52.474739 [debug] [Thread-4 (]: Began executing node test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9
[0m02:17:52.475658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:52.476435 [debug] [Thread-3 (]: On test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20: BEGIN
[0m02:17:52.477331 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"
[0m02:17:52.480361 [debug] [Thread-4 (]: Writing runtime sql for node "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"
[0m02:17:52.481874 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:17:52.483293 [debug] [Thread-2 (]: On test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb: BEGIN
[0m02:17:52.485000 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"
[0m02:17:52.486209 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:17:52.487251 [debug] [Thread-4 (]: On test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9: BEGIN
[0m02:17:52.488777 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:17:52.492702 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.493266 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:17:52.494328 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome_grupo
from "ida_datamart"."ida"."long_delta"
where nome_grupo is null



      
    ) dbt_internal_test
[0m02:17:52.496976 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.497760 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.498476 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"
[0m02:17:52.499223 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.500042 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"
[0m02:17:52.500892 [debug] [Thread-3 (]: On test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select codigo_servico as from_field
    from "ida_datamart"."ida"."fato_ida"
    where codigo_servico is not null
),

parent as (
    select codigo_servico as to_field
    from "ida_datamart"."ida"."dim_servico"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:17:52.501667 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.503957 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c (execute): 02:17:52.448406 => 02:17:52.503677
[0m02:17:52.504801 [debug] [Thread-2 (]: On test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select nome_grupo as from_field
    from "ida_datamart"."ida"."fato_ida"
    where nome_grupo is not null
),

parent as (
    select nome_grupo as to_field
    from "ida_datamart"."ida"."dim_grupo_economico"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:17:52.505687 [debug] [Thread-4 (]: Using postgres connection "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"
[0m02:17:52.506308 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: ROLLBACK
[0m02:17:52.507350 [debug] [Thread-4 (]: On test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    nome_grupo as unique_field,
    count(*) as n_records

from "ida_datamart"."ida"."dim_grupo_economico"
where nome_grupo is not null
group by nome_grupo
having count(*) > 1



      
    ) dbt_internal_test
[0m02:17:52.508213 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.510652 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20 (execute): 02:17:52.462925 => 02:17:52.510210
[0m02:17:52.511688 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: Close
[0m02:17:52.512490 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.513644 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.514743 [debug] [Thread-3 (]: On test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20: ROLLBACK
[0m02:17:52.516671 [info ] [Thread-1 (]: 13 of 17 PASS not_null_long_delta_nome_grupo ................................... [[32mPASS[0m in 0.12s]
[0m02:17:52.518701 [debug] [Thread-4 (]: Timing info for test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9 (execute): 02:17:52.477668 => 02:17:52.518325
[0m02:17:52.520540 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb (execute): 02:17:52.470175 => 02:17:52.520261
[0m02:17:52.521797 [debug] [Thread-1 (]: Finished running node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:17:52.522578 [debug] [Thread-3 (]: On test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20: Close
[0m02:17:52.523184 [debug] [Thread-4 (]: On test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9: ROLLBACK
[0m02:17:52.523735 [debug] [Thread-2 (]: On test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb: ROLLBACK
[0m02:17:52.524489 [debug] [Thread-1 (]: Began running node test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912
[0m02:17:52.526812 [info ] [Thread-3 (]: 14 of 17 PASS relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_  [[32mPASS[0m in 0.13s]
[0m02:17:52.528687 [debug] [Thread-4 (]: On test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9: Close
[0m02:17:52.529915 [debug] [Thread-2 (]: On test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb: Close
[0m02:17:52.530845 [info ] [Thread-1 (]: 17 of 17 START test unique_dim_tempo_ano_mes ................................... [RUN]
[0m02:17:52.532042 [debug] [Thread-3 (]: Finished running node test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20
[0m02:17:52.534120 [info ] [Thread-4 (]: 16 of 17 PASS unique_dim_grupo_economico_nome_grupo ............................ [[32mPASS[0m in 0.10s]
[0m02:17:52.535562 [info ] [Thread-2 (]: 15 of 17 PASS relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_  [[32mPASS[0m in 0.12s]
[0m02:17:52.536846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c, now test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912)
[0m02:17:52.538822 [debug] [Thread-4 (]: Finished running node test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9
[0m02:17:52.540238 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb
[0m02:17:52.541026 [debug] [Thread-1 (]: Began compiling node test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912
[0m02:17:52.548113 [debug] [Thread-1 (]: Writing injected SQL for node "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"
[0m02:17:52.549085 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912 (compile): 02:17:52.543085 => 02:17:52.548761
[0m02:17:52.549542 [debug] [Thread-1 (]: Began executing node test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912
[0m02:17:52.552448 [debug] [Thread-1 (]: Writing runtime sql for node "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"
[0m02:17:52.553230 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"
[0m02:17:52.554907 [debug] [Thread-1 (]: On test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912: BEGIN
[0m02:17:52.556316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:52.566641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.567233 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"
[0m02:17:52.567667 [debug] [Thread-1 (]: On test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ano_mes as unique_field,
    count(*) as n_records

from "ida_datamart"."ida"."dim_tempo"
where ano_mes is not null
group by ano_mes
having count(*) > 1



      
    ) dbt_internal_test
[0m02:17:52.570665 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:17:52.572595 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912 (execute): 02:17:52.549860 => 02:17:52.572267
[0m02:17:52.573173 [debug] [Thread-1 (]: On test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912: ROLLBACK
[0m02:17:52.574293 [debug] [Thread-1 (]: On test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912: Close
[0m02:17:52.575940 [info ] [Thread-1 (]: 17 of 17 PASS unique_dim_tempo_ano_mes ......................................... [[32mPASS[0m in 0.04s]
[0m02:17:52.577937 [debug] [Thread-1 (]: Finished running node test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912
[0m02:17:52.582022 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:52.582636 [debug] [MainThread]: On master: BEGIN
[0m02:17:52.583161 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:17:52.591953 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:17:52.592498 [debug] [MainThread]: On master: COMMIT
[0m02:17:52.592868 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:52.593189 [debug] [MainThread]: On master: COMMIT
[0m02:17:52.593895 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:17:52.594357 [debug] [MainThread]: On master: Close
[0m02:17:52.595339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:17:52.595774 [debug] [MainThread]: Connection 'test.beanalytic_ida.unique_dim_tempo_ano_mes.495832c912' was properly closed.
[0m02:17:52.596085 [debug] [MainThread]: Connection 'test.beanalytic_ida.relationships_fato_ida_nome_grupo__nome_grupo__ref_dim_grupo_economico_.950215c8fb' was properly closed.
[0m02:17:52.596386 [debug] [MainThread]: Connection 'test.beanalytic_ida.relationships_fato_ida_codigo_servico__codigo_servico__ref_dim_servico_.4b18262a20' was properly closed.
[0m02:17:52.596659 [debug] [MainThread]: Connection 'test.beanalytic_ida.unique_dim_grupo_economico_nome_grupo.35c83b9bc9' was properly closed.
[0m02:17:52.597034 [info ] [MainThread]: 
[0m02:17:52.597481 [info ] [MainThread]: Finished running 17 tests in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m02:17:52.600257 [debug] [MainThread]: Command end result
[0m02:17:52.614606 [info ] [MainThread]: 
[0m02:17:52.615165 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:17:52.615582 [info ] [MainThread]: 
[0m02:17:52.615936 [error] [MainThread]: [31mFailure in test not_null_long_delta_diferenca (models/tests.yml)[0m
[0m02:17:52.616277 [error] [MainThread]:   Got 109 results, configured to fail if != 0
[0m02:17:52.616621 [info ] [MainThread]: 
[0m02:17:52.616915 [info ] [MainThread]:   compiled Code at target/compiled/beanalytic_ida/models/tests.yml/not_null_long_delta_diferenca.sql
[0m02:17:52.617266 [info ] [MainThread]: 
[0m02:17:52.617599 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=1 SKIP=0 TOTAL=17
[0m02:17:52.619101 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.2314323, "process_user_time": 3.068519, "process_kernel_time": 0.304448, "process_mem_max_rss": "106028", "process_out_blocks": "2880", "command_success": false, "process_in_blocks": "0"}
[0m02:17:52.619775 [debug] [MainThread]: Command `dbt test` failed at 02:17:52.619620 after 1.23 seconds
[0m02:17:52.620268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca69a93730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca67c63970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca567284c0>]}
[0m02:17:52.620722 [debug] [MainThread]: Flushing usage events
[0m02:18:25.734770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238d4aa7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238d2c48970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238d2c4bee0>]}


============================== 02:18:25.742053 | 6df46a76-fd65-4616-9d76-439777333669 ==============================
[0m02:18:25.742053 [info ] [MainThread]: Running with dbt=1.7.3
[0m02:18:25.742570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select long_delta', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:18:25.928085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6df46a76-fd65-4616-9d76-439777333669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238d6d8fc40>]}
[0m02:18:26.039131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6df46a76-fd65-4616-9d76-439777333669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238d2d7bac0>]}
[0m02:18:26.041009 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m02:18:26.049348 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m02:18:26.096114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:18:26.097071 [debug] [MainThread]: Partial parsing: updated file: beanalytic_ida://models/analytics/long_delta.sql
[0m02:18:26.465227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6df46a76-fd65-4616-9d76-439777333669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238bb8a3fd0>]}
[0m02:18:26.475572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6df46a76-fd65-4616-9d76-439777333669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238d1227c70>]}
[0m02:18:26.476078 [info ] [MainThread]: Found 5 models, 17 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m02:18:26.476444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6df46a76-fd65-4616-9d76-439777333669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238d1227f10>]}
[0m02:18:26.477696 [info ] [MainThread]: 
[0m02:18:26.478499 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:18:26.480061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ida_datamart'
[0m02:18:26.493018 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart"
[0m02:18:26.493477 [debug] [ThreadPool]: On list_ida_datamart: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart"} */

    select distinct nspname from pg_namespace
  
[0m02:18:26.494280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:26.509470 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:18:26.510936 [debug] [ThreadPool]: On list_ida_datamart: Close
[0m02:18:26.514158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ida_datamart, now list_ida_datamart_ida)
[0m02:18:26.521059 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida"
[0m02:18:26.521528 [debug] [ThreadPool]: On list_ida_datamart_ida: BEGIN
[0m02:18:26.521821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:26.532444 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:18:26.533018 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida"
[0m02:18:26.533596 [debug] [ThreadPool]: On list_ida_datamart_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart_ida"} */
select
      'ida_datamart' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ida'
    union all
    select
      'ida_datamart' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ida'
    union all
    select
      'ida_datamart' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ida'
  
[0m02:18:26.537238 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:18:26.538535 [debug] [ThreadPool]: On list_ida_datamart_ida: ROLLBACK
[0m02:18:26.539142 [debug] [ThreadPool]: On list_ida_datamart_ida: Close
[0m02:18:26.546558 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:26.547029 [debug] [MainThread]: On master: BEGIN
[0m02:18:26.547390 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:18:26.555765 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:18:26.556500 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:26.556918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:18:26.560479 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:18:26.561573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6df46a76-fd65-4616-9d76-439777333669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238bb8fb880>]}
[0m02:18:26.562027 [debug] [MainThread]: On master: ROLLBACK
[0m02:18:26.562780 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:26.563152 [debug] [MainThread]: On master: BEGIN
[0m02:18:26.563966 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:18:26.564365 [debug] [MainThread]: On master: COMMIT
[0m02:18:26.564611 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:26.564869 [debug] [MainThread]: On master: COMMIT
[0m02:18:26.565628 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:18:26.565948 [debug] [MainThread]: On master: Close
[0m02:18:26.566640 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:18:26.567266 [info ] [MainThread]: 
[0m02:18:26.576799 [debug] [Thread-1 (]: Began running node model.beanalytic_ida.long_delta
[0m02:18:26.577452 [info ] [Thread-1 (]: 1 of 1 START sql table model ida.long_delta .................................... [RUN]
[0m02:18:26.578376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ida_datamart_ida, now model.beanalytic_ida.long_delta)
[0m02:18:26.578768 [debug] [Thread-1 (]: Began compiling node model.beanalytic_ida.long_delta
[0m02:18:26.587287 [debug] [Thread-1 (]: Writing injected SQL for node "model.beanalytic_ida.long_delta"
[0m02:18:26.589229 [debug] [Thread-1 (]: Timing info for model.beanalytic_ida.long_delta (compile): 02:18:26.578976 => 02:18:26.588441
[0m02:18:26.590064 [debug] [Thread-1 (]: Began executing node model.beanalytic_ida.long_delta
[0m02:18:26.637119 [debug] [Thread-1 (]: Writing runtime sql for node "model.beanalytic_ida.long_delta"
[0m02:18:26.637981 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:18:26.638370 [debug] [Thread-1 (]: On model.beanalytic_ida.long_delta: BEGIN
[0m02:18:26.638729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:26.645339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:18:26.645783 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:18:26.646163 [debug] [Thread-1 (]: On model.beanalytic_ida.long_delta: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.long_delta"} */

  
    

  create  table "ida_datamart"."ida"."long_delta__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
  SELECT
    t.ano_mes,
    f.id_tempo,
    f.nome_grupo,
    f.codigo_servico,
    f.taxa_solicitacoes_resolvidas_5dias AS ida
  FROM "ida_datamart"."ida"."fato_ida" f
  JOIN "ida_datamart"."ida"."dim_tempo" t ON f.id_tempo = t.id_tempo
),
mercado AS (
  SELECT
    ano_mes,
    AVG(ida) AS valor_mercado
  FROM base
  GROUP BY ano_mes
),
variacoes AS (
  SELECT
    b.ano_mes,
    b.nome_grupo,
    -- VariaÃ§Ã£o do mercado (%): (atual - anterior) / anterior * 100
    CASE
      WHEN LAG(m.valor_mercado) OVER (ORDER BY b.ano_mes) > 0
      THEN ((m.valor_mercado - LAG(m.valor_mercado) OVER (ORDER BY b.ano_mes))
            / LAG(m.valor_mercado) OVER (ORDER BY b.ano_mes)) * 100
    END AS var_mercado,
    -- VariaÃ§Ã£o individual da operadora (%)
    CASE
      WHEN LAG(b.ida) OVER (PARTITION BY b.nome_grupo ORDER BY b.ano_mes) > 0
      THEN ((b.ida - LAG(b.ida) OVER (PARTITION BY b.nome_grupo ORDER BY b.ano_mes))
            / LAG(b.ida) OVER (PARTITION BY b.nome_grupo ORDER BY b.ano_mes)) * 100
    END AS var_individual
  FROM base b
  JOIN mercado m USING (ano_mes)
)
SELECT
  ano_mes,
  nome_grupo,
  ROUND(var_mercado::numeric, 2) AS var_mercado,
  ROUND(var_individual::numeric, 2) AS var_individual,
  ROUND((var_mercado - var_individual)::numeric, 2) AS diferenca
FROM variacoes
WHERE var_mercado IS NOT NULL
  AND var_individual IS NOT NULL
  );
  
[0m02:18:26.660918 [debug] [Thread-1 (]: SQL status: SELECT 1188 in 0.0 seconds
[0m02:18:26.667490 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:18:26.668011 [debug] [Thread-1 (]: On model.beanalytic_ida.long_delta: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.long_delta"} */
alter table "ida_datamart"."ida"."long_delta" rename to "long_delta__dbt_backup"
[0m02:18:26.669154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:18:26.672199 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:18:26.672649 [debug] [Thread-1 (]: On model.beanalytic_ida.long_delta: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.long_delta"} */
alter table "ida_datamart"."ida"."long_delta__dbt_tmp" rename to "long_delta"
[0m02:18:26.673529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:18:26.692521 [debug] [Thread-1 (]: On model.beanalytic_ida.long_delta: COMMIT
[0m02:18:26.693029 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:18:26.693404 [debug] [Thread-1 (]: On model.beanalytic_ida.long_delta: COMMIT
[0m02:18:26.696839 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:18:26.703386 [debug] [Thread-1 (]: Applying DROP to: "ida_datamart"."ida"."long_delta__dbt_backup"
[0m02:18:26.707606 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:18:26.708041 [debug] [Thread-1 (]: On model.beanalytic_ida.long_delta: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.long_delta"} */
drop table if exists "ida_datamart"."ida"."long_delta__dbt_backup" cascade
[0m02:18:26.713161 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:18:26.714895 [debug] [Thread-1 (]: Timing info for model.beanalytic_ida.long_delta (execute): 02:18:26.590313 => 02:18:26.714704
[0m02:18:26.715293 [debug] [Thread-1 (]: On model.beanalytic_ida.long_delta: Close
[0m02:18:26.716219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6df46a76-fd65-4616-9d76-439777333669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238bb8f82e0>]}
[0m02:18:26.716843 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ida.long_delta ............................... [[32mSELECT 1188[0m in 0.14s]
[0m02:18:26.717483 [debug] [Thread-1 (]: Finished running node model.beanalytic_ida.long_delta
[0m02:18:26.720880 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:26.721562 [debug] [MainThread]: On master: BEGIN
[0m02:18:26.721895 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:18:26.734779 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:18:26.735554 [debug] [MainThread]: On master: COMMIT
[0m02:18:26.735918 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:26.736186 [debug] [MainThread]: On master: COMMIT
[0m02:18:26.736905 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:18:26.737546 [debug] [MainThread]: On master: Close
[0m02:18:26.738604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:26.738934 [debug] [MainThread]: Connection 'model.beanalytic_ida.long_delta' was properly closed.
[0m02:18:26.739271 [info ] [MainThread]: 
[0m02:18:26.739621 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m02:18:26.740274 [debug] [MainThread]: Command end result
[0m02:18:26.759755 [info ] [MainThread]: 
[0m02:18:26.760564 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:18:26.760906 [info ] [MainThread]: 
[0m02:18:26.761233 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:18:26.762114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0693636, "process_user_time": 2.900971, "process_kernel_time": 0.278939, "process_mem_max_rss": "110192", "process_out_blocks": "3320", "process_in_blocks": "0"}
[0m02:18:26.762731 [debug] [MainThread]: Command `dbt run` succeeded at 02:18:26.762606 after 1.07 seconds
[0m02:18:26.763101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238d4aa7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238bb7534c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238bb763f70>]}
[0m02:18:26.764513 [debug] [MainThread]: Flushing usage events
[0m02:18:31.802496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9752b7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f973633f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9736303a0>]}


============================== 02:18:31.809035 | a5ef7f68-917a-4f81-a272-e6b49b745041 ==============================
[0m02:18:31.809035 [info ] [MainThread]: Running with dbt=1.7.3
[0m02:18:31.809651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/dbt/logs', 'profiles_dir': '/opt/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select not_null_long_delta_diferenca not_null_long_delta_ano_mes not_null_long_delta_nome_grupo', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:18:32.074949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5ef7f68-917a-4f81-a272-e6b49b745041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f975a8f2e0>]}
[0m02:18:32.185925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5ef7f68-917a-4f81-a272-e6b49b745041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f973465420>]}
[0m02:18:32.187124 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m02:18:32.195726 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m02:18:32.231313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:18:32.231873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:18:32.238309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5ef7f68-917a-4f81-a272-e6b49b745041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f971a4e2f0>]}
[0m02:18:32.249947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5ef7f68-917a-4f81-a272-e6b49b745041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f971a18d90>]}
[0m02:18:32.250626 [info ] [MainThread]: Found 5 models, 17 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m02:18:32.251097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5ef7f68-917a-4f81-a272-e6b49b745041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f971a18fd0>]}
[0m02:18:32.252902 [info ] [MainThread]: 
[0m02:18:32.253877 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:18:32.256685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ida_datamart_ida'
[0m02:18:32.270006 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida"
[0m02:18:32.270619 [debug] [ThreadPool]: On list_ida_datamart_ida: BEGIN
[0m02:18:32.270946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:32.280775 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:18:32.281305 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida"
[0m02:18:32.281768 [debug] [ThreadPool]: On list_ida_datamart_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart_ida"} */
select
      'ida_datamart' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ida'
    union all
    select
      'ida_datamart' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ida'
    union all
    select
      'ida_datamart' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ida'
  
[0m02:18:32.285340 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:18:32.286946 [debug] [ThreadPool]: On list_ida_datamart_ida: ROLLBACK
[0m02:18:32.287983 [debug] [ThreadPool]: On list_ida_datamart_ida: Close
[0m02:18:32.295339 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:32.296751 [debug] [MainThread]: On master: BEGIN
[0m02:18:32.297207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:18:32.304906 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:18:32.305358 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:32.305757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:18:32.309085 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:18:32.310270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5ef7f68-917a-4f81-a272-e6b49b745041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f971a03550>]}
[0m02:18:32.310819 [debug] [MainThread]: On master: ROLLBACK
[0m02:18:32.311550 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:32.311980 [debug] [MainThread]: On master: BEGIN
[0m02:18:32.313937 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:18:32.314401 [debug] [MainThread]: On master: COMMIT
[0m02:18:32.314778 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:32.315056 [debug] [MainThread]: On master: COMMIT
[0m02:18:32.315756 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:18:32.316136 [debug] [MainThread]: On master: Close
[0m02:18:32.316915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:18:32.317300 [info ] [MainThread]: 
[0m02:18:32.329852 [debug] [Thread-1 (]: Began running node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:18:32.330911 [debug] [Thread-2 (]: Began running node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:18:32.331494 [info ] [Thread-1 (]: 1 of 3 START test not_null_long_delta_ano_mes .................................. [RUN]
[0m02:18:32.332886 [debug] [Thread-3 (]: Began running node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:18:32.334219 [info ] [Thread-2 (]: 2 of 3 START test not_null_long_delta_diferenca ................................ [RUN]
[0m02:18:32.335486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ida_datamart_ida, now test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15)
[0m02:18:32.336270 [info ] [Thread-3 (]: 3 of 3 START test not_null_long_delta_nome_grupo ............................... [RUN]
[0m02:18:32.337568 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b'
[0m02:18:32.338089 [debug] [Thread-1 (]: Began compiling node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:18:32.339275 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c'
[0m02:18:32.339878 [debug] [Thread-2 (]: Began compiling node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:18:32.352173 [debug] [Thread-3 (]: Began compiling node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:18:32.366765 [debug] [Thread-1 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:18:32.371433 [debug] [Thread-2 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:18:32.375868 [debug] [Thread-3 (]: Writing injected SQL for node "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:18:32.377522 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15 (compile): 02:18:32.340423 => 02:18:32.377222
[0m02:18:32.378516 [debug] [Thread-1 (]: Began executing node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:18:32.386200 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c (compile): 02:18:32.372068 => 02:18:32.385505
[0m02:18:32.386757 [debug] [Thread-3 (]: Began executing node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:18:32.393610 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b (compile): 02:18:32.367138 => 02:18:32.392974
[0m02:18:32.404652 [debug] [Thread-1 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:18:32.417401 [debug] [Thread-2 (]: Began executing node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:18:32.419358 [debug] [Thread-3 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:18:32.423651 [debug] [Thread-2 (]: Writing runtime sql for node "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:18:32.424776 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:18:32.426143 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: BEGIN
[0m02:18:32.426875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:32.429010 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:18:32.430671 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: BEGIN
[0m02:18:32.431139 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:18:32.431896 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:18:32.433246 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: BEGIN
[0m02:18:32.433650 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:18:32.438397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:18:32.438985 [debug] [Thread-1 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"
[0m02:18:32.439427 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ano_mes
from "ida_datamart"."ida"."long_delta"
where ano_mes is null



      
    ) dbt_internal_test
[0m02:18:32.441588 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:18:32.442087 [debug] [Thread-2 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"
[0m02:18:32.443057 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select diferenca
from "ida_datamart"."ida"."long_delta"
where diferenca is null



      
    ) dbt_internal_test
[0m02:18:32.443827 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:18:32.444685 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:18:32.445642 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:18:32.449137 [debug] [Thread-1 (]: Timing info for test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15 (execute): 02:18:32.379951 => 02:18:32.448789
[0m02:18:32.450162 [debug] [Thread-3 (]: Using postgres connection "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"
[0m02:18:32.452521 [debug] [Thread-2 (]: Timing info for test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b (execute): 02:18:32.421070 => 02:18:32.452219
[0m02:18:32.453624 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: ROLLBACK
[0m02:18:32.454445 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome_grupo
from "ida_datamart"."ida"."long_delta"
where nome_grupo is null



      
    ) dbt_internal_test
[0m02:18:32.455203 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: ROLLBACK
[0m02:18:32.456186 [debug] [Thread-1 (]: On test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15: Close
[0m02:18:32.457477 [debug] [Thread-2 (]: On test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b: Close
[0m02:18:32.460155 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:18:32.458716 [info ] [Thread-2 (]: 2 of 3 PASS not_null_long_delta_diferenca ...................................... [[32mPASS[0m in 0.12s]
[0m02:18:32.461703 [info ] [Thread-1 (]: 1 of 3 PASS not_null_long_delta_ano_mes ........................................ [[32mPASS[0m in 0.13s]
[0m02:18:32.463933 [debug] [Thread-3 (]: Timing info for test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c (execute): 02:18:32.394220 => 02:18:32.463655
[0m02:18:32.464666 [debug] [Thread-2 (]: Finished running node test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b
[0m02:18:32.465907 [debug] [Thread-1 (]: Finished running node test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15
[0m02:18:32.466481 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: ROLLBACK
[0m02:18:32.468405 [debug] [Thread-3 (]: On test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c: Close
[0m02:18:32.469539 [info ] [Thread-3 (]: 3 of 3 PASS not_null_long_delta_nome_grupo ..................................... [[32mPASS[0m in 0.13s]
[0m02:18:32.472039 [debug] [Thread-3 (]: Finished running node test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c
[0m02:18:32.475621 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:32.476135 [debug] [MainThread]: On master: BEGIN
[0m02:18:32.476467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:18:32.485983 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:18:32.486563 [debug] [MainThread]: On master: COMMIT
[0m02:18:32.486981 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:32.487261 [debug] [MainThread]: On master: COMMIT
[0m02:18:32.488859 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:18:32.490883 [debug] [MainThread]: On master: Close
[0m02:18:32.492996 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:32.493603 [debug] [MainThread]: Connection 'test.beanalytic_ida.not_null_long_delta_ano_mes.23ab723f15' was properly closed.
[0m02:18:32.493944 [debug] [MainThread]: Connection 'test.beanalytic_ida.not_null_long_delta_diferenca.1712db130b' was properly closed.
[0m02:18:32.494216 [debug] [MainThread]: Connection 'test.beanalytic_ida.not_null_long_delta_nome_grupo.54adbeee7c' was properly closed.
[0m02:18:32.494600 [info ] [MainThread]: 
[0m02:18:32.494996 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m02:18:32.495857 [debug] [MainThread]: Command end result
[0m02:18:32.510861 [info ] [MainThread]: 
[0m02:18:32.511507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:18:32.511930 [info ] [MainThread]: 
[0m02:18:32.512256 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:18:32.513252 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7580983, "process_user_time": 2.706822, "process_kernel_time": 0.275473, "process_mem_max_rss": "105236", "process_out_blocks": "2520", "process_in_blocks": "0"}
[0m02:18:32.513857 [debug] [MainThread]: Command `dbt test` succeeded at 02:18:32.513720 after 0.76 seconds
[0m02:18:32.514215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9752b7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f973465420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9718cee60>]}
[0m02:18:32.514588 [debug] [MainThread]: Flushing usage events
[0m02:20:49.544704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916cd6bf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916cba39150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916cba3bfa0>]}


============================== 02:20:49.551273 | 9eba6cea-3df5-4efa-8bd2-cbdecf233409 ==============================
[0m02:20:49.551273 [info ] [MainThread]: Running with dbt=1.7.3
[0m02:20:49.551997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/dbt', 'log_path': '/opt/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select pivot_variacao', 'send_anonymous_usage_stats': 'True'}
[0m02:20:49.744727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9eba6cea-3df5-4efa-8bd2-cbdecf233409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916cf99fc40>]}
[0m02:20:49.838661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9eba6cea-3df5-4efa-8bd2-cbdecf233409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916cb86d420>]}
[0m02:20:49.839573 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m02:20:49.849994 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m02:20:49.889465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:20:49.890210 [debug] [MainThread]: Partial parsing: added file: beanalytic_ida://models/analytics/pivot_variacao.sql
[0m02:20:50.064829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9eba6cea-3df5-4efa-8bd2-cbdecf233409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916c9bd3eb0>]}
[0m02:20:50.075934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9eba6cea-3df5-4efa-8bd2-cbdecf233409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916c9e0bb80>]}
[0m02:20:50.076527 [info ] [MainThread]: Found 6 models, 17 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m02:20:50.076928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eba6cea-3df5-4efa-8bd2-cbdecf233409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916c9e0bfa0>]}
[0m02:20:50.078576 [info ] [MainThread]: 
[0m02:20:50.079414 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:20:50.080665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ida_datamart'
[0m02:20:50.087069 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart"
[0m02:20:50.087540 [debug] [ThreadPool]: On list_ida_datamart: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart"} */

    select distinct nspname from pg_namespace
  
[0m02:20:50.087844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:50.102502 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:20:50.103953 [debug] [ThreadPool]: On list_ida_datamart: Close
[0m02:20:50.107349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ida_datamart, now list_ida_datamart_ida)
[0m02:20:50.115302 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida"
[0m02:20:50.116719 [debug] [ThreadPool]: On list_ida_datamart_ida: BEGIN
[0m02:20:50.117094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:50.125922 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:20:50.126409 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida"
[0m02:20:50.126833 [debug] [ThreadPool]: On list_ida_datamart_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart_ida"} */
select
      'ida_datamart' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ida'
    union all
    select
      'ida_datamart' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ida'
    union all
    select
      'ida_datamart' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ida'
  
[0m02:20:50.131012 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:20:50.132656 [debug] [ThreadPool]: On list_ida_datamart_ida: ROLLBACK
[0m02:20:50.133654 [debug] [ThreadPool]: On list_ida_datamart_ida: Close
[0m02:20:50.140397 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:50.140891 [debug] [MainThread]: On master: BEGIN
[0m02:20:50.141217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:20:50.148765 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:20:50.149248 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:50.149660 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:20:50.153356 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:20:50.154564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eba6cea-3df5-4efa-8bd2-cbdecf233409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916c9d49c60>]}
[0m02:20:50.155095 [debug] [MainThread]: On master: ROLLBACK
[0m02:20:50.155840 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:50.156217 [debug] [MainThread]: On master: BEGIN
[0m02:20:50.156975 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:20:50.157303 [debug] [MainThread]: On master: COMMIT
[0m02:20:50.157569 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:50.157820 [debug] [MainThread]: On master: COMMIT
[0m02:20:50.158534 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:20:50.158889 [debug] [MainThread]: On master: Close
[0m02:20:50.159629 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:20:50.160227 [info ] [MainThread]: 
[0m02:20:50.217723 [debug] [Thread-1 (]: Began running node model.beanalytic_ida.pivot_variacao
[0m02:20:50.218380 [info ] [Thread-1 (]: 1 of 1 START sql view model ida.pivot_variacao ................................. [RUN]
[0m02:20:50.219194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ida_datamart_ida, now model.beanalytic_ida.pivot_variacao)
[0m02:20:50.219584 [debug] [Thread-1 (]: Began compiling node model.beanalytic_ida.pivot_variacao
[0m02:20:50.229536 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.pivot_variacao"
[0m02:20:50.230081 [debug] [Thread-1 (]: On model.beanalytic_ida.pivot_variacao: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.pivot_variacao"} */

    select distinct nome_grupo from "ida_datamart"."ida"."dim_grupo_economico"
  
[0m02:20:50.230531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:20:50.238585 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m02:20:50.240411 [debug] [Thread-1 (]: Writing injected SQL for node "model.beanalytic_ida.pivot_variacao"
[0m02:20:50.241221 [debug] [Thread-1 (]: Timing info for model.beanalytic_ida.pivot_variacao (compile): 02:20:50.219805 => 02:20:50.240957
[0m02:20:50.241611 [debug] [Thread-1 (]: Began executing node model.beanalytic_ida.pivot_variacao
[0m02:20:50.281112 [debug] [Thread-1 (]: Writing runtime sql for node "model.beanalytic_ida.pivot_variacao"
[0m02:20:50.281899 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.pivot_variacao"
[0m02:20:50.282305 [debug] [Thread-1 (]: On model.beanalytic_ida.pivot_variacao: BEGIN
[0m02:20:50.283403 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:20:50.283771 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.pivot_variacao"
[0m02:20:50.284171 [debug] [Thread-1 (]: On model.beanalytic_ida.pivot_variacao: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.pivot_variacao"} */

  create view "ida_datamart"."ida"."pivot_variacao__dbt_tmp"
    
    
  as (
    



  


select
  ano_mes as "Mes",
  coalesce(round(avg(var_mercado)::numeric, 1), 0) as "Taxa de VariaÃ§Ã£o MÃ©dia"
  
  , coalesce(round(max(case when nome_grupo = 'VIVO' then diferenca end)::numeric, 1), 0) as "VIVO"
  
  , coalesce(round(max(case when nome_grupo = 'OI' then diferenca end)::numeric, 1), 0) as "OI"
  
  , coalesce(round(max(case when nome_grupo = 'NET' then diferenca end)::numeric, 1), 0) as "NET"
  
  , coalesce(round(max(case when nome_grupo = 'NEXTEL' then diferenca end)::numeric, 1), 0) as "NEXTEL"
  
  , coalesce(round(max(case when nome_grupo = 'CLARO' then diferenca end)::numeric, 1), 0) as "CLARO"
  
  , coalesce(round(max(case when nome_grupo = 'VIACABO' then diferenca end)::numeric, 1), 0) as "VIACABO"
  
  , coalesce(round(max(case when nome_grupo = 'SERCOMTEL' then diferenca end)::numeric, 1), 0) as "SERCOMTEL"
  
  , coalesce(round(max(case when nome_grupo = 'TIM' then diferenca end)::numeric, 1), 0) as "TIM"
  
  , coalesce(round(max(case when nome_grupo = 'EMBRATEL' then diferenca end)::numeric, 1), 0) as "EMBRATEL"
  
  , coalesce(round(max(case when nome_grupo = 'SKY' then diferenca end)::numeric, 1), 0) as "SKY"
  
  , coalesce(round(max(case when nome_grupo = 'ALGAR' then diferenca end)::numeric, 1), 0) as "ALGAR"
  
  , coalesce(round(max(case when nome_grupo = 'GVT' then diferenca end)::numeric, 1), 0) as "GVT"
  
  , coalesce(round(max(case when nome_grupo = 'SERCOMTEL CELULAR' then diferenca end)::numeric, 1), 0) as "SERCOMTEL CELULAR"
  
  , coalesce(round(max(case when nome_grupo = 'GVT (*)' then diferenca end)::numeric, 1), 0) as "GVT (*)"
  
  , coalesce(round(max(case when nome_grupo = 'VIACABO (**)' then diferenca end)::numeric, 1), 0) as "VIACABO (**)"
  
  , coalesce(round(max(case when nome_grupo = 'INTELIG' then diferenca end)::numeric, 1), 0) as "INTELIG"
  
from "ida_datamart"."ida"."long_delta"
group by 1
order by "Mes"
  );
[0m02:20:50.290304 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:20:50.297075 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.pivot_variacao"
[0m02:20:50.297616 [debug] [Thread-1 (]: On model.beanalytic_ida.pivot_variacao: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.pivot_variacao"} */
alter table "ida_datamart"."ida"."pivot_variacao__dbt_tmp" rename to "pivot_variacao"
[0m02:20:50.299099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:20:50.314164 [debug] [Thread-1 (]: On model.beanalytic_ida.pivot_variacao: COMMIT
[0m02:20:50.314726 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.pivot_variacao"
[0m02:20:50.315106 [debug] [Thread-1 (]: On model.beanalytic_ida.pivot_variacao: COMMIT
[0m02:20:50.318712 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:20:50.325251 [debug] [Thread-1 (]: Applying DROP to: "ida_datamart"."ida"."pivot_variacao__dbt_backup"
[0m02:20:50.330084 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.pivot_variacao"
[0m02:20:50.330613 [debug] [Thread-1 (]: On model.beanalytic_ida.pivot_variacao: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.pivot_variacao"} */
drop view if exists "ida_datamart"."ida"."pivot_variacao__dbt_backup" cascade
[0m02:20:50.331439 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:20:50.332996 [debug] [Thread-1 (]: Timing info for model.beanalytic_ida.pivot_variacao (execute): 02:20:50.241852 => 02:20:50.332770
[0m02:20:50.333449 [debug] [Thread-1 (]: On model.beanalytic_ida.pivot_variacao: Close
[0m02:20:50.334230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eba6cea-3df5-4efa-8bd2-cbdecf233409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916c9c44220>]}
[0m02:20:50.334861 [info ] [Thread-1 (]: 1 of 1 OK created sql view model ida.pivot_variacao ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m02:20:50.335499 [debug] [Thread-1 (]: Finished running node model.beanalytic_ida.pivot_variacao
[0m02:20:50.338979 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:50.339410 [debug] [MainThread]: On master: BEGIN
[0m02:20:50.339698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:20:50.348857 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:20:50.349383 [debug] [MainThread]: On master: COMMIT
[0m02:20:50.349720 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:50.350004 [debug] [MainThread]: On master: COMMIT
[0m02:20:50.350794 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:20:50.351217 [debug] [MainThread]: On master: Close
[0m02:20:50.353090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:20:50.354412 [debug] [MainThread]: Connection 'model.beanalytic_ida.pivot_variacao' was properly closed.
[0m02:20:50.355104 [info ] [MainThread]: 
[0m02:20:50.355608 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m02:20:50.356638 [debug] [MainThread]: Command end result
[0m02:20:50.366823 [info ] [MainThread]: 
[0m02:20:50.368540 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:20:50.370117 [info ] [MainThread]: 
[0m02:20:50.370994 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:20:50.372368 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8730103, "process_user_time": 2.691469, "process_kernel_time": 0.275536, "process_mem_max_rss": "106544", "process_out_blocks": "3352", "process_in_blocks": "0"}
[0m02:20:50.372960 [debug] [MainThread]: Command `dbt run` succeeded at 02:20:50.372832 after 0.87 seconds
[0m02:20:50.373325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916cd6bf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916ca06f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916cb86d420>]}
[0m02:20:50.373704 [debug] [MainThread]: Flushing usage events
[0m02:20:55.766994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2d799e3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2d77b849a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2d77b87ee0>]}


============================== 02:20:55.773816 | ef8361b8-ca7e-44ea-a36b-7ba369bd11dc ==============================
[0m02:20:55.773816 [info ] [MainThread]: Running with dbt=1.7.3
[0m02:20:55.774309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select pivot_variacao', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:20:55.978924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef8361b8-ca7e-44ea-a36b-7ba369bd11dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2d7bccbc40>]}
[0m02:20:56.083488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef8361b8-ca7e-44ea-a36b-7ba369bd11dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2d77bf1b10>]}
[0m02:20:56.084487 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m02:20:56.092631 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m02:20:56.131586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:20:56.132738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:20:56.140245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef8361b8-ca7e-44ea-a36b-7ba369bd11dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2d75fba9b0>]}
[0m02:20:56.154164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef8361b8-ca7e-44ea-a36b-7ba369bd11dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2d761813c0>]}
[0m02:20:56.154800 [info ] [MainThread]: Found 6 models, 17 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m02:20:56.155196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef8361b8-ca7e-44ea-a36b-7ba369bd11dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2d76181750>]}
[0m02:20:56.157230 [info ] [MainThread]: 
[0m02:20:56.158292 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:20:56.159564 [debug] [MainThread]: Command end result
[0m02:20:56.170067 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44712412, "process_user_time": 2.713447, "process_kernel_time": 0.198446, "process_mem_max_rss": "99976", "process_out_blocks": "2416", "process_in_blocks": "0"}
[0m02:20:56.170766 [debug] [MainThread]: Command `dbt test` succeeded at 02:20:56.170629 after 0.45 seconds
[0m02:20:56.171153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2d799e3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2d7644c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2d761813c0>]}
[0m02:20:56.171574 [debug] [MainThread]: Flushing usage events
[0m02:37:39.222513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef3274b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef30b00940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef30b03fd0>]}


============================== 02:37:39.239131 | ecb72636-dda5-4d01-a583-5b5e36754d79 ==============================
[0m02:37:39.239131 [info ] [MainThread]: Running with dbt=1.7.3
[0m02:37:39.239677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_grupo_economico fato_ida long_delta pivot_variacao', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:37:39.495437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecb72636-dda5-4d01-a583-5b5e36754d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef32f2f2e0>]}
[0m02:37:39.608424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecb72636-dda5-4d01-a583-5b5e36754d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef30945420>]}
[0m02:37:39.609216 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m02:37:39.618904 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m02:37:39.670289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:37:39.671187 [debug] [MainThread]: Partial parsing: updated file: beanalytic_ida://models/mart/dim_grupo_economico.sql
[0m02:37:39.671915 [debug] [MainThread]: Partial parsing: updated file: beanalytic_ida://models/facts/fato_ida.sql
[0m02:37:40.079712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecb72636-dda5-4d01-a583-5b5e36754d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef2d58df90>]}
[0m02:37:40.099774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecb72636-dda5-4d01-a583-5b5e36754d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef2ef19d50>]}
[0m02:37:40.100410 [info ] [MainThread]: Found 6 models, 17 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m02:37:40.100893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb72636-dda5-4d01-a583-5b5e36754d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef2d5635e0>]}
[0m02:37:40.108201 [info ] [MainThread]: 
[0m02:37:40.109909 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:37:40.112567 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ida_datamart'
[0m02:37:40.137211 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart"
[0m02:37:40.138345 [debug] [ThreadPool]: On list_ida_datamart: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart"} */

    select distinct nspname from pg_namespace
  
[0m02:37:40.139430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:37:40.157281 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:37:40.158743 [debug] [ThreadPool]: On list_ida_datamart: Close
[0m02:37:40.162551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ida_datamart, now list_ida_datamart_ida)
[0m02:37:40.170224 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida"
[0m02:37:40.170736 [debug] [ThreadPool]: On list_ida_datamart_ida: BEGIN
[0m02:37:40.171069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:37:40.178067 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:37:40.178629 [debug] [ThreadPool]: Using postgres connection "list_ida_datamart_ida"
[0m02:37:40.179051 [debug] [ThreadPool]: On list_ida_datamart_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "list_ida_datamart_ida"} */
select
      'ida_datamart' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ida'
    union all
    select
      'ida_datamart' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ida'
    union all
    select
      'ida_datamart' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ida'
  
[0m02:37:40.182790 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m02:37:40.184420 [debug] [ThreadPool]: On list_ida_datamart_ida: ROLLBACK
[0m02:37:40.185234 [debug] [ThreadPool]: On list_ida_datamart_ida: Close
[0m02:37:40.192292 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:40.192720 [debug] [MainThread]: On master: BEGIN
[0m02:37:40.193017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:37:40.202771 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:37:40.203214 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:40.203679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:37:40.208121 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m02:37:40.209776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb72636-dda5-4d01-a583-5b5e36754d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef2d561540>]}
[0m02:37:40.210240 [debug] [MainThread]: On master: ROLLBACK
[0m02:37:40.210839 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:40.211156 [debug] [MainThread]: On master: BEGIN
[0m02:37:40.211991 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:37:40.212361 [debug] [MainThread]: On master: COMMIT
[0m02:37:40.212677 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:40.212943 [debug] [MainThread]: On master: COMMIT
[0m02:37:40.213652 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:37:40.213971 [debug] [MainThread]: On master: Close
[0m02:37:40.214923 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:37:40.215415 [info ] [MainThread]: 
[0m02:37:40.226796 [debug] [Thread-1 (]: Began running node model.beanalytic_ida.dim_grupo_economico
[0m02:37:40.227478 [info ] [Thread-1 (]: 1 of 4 START sql table model ida.dim_grupo_economico ........................... [RUN]
[0m02:37:40.228324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ida_datamart_ida, now model.beanalytic_ida.dim_grupo_economico)
[0m02:37:40.228731 [debug] [Thread-1 (]: Began compiling node model.beanalytic_ida.dim_grupo_economico
[0m02:37:40.236908 [debug] [Thread-1 (]: Writing injected SQL for node "model.beanalytic_ida.dim_grupo_economico"
[0m02:37:40.237821 [debug] [Thread-1 (]: Timing info for model.beanalytic_ida.dim_grupo_economico (compile): 02:37:40.228957 => 02:37:40.237509
[0m02:37:40.238227 [debug] [Thread-1 (]: Began executing node model.beanalytic_ida.dim_grupo_economico
[0m02:37:40.283781 [debug] [Thread-1 (]: Writing runtime sql for node "model.beanalytic_ida.dim_grupo_economico"
[0m02:37:40.284729 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:37:40.285158 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: BEGIN
[0m02:37:40.285502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:37:40.292742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:37:40.293393 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:37:40.294752 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */

  
    

  create  table "ida_datamart"."ida"."dim_grupo_economico__dbt_tmp"
  
  
    as
  
  (
    

WITH grupo_norm AS (
  SELECT DISTINCT
    REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') AS nome_raw,
    CASE 
      WHEN REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'OI%' THEN 'OI'
      WHEN REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'CLARO%' THEN 'CLARO'
      WHEN REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'VIVO%' OR REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'TELEFÃ”NICA%' THEN 'VIVO'
      WHEN REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'TIM%' THEN 'TIM'
      WHEN REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'CTBC%' OR REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'ALGAR%' THEN 'ALGAR'
      WHEN REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'SERCOMTEL%' THEN 'SERCOMTEL'
      ELSE REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g')
    END AS nome_final
  FROM "ida_datamart"."ida"."staging_ida"
)
SELECT DISTINCT nome_final AS nome_grupo
FROM grupo_norm
  );
  
[0m02:37:40.388463 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.0 seconds
[0m02:37:40.394941 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:37:40.395428 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */
alter table "ida_datamart"."ida"."dim_grupo_economico" rename to "dim_grupo_economico__dbt_backup"
[0m02:37:40.396530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:37:40.399875 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:37:40.400320 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */
alter table "ida_datamart"."ida"."dim_grupo_economico__dbt_tmp" rename to "dim_grupo_economico"
[0m02:37:40.401282 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:37:40.426348 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: COMMIT
[0m02:37:40.426916 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:37:40.427300 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: COMMIT
[0m02:37:40.429734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:37:40.437012 [debug] [Thread-1 (]: Applying DROP to: "ida_datamart"."ida"."dim_grupo_economico__dbt_backup"
[0m02:37:40.442529 [debug] [Thread-1 (]: Using postgres connection "model.beanalytic_ida.dim_grupo_economico"
[0m02:37:40.443032 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.dim_grupo_economico"} */
drop table if exists "ida_datamart"."ida"."dim_grupo_economico__dbt_backup" cascade
[0m02:37:40.447683 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:37:40.449540 [debug] [Thread-1 (]: Timing info for model.beanalytic_ida.dim_grupo_economico (execute): 02:37:40.238466 => 02:37:40.449341
[0m02:37:40.449944 [debug] [Thread-1 (]: On model.beanalytic_ida.dim_grupo_economico: Close
[0m02:37:40.450793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb72636-dda5-4d01-a583-5b5e36754d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef2d45e050>]}
[0m02:37:40.451425 [info ] [Thread-1 (]: 1 of 4 OK created sql table model ida.dim_grupo_economico ...................... [[32mSELECT 13[0m in 0.22s]
[0m02:37:40.452005 [debug] [Thread-1 (]: Finished running node model.beanalytic_ida.dim_grupo_economico
[0m02:37:40.454191 [debug] [Thread-3 (]: Began running node model.beanalytic_ida.fato_ida
[0m02:37:40.455705 [info ] [Thread-3 (]: 2 of 4 START sql table model ida.fato_ida ...................................... [RUN]
[0m02:37:40.457389 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.beanalytic_ida.fato_ida'
[0m02:37:40.457825 [debug] [Thread-3 (]: Began compiling node model.beanalytic_ida.fato_ida
[0m02:37:40.465539 [debug] [Thread-3 (]: Writing injected SQL for node "model.beanalytic_ida.fato_ida"
[0m02:37:40.467385 [debug] [Thread-3 (]: Timing info for model.beanalytic_ida.fato_ida (compile): 02:37:40.458060 => 02:37:40.467037
[0m02:37:40.467850 [debug] [Thread-3 (]: Began executing node model.beanalytic_ida.fato_ida
[0m02:37:40.474978 [debug] [Thread-3 (]: Writing runtime sql for node "model.beanalytic_ida.fato_ida"
[0m02:37:40.477070 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:37:40.478955 [debug] [Thread-3 (]: On model.beanalytic_ida.fato_ida: BEGIN
[0m02:37:40.479727 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:37:40.490612 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:37:40.491103 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:37:40.491563 [debug] [Thread-3 (]: On model.beanalytic_ida.fato_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.fato_ida"} */

  
    

  create  table "ida_datamart"."ida"."fato_ida__dbt_tmp"
  
  
    as
  
  (
    

WITH refined AS (
  SELECT 
    ano_mes,
    UPPER(servico) AS svc,
    CASE 
      WHEN REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'OI%' THEN 'OI'
      WHEN REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'CLARO%' THEN 'CLARO'
      WHEN REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'VIVO%' OR REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'TELEFÃ”NICA%' THEN 'VIVO'
      WHEN REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'TIM%' THEN 'TIM'
      WHEN REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'CTBC%' OR REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'ALGAR%' THEN 'ALGAR'
      WHEN REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g') LIKE 'SERCOMTEL%' THEN 'SERCOMTEL'
      ELSE REGEXP_REPLACE(TRIM(REGEXP_REPLACE(UPPER(grupo_economico), '\s*\([^)]*\)|\*+', '', 'g')), '\s+', ' ', 'g')
    END AS grp,
    MAX(CASE WHEN variavel ILIKE 'Indicador de Desempenho%' OR variavel ILIKE 'Ãndice de Desempenho%' THEN valor END) AS val_ida,
    MAX(CASE WHEN variavel ILIKE 'Taxa de Resolvidas em 5 dias%' THEN valor END) AS tx_5d,
    MAX(CASE WHEN variavel ILIKE 'Taxa de Resolvidas no PerÃ­odo' THEN valor END) AS tx_tot,
    MAX(CASE WHEN variavel IN ('Total de SolicitaÃ§Ãµes', 'Quantidade de SolicitaÃ§Ãµes', 'Quantidade de reclamaÃ§Ãµes', 'Quantidade de ReclamaÃ§Ãµes', 'Quantidade de ReclamaÃ§Ãµes no PerÃ­odo', 'Total de ReclamaÃ§Ãµes') THEN valor END) AS sol_tot,
    MAX(CASE WHEN variavel IN ('Quantidade de resolvidas', 'Quantidade de Sol. Resolvidas no PerÃ­odo', 'Quantidade de Respondidas') THEN valor END) AS sol_res
  FROM "ida_datamart"."ida"."staging_ida"
  GROUP BY 1, 2, 3
),
calc AS (
  SELECT 
    *,
    COALESCE(sol_res, ROUND((sol_tot * tx_tot / 100)))::integer AS res_final
  FROM refined
)
SELECT 
  dt.id_tempo, dg.nome_grupo, ds.codigo_servico,
  COALESCE(c.val_ida, c.tx_5d, 0) AS taxa_solicitacoes_resolvidas_5dias,
  COALESCE(c.tx_tot, 0) AS taxa_solicitacoes_resolvidas,
  COALESCE(c.sol_tot, 0) AS total_solicitacoes,
  COALESCE(c.res_final, 0) AS solicitacoes_resolvidas
FROM calc c
JOIN "ida_datamart"."ida"."dim_tempo" dt ON c.ano_mes = dt.ano_mes
JOIN "ida_datamart"."ida"."dim_grupo_economico" dg ON c.grp = dg.nome_grupo
JOIN "ida_datamart"."ida"."dim_servico" ds ON c.svc = ds.codigo_servico
  );
  
[0m02:37:40.625046 [debug] [Thread-3 (]: SQL status: SELECT 1298 in 0.0 seconds
[0m02:37:40.628635 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:37:40.629089 [debug] [Thread-3 (]: On model.beanalytic_ida.fato_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.fato_ida"} */
alter table "ida_datamart"."ida"."fato_ida" rename to "fato_ida__dbt_backup"
[0m02:37:40.630067 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:37:40.634382 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:37:40.634866 [debug] [Thread-3 (]: On model.beanalytic_ida.fato_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.fato_ida"} */
alter table "ida_datamart"."ida"."fato_ida__dbt_tmp" rename to "fato_ida"
[0m02:37:40.635737 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:37:40.637770 [debug] [Thread-3 (]: On model.beanalytic_ida.fato_ida: COMMIT
[0m02:37:40.638183 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:37:40.638636 [debug] [Thread-3 (]: On model.beanalytic_ida.fato_ida: COMMIT
[0m02:37:40.641435 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m02:37:40.644030 [debug] [Thread-3 (]: Applying DROP to: "ida_datamart"."ida"."fato_ida__dbt_backup"
[0m02:37:40.644769 [debug] [Thread-3 (]: Using postgres connection "model.beanalytic_ida.fato_ida"
[0m02:37:40.645118 [debug] [Thread-3 (]: On model.beanalytic_ida.fato_ida: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.fato_ida"} */
drop table if exists "ida_datamart"."ida"."fato_ida__dbt_backup" cascade
[0m02:37:40.648056 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:37:40.649581 [debug] [Thread-3 (]: Timing info for model.beanalytic_ida.fato_ida (execute): 02:37:40.468100 => 02:37:40.649375
[0m02:37:40.649926 [debug] [Thread-3 (]: On model.beanalytic_ida.fato_ida: Close
[0m02:37:40.650698 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb72636-dda5-4d01-a583-5b5e36754d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef2ef20970>]}
[0m02:37:40.651541 [info ] [Thread-3 (]: 2 of 4 OK created sql table model ida.fato_ida ................................. [[32mSELECT 1298[0m in 0.19s]
[0m02:37:40.652883 [debug] [Thread-3 (]: Finished running node model.beanalytic_ida.fato_ida
[0m02:37:40.654978 [debug] [Thread-2 (]: Began running node model.beanalytic_ida.long_delta
[0m02:37:40.655832 [info ] [Thread-2 (]: 3 of 4 START sql table model ida.long_delta .................................... [RUN]
[0m02:37:40.657336 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.beanalytic_ida.long_delta'
[0m02:37:40.657706 [debug] [Thread-2 (]: Began compiling node model.beanalytic_ida.long_delta
[0m02:37:40.661486 [debug] [Thread-2 (]: Writing injected SQL for node "model.beanalytic_ida.long_delta"
[0m02:37:40.663021 [debug] [Thread-2 (]: Timing info for model.beanalytic_ida.long_delta (compile): 02:37:40.657958 => 02:37:40.662623
[0m02:37:40.663642 [debug] [Thread-2 (]: Began executing node model.beanalytic_ida.long_delta
[0m02:37:40.669429 [debug] [Thread-2 (]: Writing runtime sql for node "model.beanalytic_ida.long_delta"
[0m02:37:40.670692 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:37:40.671120 [debug] [Thread-2 (]: On model.beanalytic_ida.long_delta: BEGIN
[0m02:37:40.671510 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:37:40.679703 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:37:40.680292 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:37:40.680688 [debug] [Thread-2 (]: On model.beanalytic_ida.long_delta: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.long_delta"} */

  
    

  create  table "ida_datamart"."ida"."long_delta__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
  SELECT
    t.ano_mes,
    f.id_tempo,
    f.nome_grupo,
    f.codigo_servico,
    f.taxa_solicitacoes_resolvidas_5dias AS ida
  FROM "ida_datamart"."ida"."fato_ida" f
  JOIN "ida_datamart"."ida"."dim_tempo" t ON f.id_tempo = t.id_tempo
),
mercado AS (
  SELECT
    ano_mes,
    AVG(ida) AS valor_mercado
  FROM base
  GROUP BY ano_mes
),
variacoes AS (
  SELECT
    b.ano_mes,
    b.nome_grupo,
    -- VariaÃ§Ã£o do mercado (%): (atual - anterior) / anterior * 100
    CASE
      WHEN LAG(m.valor_mercado) OVER (ORDER BY b.ano_mes) > 0
      THEN ((m.valor_mercado - LAG(m.valor_mercado) OVER (ORDER BY b.ano_mes))
            / LAG(m.valor_mercado) OVER (ORDER BY b.ano_mes)) * 100
    END AS var_mercado,
    -- VariaÃ§Ã£o individual da operadora (%)
    CASE
      WHEN LAG(b.ida) OVER (PARTITION BY b.nome_grupo ORDER BY b.ano_mes) > 0
      THEN ((b.ida - LAG(b.ida) OVER (PARTITION BY b.nome_grupo ORDER BY b.ano_mes))
            / LAG(b.ida) OVER (PARTITION BY b.nome_grupo ORDER BY b.ano_mes)) * 100
    END AS var_individual
  FROM base b
  JOIN mercado m USING (ano_mes)
)
SELECT
  ano_mes,
  nome_grupo,
  ROUND(var_mercado::numeric, 2) AS var_mercado,
  ROUND(var_individual::numeric, 2) AS var_individual,
  ROUND((var_mercado - var_individual)::numeric, 2) AS diferenca
FROM variacoes
WHERE var_mercado IS NOT NULL
  AND var_individual IS NOT NULL
  );
  
[0m02:37:40.696150 [debug] [Thread-2 (]: SQL status: SELECT 1190 in 0.0 seconds
[0m02:37:40.703767 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:37:40.704335 [debug] [Thread-2 (]: On model.beanalytic_ida.long_delta: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.long_delta"} */
alter table "ida_datamart"."ida"."long_delta" rename to "long_delta__dbt_backup"
[0m02:37:40.706103 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:37:40.709556 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:37:40.710150 [debug] [Thread-2 (]: On model.beanalytic_ida.long_delta: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.long_delta"} */
alter table "ida_datamart"."ida"."long_delta__dbt_tmp" rename to "long_delta"
[0m02:37:40.711581 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:37:40.717875 [debug] [Thread-2 (]: On model.beanalytic_ida.long_delta: COMMIT
[0m02:37:40.718418 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:37:40.718828 [debug] [Thread-2 (]: On model.beanalytic_ida.long_delta: COMMIT
[0m02:37:40.751842 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m02:37:40.767597 [debug] [Thread-2 (]: Applying DROP to: "ida_datamart"."ida"."long_delta__dbt_backup"
[0m02:37:40.771528 [debug] [Thread-2 (]: Using postgres connection "model.beanalytic_ida.long_delta"
[0m02:37:40.772484 [debug] [Thread-2 (]: On model.beanalytic_ida.long_delta: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.long_delta"} */
drop table if exists "ida_datamart"."ida"."long_delta__dbt_backup" cascade
[0m02:37:40.793331 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:37:40.796703 [debug] [Thread-2 (]: Timing info for model.beanalytic_ida.long_delta (execute): 02:37:40.664151 => 02:37:40.796198
[0m02:37:40.802858 [debug] [Thread-2 (]: On model.beanalytic_ida.long_delta: Close
[0m02:37:40.806630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb72636-dda5-4d01-a583-5b5e36754d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef2d4ae530>]}
[0m02:37:40.808331 [info ] [Thread-2 (]: 3 of 4 OK created sql table model ida.long_delta ............................... [[32mSELECT 1190[0m in 0.15s]
[0m02:37:40.809862 [debug] [Thread-2 (]: Finished running node model.beanalytic_ida.long_delta
[0m02:37:40.819610 [debug] [Thread-4 (]: Began running node model.beanalytic_ida.pivot_variacao
[0m02:37:40.821691 [info ] [Thread-4 (]: 4 of 4 START sql view model ida.pivot_variacao ................................. [RUN]
[0m02:37:40.825702 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.beanalytic_ida.pivot_variacao'
[0m02:37:40.826693 [debug] [Thread-4 (]: Began compiling node model.beanalytic_ida.pivot_variacao
[0m02:37:40.854230 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.pivot_variacao"
[0m02:37:40.855358 [debug] [Thread-4 (]: On model.beanalytic_ida.pivot_variacao: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.pivot_variacao"} */

    select distinct nome_grupo from "ida_datamart"."ida"."dim_grupo_economico"
  
[0m02:37:40.855818 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:37:40.871251 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.0 seconds
[0m02:37:40.873033 [debug] [Thread-4 (]: Writing injected SQL for node "model.beanalytic_ida.pivot_variacao"
[0m02:37:40.873995 [debug] [Thread-4 (]: Timing info for model.beanalytic_ida.pivot_variacao (compile): 02:37:40.827246 => 02:37:40.873698
[0m02:37:40.874512 [debug] [Thread-4 (]: Began executing node model.beanalytic_ida.pivot_variacao
[0m02:37:40.923110 [debug] [Thread-4 (]: Writing runtime sql for node "model.beanalytic_ida.pivot_variacao"
[0m02:37:40.924324 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.pivot_variacao"
[0m02:37:40.927587 [debug] [Thread-4 (]: On model.beanalytic_ida.pivot_variacao: BEGIN
[0m02:37:40.930642 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:37:40.932447 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.pivot_variacao"
[0m02:37:40.933101 [debug] [Thread-4 (]: On model.beanalytic_ida.pivot_variacao: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.pivot_variacao"} */

  create view "ida_datamart"."ida"."pivot_variacao__dbt_tmp"
    
    
  as (
    



  


select
  ano_mes as "Mes",
  coalesce(round(avg(var_mercado)::numeric, 1), 0) as "Taxa de VariaÃ§Ã£o MÃ©dia"
  
  , coalesce(round(max(case when nome_grupo = 'VIVO' then diferenca end)::numeric, 1), 0) as "VIVO"
  
  , coalesce(round(max(case when nome_grupo = 'OI' then diferenca end)::numeric, 1), 0) as "OI"
  
  , coalesce(round(max(case when nome_grupo = 'NET' then diferenca end)::numeric, 1), 0) as "NET"
  
  , coalesce(round(max(case when nome_grupo = 'NEXTEL' then diferenca end)::numeric, 1), 0) as "NEXTEL"
  
  , coalesce(round(max(case when nome_grupo = 'CLARO' then diferenca end)::numeric, 1), 0) as "CLARO"
  
  , coalesce(round(max(case when nome_grupo = 'VIACABO' then diferenca end)::numeric, 1), 0) as "VIACABO"
  
  , coalesce(round(max(case when nome_grupo = 'SERCOMTEL' then diferenca end)::numeric, 1), 0) as "SERCOMTEL"
  
  , coalesce(round(max(case when nome_grupo = 'TIM' then diferenca end)::numeric, 1), 0) as "TIM"
  
  , coalesce(round(max(case when nome_grupo = 'EMBRATEL' then diferenca end)::numeric, 1), 0) as "EMBRATEL"
  
  , coalesce(round(max(case when nome_grupo = 'SKY' then diferenca end)::numeric, 1), 0) as "SKY"
  
  , coalesce(round(max(case when nome_grupo = 'ALGAR' then diferenca end)::numeric, 1), 0) as "ALGAR"
  
  , coalesce(round(max(case when nome_grupo = 'GVT' then diferenca end)::numeric, 1), 0) as "GVT"
  
  , coalesce(round(max(case when nome_grupo = 'INTELIG' then diferenca end)::numeric, 1), 0) as "INTELIG"
  
from "ida_datamart"."ida"."long_delta"
group by 1
order by "Mes"
  );
[0m02:37:40.945868 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:37:40.949970 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.pivot_variacao"
[0m02:37:40.950596 [debug] [Thread-4 (]: On model.beanalytic_ida.pivot_variacao: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.pivot_variacao"} */
alter table "ida_datamart"."ida"."pivot_variacao__dbt_tmp" rename to "pivot_variacao"
[0m02:37:40.952367 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:37:40.954923 [debug] [Thread-4 (]: On model.beanalytic_ida.pivot_variacao: COMMIT
[0m02:37:40.955434 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.pivot_variacao"
[0m02:37:40.955827 [debug] [Thread-4 (]: On model.beanalytic_ida.pivot_variacao: COMMIT
[0m02:37:40.965950 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m02:37:40.970189 [debug] [Thread-4 (]: Applying DROP to: "ida_datamart"."ida"."pivot_variacao__dbt_backup"
[0m02:37:40.975138 [debug] [Thread-4 (]: Using postgres connection "model.beanalytic_ida.pivot_variacao"
[0m02:37:40.975731 [debug] [Thread-4 (]: On model.beanalytic_ida.pivot_variacao: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "beanalytic_ida", "target_name": "dev", "node_id": "model.beanalytic_ida.pivot_variacao"} */
drop view if exists "ida_datamart"."ida"."pivot_variacao__dbt_backup" cascade
[0m02:37:40.976597 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:37:40.978363 [debug] [Thread-4 (]: Timing info for model.beanalytic_ida.pivot_variacao (execute): 02:37:40.874830 => 02:37:40.978119
[0m02:37:40.978864 [debug] [Thread-4 (]: On model.beanalytic_ida.pivot_variacao: Close
[0m02:37:40.979888 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb72636-dda5-4d01-a583-5b5e36754d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef2d605030>]}
[0m02:37:40.980627 [info ] [Thread-4 (]: 4 of 4 OK created sql view model ida.pivot_variacao ............................ [[32mCREATE VIEW[0m in 0.16s]
[0m02:37:40.981341 [debug] [Thread-4 (]: Finished running node model.beanalytic_ida.pivot_variacao
[0m02:37:40.985634 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:40.986170 [debug] [MainThread]: On master: BEGIN
[0m02:37:40.986599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:37:40.996825 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:37:40.997397 [debug] [MainThread]: On master: COMMIT
[0m02:37:40.997835 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:40.998176 [debug] [MainThread]: On master: COMMIT
[0m02:37:40.999263 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:37:40.999678 [debug] [MainThread]: On master: Close
[0m02:37:41.000505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:37:41.000902 [debug] [MainThread]: Connection 'model.beanalytic_ida.dim_grupo_economico' was properly closed.
[0m02:37:41.001215 [debug] [MainThread]: Connection 'model.beanalytic_ida.fato_ida' was properly closed.
[0m02:37:41.001522 [debug] [MainThread]: Connection 'model.beanalytic_ida.long_delta' was properly closed.
[0m02:37:41.001801 [debug] [MainThread]: Connection 'model.beanalytic_ida.pivot_variacao' was properly closed.
[0m02:37:41.002186 [info ] [MainThread]: 
[0m02:37:41.002597 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m02:37:41.003723 [debug] [MainThread]: Command end result
[0m02:37:41.027691 [info ] [MainThread]: 
[0m02:37:41.028322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:37:41.029555 [info ] [MainThread]: 
[0m02:37:41.030782 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:37:41.033153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8683556, "process_user_time": 3.096771, "process_kernel_time": 0.483495, "process_mem_max_rss": "112100", "process_in_blocks": "880", "process_out_blocks": "3472"}
[0m02:37:41.033997 [debug] [MainThread]: Command `dbt run` succeeded at 02:37:41.033825 after 1.87 seconds
[0m02:37:41.034789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef3274b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef2d63dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eef2d420f70>]}
[0m02:37:41.035859 [debug] [MainThread]: Flushing usage events
